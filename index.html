<html>
<head>

<style type="text/css"> 

  div{
    font-size:24pt;
    font-family:標楷體;
  }
  .smallfont { 
    font-family:標楷體;
    font-size: 13pt; 
  }
  #smallVer1 { 
    font-family:標楷體;
    font-size: 13pt; 
  }
  #smallVer2 { 
    font-family:標楷體;
    font-size: 13pt; 
  }
  #smallVer3 { 
    font-family:標楷體;
    font-size: 13pt; 
  }
  #smallVer4 { 
    font-family:標楷體;
    font-size: 13pt; 
  }
  #bookmark1 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark2 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark3 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark4 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark5 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark6 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark7 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark8 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark9 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark10 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark11 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark12 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark13 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }
  #bookmark14 { 
    font-family:標楷體;
    font-size: 13pt; 
    color:darkblue;
  }

</style> 

<style>
.button1 {
  background-color: #008CBA; /* Blue */
  color: white;
}
.button2 {
  color: blue;
}
.button3 {
  background-color: white;
  border: 2px solid #f44336;
  color: black;
  text-align: center;
  width: 78px;
}
.messageBox{
  background-image:url('back5.jpg');
  background-repeat:repeat;
}
.center {
  margin: auto;
  width: 95%;
}
</style>

<style>
.box{
    white-space: nowrap;
    overflow-y:auto;
}
</style>

<style>

#menu {
  opacity:0.4;
  position: fixed;
  right: 0;
  top: 50%;    
  width: 4em;
  margin-top: -2.5em;
}

#menu:hover {
  opacity:1.0;
  position: fixed;
  right: 0;
  top: 50%;    
  width: 4em;
  margin-top: -2.5em;
}

#menu:onblur {
  opacity:0.4;
  position: fixed;
  right: 0;
  top: 50%;    
  width: 4em;
  margin-top: -2.5em;
}

</style>


<style>

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  font-size:20px;
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 400px;

}

.dropbtn {
    background-color: #4CAF50;
    color: white;
 
    font-size: 16px;

    cursor: pointer;
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown-content a:hover {background-color: #f1f1f1}

</style>



    <script src="vue.min.js"></script>
    <script src="vue-qrcode-reader.browser.js"></script>
    <link rel="stylesheet" href="vue-qrcode-reader.css">

    <script src="idb.min.js"></script>
    <script src="dexie.js"></script>

    <script src="html5-qrcode.min.js"></script>

    <script src="aes.js"></script>

    <script src="jquery-3.5.1.min.js"></script>



<SCRIPT LANGUAGE="JavaScript" SRC="Mark_Line_V14c.js"></SCRIPT>

<SCRIPT LANGUAGE="JavaScript" SRC="KeyFunction2.js"></SCRIPT>

<SCRIPT LANGUAGE="JavaScript" SRC="RE_Attendance_V11g.js"></SCRIPT>  

<SCRIPT LANGUAGE="JavaScript" SRC="Sync_Upload_Download.js"></SCRIPT>




<script Language="JavaScript">

// For LocalStorage Test

function clickCounter() {
  if (typeof(Storage) !== "undefined") {
    if (localStorage.clickcount) {
      localStorage.clickcount = Number(localStorage.clickcount)+1;
    } else {
      localStorage.clickcount = 1;
    }
    document.getElementById("result").innerHTML = "You have clicked the button " + localStorage.clickcount + " time(s).";
  } else {
    document.getElementById("result").innerHTML = "Sorry, your browser does not support web storage...";
  }
}


// End of LocalStorage Test


//font-family:arial; 

// Define global variables


// For Keyboard Test
   var B_book_int = 0;
   var B_chap_int = 0;
   var B_verse_int = 1;
   var B_to_verse_int = 1;
   var H_book_int = 0;
   var now_B_verse_int = 0;
   var now_B_to_verse_int = 0;
   var B_book;
   var B_chap;
   var B_verse;
   var B_to_verse;
   var H_book;
   var B_book1;
   var B_chap1;
   var B_verse1;
   var B_to_verse1;
   var H_book1;
   var B_book2;
   var B_chap2;
   var B_verse2;
   var B_to_verse2;
   var H_book2;
   var B_book3;
   var B_chap3;
   var B_verse3;
   var B_to_verse3;
   var H_book3;
   var H_book4;
   var B_book_text="";
   var B_chap_text="";
   var B_verse_text="";
   var B_to_verse_text="";
   var H_book_text="";
   var B_book_F = 0;
   var B_chap_F = 0;
   var B_verse_F  = 0;
   var B_to_verse_F  = 0;
   var H_book_F = 0;
   var B_book_1F = 0;
   var B_chap_1F = 0;
   var B_verse_1F  = 0;
   var B_to_verse_1F  = 0;
   var H_book_1F = 0;
   var B_book_2F = 0;
   var B_chap_2F = 0;
   var B_verse_2F  = 0;
   var B_to_verse_2F  = 0;
   var H_book_2F = 0;
   var B_book_3F = 0;
   var B_chap_3F = 0;
   var B_verse_3F  = 0;
   var B_to_verse_3F  = 0;
   var H_book_3F = 0;
   var H_book_4F = 0;
   var B_book_seq = 0;
   var S_anno;
   var S_anno1;
   var S_anno2;
   var S_anno_F = 0;
   var S_anno_1F = 0;
   var S_anno_2F = 0;
   var S_anno_int;

   var all_key_enable=0; // 0 表 disable partial key, 1 表 enable all key
   var AB_key_enable=0; // 0 表 disable A,B key, 1 表 enable A,B key

   var Bible_F = 0;        // 為 1 時，按 Enter 會 送出 所選 經文內容
   var Hymn_F = 0;         // 為 1 時，按 Enter 會 送出 所選 Hymn
   var Static_Anno_F = 0;  // 為 1 時，按 Enter 會 送出 所選 Static Announcement
   var Dyna_Anno_F = 0;    // 為 1 時，按 Enter 會 送出 所選 Dynamic Announcement , 目前尚未用到

   var maxchap = 0;
   var maxverse = 0;


// For Select Book, Chap, Verse... from Screen

   var Book_F=0;
   var Chap_F=0;
   var Vers_F=0;
   var ToVers_F=0;

   var Book_seq=0;
   var Book_Num;
   var Book_Num1;
   var Book_Num2;

   var Chap_seq=0;
   var Chap_Num;
   var Chap_Num1;
   var Chap_Num2;
   var Chap_Num3;

   var Vers_seq=0;
   var Vers_Num;
   var Vers_Num1;
   var Vers_Num2;
   var Vers_Num3;

   var ToVers_seq=0;
   var ToVers_Num;
   var ToVers_Num1;
   var ToVers_Num2;
   var ToVers_Num3;

   var ANNO_S1="";
   var ANNO_S2="";
   var ANNO_S3="";
   var ANNO_S4="";

//<tr><td><p style="font-size:18pt" >&nbsp</p></td>

</script>


<title>Count People</title>

<meta http-equiv="Content-Type" content="text/html; charset=big5">

</head>
<body onload="Init_Total_Mode();init_Bible4U_DB();Open_Service_Record(); return false;" text="#000000" link="#0000ff" alink="#ffffff" vlink="#0000ff" background="back5.jpg">


<div id="Church_Service_Schedule" style="width:100%;height:0%;overflow:auto;" class="center">

  <p id="Church_Service_Schedule_Content"> </p>
 
  <img src="Church_Service_Schedule_1.jpg" width="100%" height="280%" >
  <img src="Church_Service_Schedule_2.jpg" width="100%" height="280%" >

</div>

<div id="IYC_Schedule" style="width:100%;height:0%;overflow:auto;" class="center">

  <p id="IYC_Schedule_Content"> </p>

  <img src="IYC_Schedule.jpg" width="100%" height="140%" >

</div>


<div id="tool_area_8" style="height:170%;display:block"> 

   <center><b><label style="font-size:30px" for="fname2">Service Record & </label></b>
   <a href="javascript:;" onclick="Go_To_Roll_Marking();">Roll Marking</a></center>
   <br>

   <td>
   <label style="font-size:28px" for="fname2"> 1. </label>
   </td>
   <td>
   <button id="Start_Attendance2" style="font-size:26px" onclick="Start_Service_Record()">Start</button>
   </td>
   <td>
   <label style="font-size:28px" for="fname2"> --> </label>
   </td>
   <td>
   <label style="font-size:28px" for="fname2"> 2. </label>
   </td>
   <td>
   <button id="Save_Attendance2" style="font-size:26px" onclick="update_Service_Record();Exp_and_Email_Attendance2();">Save</button>
   </td>
   <td>
   <label style="font-size:28px" for="fname2"> --> </label>
   </td>
   <td>
   <label style="font-size:28px" for="fname2"> 3. </label>
   </td>
   <td>
   <label id="Send email" style="font-size:28px" for="fname2"> Send email </label>
   </td>


   <td>&nbsp</td><td>&nbsp</td>


   <td>
   <a href="javascript:;" onclick="Search_Prev_Service_Record();">Prev</a>
   <button style="font-size:25px;" onclick="NOW_Service_Record();">Service Record-NOW</button>
   <a href="javascript:;" onclick="Search_Next_Service_Record();">Next</a>
   </td>

   <br><br>

   <td>
   <label style="font-size:28px" for="fname2">Date</label>
   </td>
   <td>
   <input style="font-size:22px;color:blue;" size="25" type="text" id="Service_Date" name="Service_Date" class="messageBox" readonly>
   </td>
   <td>
   <label style="font-size:28px" for="fname2">Time</label>
   </td>
   <td>
   <input style="font-size:22px" size="5" type="text" oninput="update_Service_Record();" id="Service_Start_Time" name="Service_Start_Time" onfocus="Change_Save_Color_to_blue();">
   </td>
   <td>
   <label style="font-size:28px" for="fname2">~</label>
   </td>
   <td>
   <input style="font-size:22px" size="5" type="text" oninput="update_Service_Record();" id="Service_End_Time" name="Service_End_Time" onfocus="Change_Save_Color_to_blue();">
   </td>
   <td>
   <label style="font-size:28px" for="fname2">Usher:</label>
   </td>
   <td>
   <input style="font-size:22px" size="13" type="text" oninput="update_Service_Record();" id="Usher" name="Usher" onfocus="Change_Save_Color_to_blue();">
   </td>

   <br><br>


   <label style="font-size:28px" for="fname2">Topic: </label>
   <input style="font-size:22px" size="50" type="text" oninput="update_Service_Record();" id="Topic" name="Topic" onfocus="Change_Save_Color_to_blue();">
   <label style="font-size:28px" for="fname2">Hymn: </label>
   <input style="font-size:22px" size="9" type="text" oninput="update_Service_Record();" id="Hymn" name="Hymn" onfocus="Change_Save_Color_to_blue();">

   <br>
   <label style="font-size:28px" for="fname2">Speaker: </label>
   <input style="font-size:22px" size="15" type="text" oninput="update_Service_Record();" id="Speaker" name="Speaker" onfocus="Change_Save_Color_to_blue();"> 
   <label style="font-size:28px" for="fname2">Interp: </label>
   <input style="font-size:22px" size="13" type="text" oninput="update_Service_Record();" id="Interp" name="Interp" onfocus="Change_Save_Color_to_blue();"> 
   <label style="font-size:28px" for="fname2">Hymnal Leader:</label>
   <input style="font-size:22px" size="13" type="text" oninput="update_Service_Record();" id="Hymnal" name="Hymnal" onfocus="Change_Save_Color_to_blue();"> 

   <br>
   &nbsp;&nbsp;
   <button style="font-size:16px" onclick="Show_Name_List()">Show Sermon Speaker Name List</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   <button style="font-size:16px" onclick="Show_Name_List2()">Show Interpreter Name List</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   <button style="font-size:16px" onclick="Show_Name_List3()">Show Hymnal Leader Name List</button>


   <div id="tool_area_9" style="font-size:26px;height:0%;display:none"> 

     <a href="javascript:;" onclick="Show_Name('Dn Chen 陳恩光');">Dn Chen 陳恩光</a>
     <a href="javascript:;" onclick="Show_Name('Dn Ko 柯恩宏');">Dn Ko 柯恩宏</a>
     <a href="javascript:;" onclick="Show_Name('Dn Lee 李雅各');">Dn Lee 李雅各</a>
     <a href="javascript:;" onclick="Show_Name('Br Ko 柯獻中');">Br Ko 柯獻中</a>
     <a href="javascript:;" onclick="Show_Name('Br Ko 柯宇恆');">Br Ko 柯宇恆</a>
     <a href="javascript:;" onclick="Show_Name('Br Lawrence C');">Br Lawrence C</a>

     <br>
     <a href="javascript:;" onclick="Show_Name('Br Liu 劉邦光');">Br Liu 劉邦光</a>
     <a href="javascript:;" onclick="Show_Name('Br Kuo 郭淼義');">Br Kuo 郭淼義</a>
     <a href="javascript:;" onclick="Show_Name('Br Chuy 許琮瑋');">Br Chuy 許琮瑋</a>
     <a href="javascript:;" onclick="Show_Name('Br Yang 楊恩加');">Br Yang 楊恩加</a>
     <a href="javascript:;" onclick="Show_Name('Br Chen 陳效謙');">Br Chen 陳效謙</a>

     <br>
     <a href="javascript:;" onclick="Show_Name('Br Nugraha S');">Br Nugraha S</a>
     <a href="javascript:;" onclick="Show_Name('Br Chen 陳展志');">Br Chen 陳展志</a>
     <a href="javascript:;" onclick="Show_Name('Br Chin 陳頌祈');">Br Chin 陳頌祈</a>
     <a href="javascript:;" onclick="Show_Name('Br Huang 黃明仁');">Br Huang 黃明仁</a>
     <a href="javascript:;" onclick="Show_Name('Br Chang 張世光');">Br Chang 張世光</a>

     <br>
     <a href="javascript:;" onclick="Show_Name('Pr Li 黎傳道');">Pr Li 黎傳道</a>
     <a href="javascript:;" onclick="Show_Name('Pr Shih 施福安');">Pr Shih 施福安</a>
     <a href="javascript:;" onclick="Show_Name('Eld Shaw 邵銘恩');">Eld Shaw 邵銘恩</a>
     <a href="javascript:;" onclick="Show_Name('Br Shaw 邵偉昕');">Br Shaw 邵偉昕</a>
     <a href="javascript:;" onclick="Show_Name('Br Shaw 邵奕昕');">Br Shaw 邵奕昕</a>

     <br>
     <a href="javascript:;" onclick="Show_Name('Br Liang 梁賢聖');">Br Liang 梁賢聖</a>
     <a href="javascript:;" onclick="Show_Name('Br Ong 翁秀民');">Br Ong 翁秀民</a>
     <a href="javascript:;" onclick="Show_Name('Br Shih 施志恩');">Br Shih 施志恩</a>
     <a href="javascript:;" onclick="Show_Name('Dn Yang 楊從真');">Dn Yang 楊從真</a>
     <a href="javascript:;" onclick="Show_Name('Dn Shaw 邵錫恩');">Dn Shaw 邵錫恩</a>

     <br>
     <a href="javascript:;" onclick="Show_Name('Br Tu 杜博宇');">Br Tu 杜博宇</a>
     <a href="javascript:;" onclick="Show_Name('Br Anderson Tan');">Br Anderson Tan</a>
     <a style="color:red" href="javascript:;" onclick="Hide_Name_List();">Close</a>

   </div>

   <div id="tool_area_10" style="font-size:26px;height:0%;display:none"> 

     <a href="javascript:;" onclick="Show_Name2('Aaron C');">Aaron C</a>
     <a href="javascript:;" onclick="Show_Name2('Aaron K');">Aaron K</a>
     <a href="javascript:;" onclick="Show_Name2('Carnegie S');">Carnegie S</a>
     <a href="javascript:;" onclick="Show_Name2('Daniel K');">Daniel K</a>
     <a href="javascript:;" onclick="Show_Name2('Eric S');">Eric S</a>
     <a href="javascript:;" onclick="Show_Name2('Gloria C');">Gloria C</a>
     <a href="javascript:;" onclick="Show_Name2('Grace Lee');">Grace Lee</a>
     <a href="javascript:;" onclick="Show_Name2('Joel C');">Joel C</a>

     <br>
     <a href="javascript:;" onclick="Show_Name2('John S');">John S</a>
     <a href="javascript:;" onclick="Show_Name2('Joyce H');">Joyce H</a>
     <a href="javascript:;" onclick="Show_Name2('Sam Y');">Sam Y</a>
     <a href="javascript:;" onclick="Show_Name2('Ted T');">Ted T</a>
     <a href="javascript:;" onclick="Show_Name2('Terie L');">Terie L</a>
     <a href="javascript:;" onclick="Show_Name2('Wayne S');">Wayne S</a>
     <a style="color:red" href="javascript:;" onclick="Hide_Name_List2();">Close</a>

   </div>

   <div id="tool_area_11" style="font-size:26px;height:0%;display:none"> 

     <a href="javascript:;" onclick="Show_Name3('Amy L');">Amy L</a>
     <a href="javascript:;" onclick="Show_Name3('Anabella L');">Anabella L</a>
     <a href="javascript:;" onclick="Show_Name3('Angelina S');">Angelina S</a>
     <a href="javascript:;" onclick="Show_Name3('Christine C');">Christine C</a>
     <a href="javascript:;" onclick="Show_Name3('Christopher K');">Christopher K</a>
     <a href="javascript:;" onclick="Show_Name3('Crystal Y');">Crystal Y</a>
     <a href="javascript:;" onclick="Show_Name3('Daphne L');">Daphne L</a>

     <br>
     <a href="javascript:;" onclick="Show_Name3('Esther K');">Esther K</a>
     <a href="javascript:;" onclick="Show_Name3('Gloria C');">Gloria C</a>
     <a href="javascript:;" onclick="Show_Name3('Grace Lee');">Grace Lee</a>
     <a href="javascript:;" onclick="Show_Name3('Grace Liang');">Grace Liang</a>
     <a href="javascript:;" onclick="Show_Name3('Helen Y');">Helen Y</a>
     <a href="javascript:;" onclick="Show_Name3('Jasmine W');">Jasmine W</a>
     <a href="javascript:;" onclick="Show_Name3('Joel C');">Joel C</a>
     <a href="javascript:;" onclick="Show_Name3('Jonathan B');">Jonathan B</a>

     <br>
     <a href="javascript:;" onclick="Show_Name3('Joshua C');">Joshua C</a>
     <a href="javascript:;" onclick="Show_Name3('Joyce C');">Joyce C</a>
     <a href="javascript:;" onclick="Show_Name3('Lawrence C');">Lawrence C</a>
     <a href="javascript:;" onclick="Show_Name3('Luke Y');">Luke Y</a>
     <a href="javascript:;" onclick="Show_Name3('Malcolm K');">Malcolm K</a>
     <a href="javascript:;" onclick="Show_Name3('Matias L');">Matias L</a>
     <a href="javascript:;" onclick="Show_Name3('Melissa P');">Melissa P</a>
     <a href="javascript:;" onclick="Show_Name3('Michelle S');">Michelle S</a>

     <br>
     <a href="javascript:;" onclick="Show_Name3('Mike L');">Mike L</a>
     <a href="javascript:;" onclick="Show_Name3('Monica S');">Monica S</a>
     <a href="javascript:;" onclick="Show_Name3('Natasha S');">Natasha S</a>
     <a href="javascript:;" onclick="Show_Name3('Peter L');">Peter L</a>
     <a href="javascript:;" onclick="Show_Name3('Ryan L');">Ryan L</a>
     <a href="javascript:;" onclick="Show_Name3('Samuel L');">Samuel L</a>
     <a href="javascript:;" onclick="Show_Name3('Sara H');">Sara H</a>
     <a href="javascript:;" onclick="Show_Name3('Sasha Y');">Sasha Y</a>
     <a href="javascript:;" onclick="Show_Name3('Susi I');">Susi I</a>

     <br>
     <a href="javascript:;" onclick="Show_Name3('Vivien W');">Vivien W</a>
     <a href="javascript:;" onclick="Show_Name3('Wendy Y');">Wendy Y</a>
     <a href="javascript:;" onclick="Show_Name3('Yung C');">Yung C</a>
     <a style="color:red" href="javascript:;" onclick="Hide_Name_List3();">Close</a>


   </div>


   <div id="tool_area_12" style="font-size:26px;height:30%;display:block"> 

   <table>
   <tr>
   <td>
   <label style="font-size:28px" for="fname2">Note:</label>
   </td>
   </tr>
   <tr>
   <td>
   <textarea cols="60" rows="8" name="A1" oninput="update_Service_Record();" id="Service_Record_Note" style="font-size:20pt" Wrap="Off" onkeyup=";" onmouseup=";" onfocus="Change_Save_Color_to_blue();" onBlur=";"></textarea>
   </td>
   </tr>
   </table>

   </div>


<center>
<table>
<table border=1 width=100% text=white>

<tr>

<td align=left>
  <label style="font-size:16pt;color:blue" for="fname2"><b>V</b>isitor <b>B</b>rother <b>M</b>ember: </label>
  <input style="font-size:16pt" size="3" type="text" oninput="update_Service_Record();" id="Visitor_Brother_Member" name="Visitor_Brother_Member">
</td>

<td align=center>

</td>

<td>
<p align=center style="font-size:16pt;"><b>M</b>ember</p>
</td>

<td>
<p align=center style="font-size:16pt;"><b>T</b>ruth<b> S</b>eeker</p>
</td>

<td>
<p align=center style="font-size:16pt;">Total</p>
</td>
</tr>


<tr>

<td align=left>
  <label style="font-size:16pt;color:red" for="fname2"><b>V</b>isitor <b>S</b>ister <b>M</b>ember: </label>
  <input style="font-size:16pt" size="3" type="text" oninput="update_Service_Record();" id="Visitor_Sister_Member" name="Visitor_Sister_Member">
</td>

<td><p align=center style="font-size:16pt;color:blue"><b>B</b>rother</p></td>

<td>
<p align=center id="BroM" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="BroTrs" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="BroTotal" style="font-size:18pt;"></p>
</td>
</tr>


<tr>

<td align=left>
  <label style="font-size:16pt;color:blue" for="fname2"><b>V</b>isitor <b>B</b>rother <b>T</b>ruth <b>S</b>eeker: </label>
  <input style="font-size:16pt" size="3" type="text" oninput="update_Service_Record();" id="Visitor_Brother_Truth_Seeker" name="Visitor_Brother_Truth_Seeker">
</td>

<td><p align=center style="font-size:16pt;color:red"><b>S</b>ister</p></td>

<td>
<p align=center id="SisM" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="SisTrs" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="SisTotal" style="font-size:18pt;"></p>
</td>
</tr>


<tr>

<td align=left>
  <label style="font-size:16pt;color:red" for="fname2"><b>V</b>isitor <b>S</b>ister <b>T</b>ruth <b>S</b>eeker: </label>
  <input style="font-size:16pt" size="3" type="text" oninput="update_Service_Record();" id="Visitor_Sister_Truth_Seeker" name="Visitor_Sister_Truth_Seeker">
</td>

<td align=center>
<input style="font-size:13pt" type="button" name="M222" id="Total_Button" value="Total" onclick="Show_Total(); return false;">
</td>

<td>
<p align=center id="MemTotal" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="TrsTotal" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="AllTotal" style="font-size:18pt;"></p>
</td>
</tr>


</table>
</center>


<center>
<table>

<tr>

<td>
<button style="font-size:12pt;" onclick="Show_Subtotal_Not_on_the_Roll()">Subtotal - Visitors</button>
</td>

<td></td><td></td><td></td><td></td>

<td></td><td></td><td></td><td></td> <td></td><td></td><td></td><td></td>

<td></td><td></td><td></td><td></td> <td></td><td></td><td></td><td></td>

<td></td><td></td><td></td><td></td> <td></td><td></td><td></td><td></td>

<td></td><td></td><td></td><td></td> <td></td><td></td><td></td><td></td>

<td></td><td></td><td></td><td></td>


<td>
<button style="font-size:12pt;" onclick="Show_Subtotal_on_the_Roll()">Subtotal - Names on the Roll</button>
</td>


<td>
<input class="topfont2" type="button" id="etest" value="e" onclick="return false;">
</td>

</tr>

<tr><td></td></tr>

</table>
</center>



</div>






<script>


//<div id="tool_area" style="height:0px;">
</script>



<div id="tool_area_2" style="height:0px;visibility:hidden">

<table>
<tr><th colspan="2"><div id="bookmark1"></div></th><th colspan="2"><div id="bookmark2"></div></th><th colspan="2"><div id="bookmark3"></div></th><th colspan="2"><div id="bookmark4"></div></th><th colspan="2"><div id="bookmark5"></div></th><th colspan="2"><div id="bookmark6"></div></th><th colspan="2"><div id="bookmark7"></div></th></tr>
<tr>
<form name="WR_TO_TXT_1">
<td>
<input type="button" name="B11" value="存書籤1" onclick="write_to_json_1(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_1">
<td>
<input type="button" name="B11" value="讀書籤1" onclick="read_from_json_1();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤2" onclick="write_to_json_2(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤2" onclick="read_from_json_2();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤3" onclick="write_to_json_3(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤3" onclick="read_from_json_3();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_1">
<td>
<input type="button" name="B11" value="存書籤4" onclick="write_to_json_4(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_1">
<td>
<input type="button" name="B11" value="讀書籤4" onclick="read_from_json_4();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤5" onclick="write_to_json_5(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤5" onclick="read_from_json_5();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤6" onclick="write_to_json_6(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤6" onclick="read_from_json_6();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤7" onclick="write_to_json_7(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤7" onclick="read_from_json_7();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<td></td><td></td><td></td><td></td><td></td>


<td></td><td></td><td></td>


</FORM>

</tr></table>

</div>


<script>
//document.getElementById("etest").style.visibility='hidden'; // hide 
document.getElementById("etest").style.display="none"; // "none" or "inline"

function efocus() {  // do nothing
    //document.getElementById("etest").style.visibility='visible'; // visible
    document.getElementById("etest").style.display="inline"; // display
    document.getElementById("etest").focus(); 
    //document.getElementById("etest").style.visibility='hidden'; // hide 
    document.getElementById("etest").style.display="none"; // "none" 
};


function efocus_v2() {  // do nothing

    document.getElementById("Search_fname2").focus(); 

}


//document.getElementById("etest").focus();
//<td>
//<input class="topfont2" type="button" name="B11" value="Pause" onclick="Mousetrap.pause(); return false;">
//</td>
//<td>
//<input class="topfont2" type="button" name="B11" value="UnPause" onclick="Mousetrap.unpause(); return false;">
//</td>
</script>

<script>


// Mousetrap -- test

   Mousetrap.addKeycodes({
       144: 'numlock'
   });
   Mousetrap.addKeycodes({
       96: 'Numpad0'
   });
   Mousetrap.addKeycodes({
       97: 'Numpad1'
   });
   Mousetrap.addKeycodes({
       98: 'Numpad2'
   });
   Mousetrap.addKeycodes({
       99: 'Numpad3'
   });
   Mousetrap.addKeycodes({
       100: 'Numpad4'
   });
   Mousetrap.addKeycodes({
       101: 'Numpad5'
   });
   Mousetrap.addKeycodes({
       102: 'Numpad6'
   });
   Mousetrap.addKeycodes({
       103: 'Numpad7'
   });
   Mousetrap.addKeycodes({
       104: 'Numpad8'
   });
   Mousetrap.addKeycodes({
       105: 'Numpad9'
   });

// single keys 
    //Mousetrap.bind('a b c', function() { change(); }); // For press 'abc'
    //Mousetrap.bind('d', function() { change(); });
    //Mousetrap.bind('numlock', function() { change(); });
    //Mousetrap.bind('Numpad2', function() { change(); });
    //Mousetrap.bind('enter', function() { change(); });
    //Mousetrap.bind('right', function() { change(); });
    //Mousetrap.bind('left', function() { change(); });

    //Mousetrap.bind("?", function() { console.log('show shortcuts!'); });
    //Mousetrap.bind('esc', function() { console.log('escape'); }, 'keyup');
    //Mousetrap.bind('numlock', function() { console.log('numlock'); }, 'keypress');

    //Mousetrap.trigger('b');
    //Mousetrap.trigger('c');

    //Mousetrap.bind('b', function() { keyFunction(66,'b'); }, 'keyup');
    //Mousetrap.bind('c 1', function() { keyFunction(67,'c'); }, 'keyup');
    //Mousetrap.bind('1', function() { keyFunction(97,'1'); }, 'keyup');
    //Mousetrap.bind('Numpad1', function() { keyFunction(97,'1'); }, 'keyup');

    //Mousetrap.bind('c', function() { keyFunction2('c1'); });
    //Mousetrap.bind('b 1', function() { keyFunction2('b',1); });
    //Mousetrap.bind('b 1 0', function() { keyFunction2('b',10); });
    //Mousetrap.bind('b 1 1', function() { keyFunction2('b',11); });
    //Mousetrap.bind('b 2 3', function() { keyFunction2('b',23); });
    //Mousetrap.bind(['b 0 1','b 1'], function() { keyFunction2('b',1); });
    //Mousetrap.bind('c 1', function() { keyFunction2('c',1); });


    // for keyFunction test
    //Mousetrap.bind('b', function() { keyFunction('b'); });
    //Mousetrap.bind('0', function() { keyFunction(0); });
    //Mousetrap.bind('1', function() { keyFunction(1); });
    //Mousetrap.bind('2', function() { keyFunction(2); });
    //Mousetrap.bind('3', function() { keyFunction(3); });
    //Mousetrap.bind('4', function() { keyFunction(4); });




    // 由使用Mousetrap.bind 全改為使用 Mousetrap.bindGlobal ***

    

    // for keyFunction2 test

    //Mousetrap.bindGlobal('esc', function() { reset_Keyin(); enableRolling();});  //efocus()
    Mousetrap.bindGlobal('esc', function() { reset_Keyin(); });  //efocus()

    Mousetrap.bindGlobal('b', function() { keyFunction2('b'); efocus();});
    Mousetrap.bindGlobal('c', function() { keyFunction2('c'); efocus();}); // for chap
    Mousetrap.bindGlobal('v', function() { keyFunction2('v'); efocus();}); // for verse
    Mousetrap.bindGlobal('t', function() { keyFunction2('t'); efocus();}); // for to_verse


    Mousetrap.bindGlobal('enter', function() { keyFunction2('enter');efocus(); });
    //Mousetrap.bindGlobal('backspace', function() { keyFunction2('backspace'); });
    //Mousetrap.bindGlobal('+', function() { keyFunction2('+'); });

    //Mousetrap.bindGlobal('right', function() { keyFunction2('right'); ;});        //efocus();
    //Mousetrap.bindGlobal('left', function() { keyFunction2('left'); ;});        //efocus();
    //Mousetrap.bindGlobal('up', function() { keyFunction2('up');efocus2() ;});             //efocus()
    //Mousetrap.bindGlobal('down', function() { keyFunction2('down');efocus2() ;});         //efocus()
    //Mousetrap.bindGlobal('space', function() { keyFunction2('space');enableRolling() ;});       //efocus()

    Mousetrap.bindGlobal('right', function() { keyFunction2('right');efocus() ;});        //efocus();
    Mousetrap.bindGlobal('left', function() { keyFunction2('left');efocus() ;});        //efocus();
    Mousetrap.bindGlobal('up', function() { keyFunction2('up');efocus() ;});             //efocus()
    Mousetrap.bindGlobal('down', function() { keyFunction2('down');efocus() ;});         //efocus()
    Mousetrap.bindGlobal('space', function() { keyFunction2('space');efocus() ;});       //efocus()

    Mousetrap.bindGlobal('0', function() { keyFunction2(0); });
    Mousetrap.bindGlobal('1', function() { keyFunction2(1); });
    Mousetrap.bindGlobal('2', function() { keyFunction2(2); });
    Mousetrap.bindGlobal('3', function() { keyFunction2(3); });
    Mousetrap.bindGlobal('4', function() { keyFunction2(4); });
    Mousetrap.bindGlobal('5', function() { keyFunction2(5); });
    Mousetrap.bindGlobal('6', function() { keyFunction2(6); });
    Mousetrap.bindGlobal('7', function() { keyFunction2(7); });
    Mousetrap.bindGlobal('8', function() { keyFunction2(8); });
    Mousetrap.bindGlobal('9', function() { keyFunction2(9); });


    // For Book Name Input
    Mousetrap.bindGlobal('a', function() { keyFunction2('a');efocus(); });
    Mousetrap.bindGlobal('d', function() { keyFunction2('d');efocus(); });
    Mousetrap.bindGlobal('e', function() { keyFunction2('e');efocus(); });
    Mousetrap.bindGlobal('g', function() { keyFunction2('g');efocus(); });
    Mousetrap.bindGlobal('h', function() { keyFunction2('h');efocus(); });
    Mousetrap.bindGlobal('i', function() { keyFunction2('i');efocus(); });
    Mousetrap.bindGlobal('j', function() { keyFunction2('j');efocus(); });
    Mousetrap.bindGlobal('k', function() { keyFunction2('k');efocus(); });
    Mousetrap.bindGlobal('l', function() { keyFunction2('l');efocus(); });
    Mousetrap.bindGlobal('m', function() { keyFunction2('m');efocus(); });
    Mousetrap.bindGlobal('n', function() { keyFunction2('n');efocus(); });
    Mousetrap.bindGlobal('o', function() { keyFunction2('o');efocus(); });
    //Mousetrap.bindGlobal('p', function() { keyFunction2('p'); ; });          //efocus()
    Mousetrap.bindGlobal('p', function() { keyFunction2('p');efocus(); });          //efocus()
    Mousetrap.bindGlobal('r', function() { keyFunction2('r');efocus(); });
    Mousetrap.bindGlobal('s', function() { keyFunction2('s');efocus(); });
    Mousetrap.bindGlobal('u', function() { keyFunction2('u');efocus(); });
    Mousetrap.bindGlobal('x', function() { keyFunction2('x');efocus(); });
    Mousetrap.bindGlobal('z', function() { keyFunction2('z');efocus(); });





    // 由使用Mousetrap.bind 全改為使用 Mousetrap.bindGlobal ***





    //Mousetrap.bind(['m t','m a t'], function()   { keyFunction3(40); }); // Mat
    //Mousetrap.bind(['m k','m a r'], function()   { keyFunction3(41); }); // Mark
    //Mousetrap.bind(['l k','l u k'], function() { keyFunction3(42); }); // Luk
    //Mousetrap.bind('j n', function() { keyFunction3(43); }); // John


    // for keyFunction2 test


    //readchapter(nowbook,nowchapter,--nowsection)
  
    //for Listen NKJV
    Mousetrap.bindGlobal('alt+l', function() { Listen_NKJV_web(); }); // Alt+L


// End of Mousetrap

// For 讀經系統，將 "C"(chap) 換為"X"                         *****
// For 投影系統，將 "C"(chap) 換為"X"， "T"(to) 換為"Y"       *****
// 1Co 林前，以 "co1" 輸入
// 2Co 林後，以 "co2" 輸入
// Jn  約翰福音書
// 1Jn 約翰ㄧ書，以 "jo1" 輸入
// 1Jn 約翰二書，以 "jo2" 輸入


function Qmaxchap(index) {  // find out maximum chapter of book , add on 15.04.2015
                            // index, start from 0 to 65, input book_int
                            // output maxchap
        var i;
	var cnum=new Array(50,40,27,36,34,24,21,4,31,24,22,25,29,36,10,13,10,42,150,31,12,8,66,52,5,48,12,
	14,3,9,1,4,7,3,3,3,2,14,4, 28,16,24,21,28,16,16,13,6,6,4,4,5,3,6,4,3,1,13,5,5,3,5,1,1,1,22);
	i=cnum[index];
        maxchap = i;
}

function Qmaxverse(index,index2) {   // find out maximum verse of chapter of book , add on 16.04.2015
                                     // index  , input book_int
                                     // index2 , input chap_int
        var i;
        var a,s,s2;
        s = 0;
        s2 = 0;
	var cnum=new Array(50,40,27,36,34,24,21,4,31,24,22,25,29,36,10,13,10,42,150,31,12,8,66,52,5,48,12,
	14,3,9,1,4,7,3,3,3,2,14,4, 28,16,24,21,28,16,16,13,6,6,4,4,5,3,6,4,3,1,13,5,5,3,5,1,1,1,22);
 
	var snum=new Array(31,25,24,26,32,22,24,22,29,32,32,20,
	18,24,21,16,27,33,38,18,34,24,20,67,34,35,46,22,35,43,55,
	32,20,31,29,43,36,30,23,23,57,38,34,34,28,34,31,
	22,33,26,22,25,22,31,23,30,25,32,35,29,10,51,22,
	31,27,36,16,27,25,26,36,31,33,18,40,37,21,43,46,
	38,18,35,23,35,35,38,29,31,43,38,17,16,17,35,19,
	30,38,36,24,20,47,8,59,57,33,34,16,30,37,27,24,
	33,44,23,55,46,34,54,34,51,49,31,27,89,26,23,36,
	35,16,33,45,41,50,13,32,22,29,35,41,30,25,18,65,
	23,31,40,16,54,42,56,29,34,13,46,37,29,49,33,25,
	26,20,29,22,32,32,18,29,23,22,20,22,21,20,23,30,
	25,22,19,19,26,68,29,20,30,52,29,12,18,24,17,24,
	15,27,26,35,27,43,23,24,33,15,63,10,18,28,51,9,
	45,34,16,33,36,23,31,24,31,40,25,35,57,18,40,15,
	25,20,20,31,13,31,30,48,25,22,23,18,22,28,36,21,
	22,12,21,17,22,27,27,15,25,23,52,35,23,58,30,24,
	42,15,23,29,22,44,25,12,25,11,31,13,27,32,39,12,
	25,23,29,18,13,19,27,31,39,33,37,23,29,33,43,26,
	22,51,39,25,53,46,28,34,18,38,51,66,28,29,43,33,
	34,31,34,34,24,46,21,43,29,53,18,25,27,44,27,33,
	20,29,37,36,21,21,25,29,38,20,41,37,37,21,26,
    20,37,20,30,54,55,24,43,26,81,40,40,44,
    14,47,40,14,17,29,43,27,17,19,8,31,19,
    32,31,31,32,34,21,30,17,18,17,22,14,42,
    22,18,31,19,23,16,22,15,19,14,19,34,11,
    37,20,12,21,27,28,23,9,27,36,27,21,33,
    25,33,27,23,11,70,13,24,17,22,28,36,15,
    44,11,20,32,23,19,19,73,18,38,39,36,47,
    31,22,23,15,17,14,14,10,17,32,3,22,13,
    26,21,27,30,21,22,35,22,20,25,28,22,35,
    22,16,21,29,29,34,30,17,25,6,14,23,28,
    25,31,40,22,33,37,16,33,24,41,30,24,34,
    17,6,12,8,8,12,10,17,9,20,18,7,8,
    6,7,5,11,15,50,14,9,13,31,6,10,22,
    12,14,9,11,12,24,11,22,22,28,12,40,22,
    13,17,13,11,5,26,17,11,9,14,20,23,19,
    9,6,7,23,13,11,11,17,12,8,12,11,10,
    13,20,7,35,36,5,24,20,28,23,10,12,20,
    72,13,19,16,8,18,12,13,17,7,18,52,17,
    16,15,5,23,11,13,12,9,9,5,8,28,22,
    35,45,48,43,13,31,7,10,10,9,8,18,19,
    2,29,176,7,8,9,4,8,5,6,5,6,8,
    8,3,18,3,3,21,26,9,8,24,13,10,7,
    12,15,21,10,20,14,9,6,33,22,35,27,23,
    35,27,36,18,32,31,28,25,35,33,33,28,24,
    29,30,31,29,35,34,28,28,27,28,27,33,31,
    18,26,22,16,20,12,29,17,18,20,10,14,17,
    17,11,16,16,13,13,14,31,22,26,6,30,13,
    25,22,21,34,16,6,22,32,9,14,14,7,25,
    6,17,25,18,23,12,21,13,29,24,33,9,20,
    24,17,10,22,38,22,8,31,29,25,28,28,25,
    13,15,22,26,11,23,15,12,17,13,12,21,14,
    21,22,11,12,19,12,25,24,19,37,25,31,31,
    30,34,22,26,25,23,17,27,22,21,21,27,23,
    15,18,14,30,40,10,38,24,22,17,32,24,40,
    44,26,22,19,32,21,28,18,16,18,22,13,30,
    5,28,7,47,39,46,64,34,22,22,66,22,22,
    28,10,27,17,17,14,27,18,11,22,25,28,23,
    23,8,63,24,32,14,49,32,31,49,27,17,21,
    36,26,21,26,18,32,33,31,15,38,28,23,29,
    49,26,20,27,31,25,24,23,35,21,49,30,37,
    31,28,28,27,27,21,45,13,11,23,5,19,15,
    11,16,14,17,15,12,14,16,9,20,32,21,15,
    16,15,13,27,14,17,14,15,21,17,10,10,11,
    16,13,12,13,15,16,20,15,13,19,17,20,19,
    18,15,20,15,23,21,13,10,14,11,15,14,23,
    17,12,17,14,9,21,14,17,18,6,25,23,17,
    25,48,34,29,34,38,42,30,50,58,36,39,28,
    27,35,30,34,46,46,39,51,46,75,66,20,45,
    28,35,41,43,56,37,38,50,52,33,44,37,72,
    47,20,80,52,38,44,39,49,50,56,62,42,54,
    59,35,35,32,31,37,43,48,47,38,71,56,53,
    51,25,36,54,47,71,53,59,41,42,57,50,38,
    31,27,33,26,40,42,31,25,26,47,26,37,42,
    15,60,40,43,48,30,25,52,28,41,40,34,28,
    41,38,40,30,35,27,27,32,44,31,32,29,31,
    25,21,23,25,39,33,21,36,21,14,23,33,27,
    31,16,23,21,13,20,40,13,27,33,34,31,13,
    40,58,24,24,17,18,18,21,18,16,24,15,18,
    33,21,14,24,21,29,31,26,18,23,22,21,32,
    33,24,30,30,21,23,29,23,25,18,10,20,13,
    18,28,12,17,18,20,15,16,16,25,21,18,26,
    17,22,16,15,15,25,14,18,19,16,14,20,28,
    13,28,39,40,29,25,27,26,18,17,20,25,25,
    22,19,14,21,22,18,10,29,24,21,21,13,15,
    25,20,29,22,11,14,17,17,13,21,11,19,17,
    18,20,8,21,18,24,21,15,27,21,21);

    // selectedbook = selectedbook1;
	
    for(i=0;i<index;i++) {
      s = s + cnum[i];
    }
     
    s2 = s + index2;
    a=snum[s2];

    maxverse = a;

}





// 20171025

</script>  

<div id="tool_area_3" style="height:0px;visibility:hidden">

<table>
<tr><th colspan="2"><div id="bookmark8"></div></th><th colspan="2"><div id="bookmark9"></div></th><th colspan="2"><div id="bookmark10"></div></th><th colspan="2"><div id="bookmark11"></div></th><th colspan="2"><div id="bookmark12"></div></th><th colspan="2"><div id="bookmark13"></div></th><th colspan="2"><div id="bookmark14"></div></th></tr>
<tr>
<form name="WR_TO_TXT_1">
<td>
<input type="button" name="B11" value="存書籤8" onclick="write_to_json_8(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_1">
<td>
<input type="button" name="B11" value="讀書籤8" onclick="read_from_json_8();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤9" onclick="write_to_json_9(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤9" onclick="read_from_json_9();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤10" onclick="write_to_json_10(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤10" onclick="read_from_json_10();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_1">
<td>
<input type="button" name="B11" value="存書籤11" onclick="write_to_json_11(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_1">
<td>
<input type="button" name="B11" value="讀書籤11" onclick="read_from_json_11();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤12" onclick="write_to_json_12(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤12" onclick="read_from_json_12();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤13" onclick="write_to_json_13(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤13" onclick="read_from_json_13();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</form>
<form name="WR_TO_TXT_2">
<td>
<input type="button" name="B11" value="存書籤14" onclick="write_to_json_14(nowbook,nowchapter,nowsection, nowtosection); return false;">
</td>
</form>
<form name="RD_FROM_TXT_2">
<td>
<input type="button" name="B11" value="讀書籤14" onclick="read_from_json_14();Send_to_win34(11,0,0,0,0,0,0); return false;">
</td>
</tr></table>
</form>

<div style="font-size:2pt"> <HR width="100%"> </div>

<table>
<tr>
<td></td><td></td><td></td><td></td>

<td><button onclick="Show_History_Only()">Show Verse History</button></td>
<td><button onclick="Hide_History_Only()">Hide Verse History</button></td>

<td></td><td></td><td></td><td></td>
</tr>
</table>

<div style="font-size:2pt"> <HR width="100%"> </div>

</div>





<table><tr>


<td>



<script>

// clear_bookmark(document.ClearBookmark.na.selectedIndex);

function setup_size1()
{
   sec_size =document.setup_body_size2.body2.options.value;  
   bcs_size =document.setup_body_size2.body2.options.value;
}
function setup_display()
{
   disp_secs_a =document.setup_disp_secs.body2.options.value;
}
function setup_open_window()
{
   open_win =document.setup_open_win.body2.options.value;
   if(open_win==2)
      open_win1();
}

//const remote = require('electron').remote;
//const BrowserWindow = remote.BrowserWindow;
//const Store2 = require('./store2.js');  // Store Bible Reading Records in current directory

// First instantiate the class
// For Store Bible Reading Records 1
// width  -- for Book1
// height -- for chapter1
// x      -- for verse1

//const store = new Store2({
//  // We'll call our data file 'Reading-Bible-Record1'
//  configName: 'Reading-Bible-Record1',
//  defaults: {
    
//    windowBounds: { width: 44, height: 4, x: 12, y:20 }
//  }
//});

// Reading records
// let { width, height, x, y } = store.get('windowBounds');

// Writing records
// store.set('windowBounds', { width, height, x, y });


function write_A1() // 將讀經進度寫入記錄檔1, "Reading-Bible-Record-1.json"
{
   //var fso_w1=new ActiveXObject("Scripting.FileSystemObject");
  
   var R_Book_w1=nowbook;
   var R_Chap_w1=nowchapter;
   var R_Vers_w1=nowsection;

   //var width=nowbook;
   //var height=nowchapter;
   //var x=nowsection;


   //var f_w1=fso_w1.createtextfile("D:\\Scott_Data\\Dropbox\\Offline Bible\\BibleR43\\logs\\Reading_Bible_Record1.js",2,true);

   //var R_String_w1 = 'ReadingRecord1 = new Array (' + R_Book_w1 + ',' + R_Chap_w1 + ',' + R_Vers_w1 + ');';

   // Writing records
   //store.set('windowBounds', { width, height, x });

   //write_to_json1(R_Book_w1, R_Chap_w1, R_Vers_w1);
   write_to_json1(nowbook, nowchapter, nowsection);


   //readchapter_R(R_Book_w1,R_Chap_w1,R_Vers_w1,1);

   //f_w1.write(R_String_w1);

   //f_w1.close(); 
}

function write_A2() // 將讀經進度寫入記錄檔2
{
   var fso_w2=new ActiveXObject("Scripting.FileSystemObject");
  
   var R_Book_w2=nowbook;
   var R_Chap_w2=nowchapter;
   var R_Vers_w2=nowsection;


   var f_w2=fso_w2.createtextfile("D:\\Scott_Data\\Dropbox\\Offline Bible\\BibleR43\\logs\\Reading_Bible_Record2.js",2,true);

   var R_String_w2 = 'ReadingRecord2 = new Array (' + R_Book_w2 + ',' + R_Chap_w2 + ',' + R_Vers_w2 + ');';


   readchapter_R(R_Book_w2,R_Chap_w2,R_Vers_w2,2);

   f_w2.write(R_String_w2);

   f_w2.close(); 
}

function write_A3() // 將讀經進度寫入記錄檔3
{
   var fso_w3=new ActiveXObject("Scripting.FileSystemObject");
  
   var R_Book_w3=nowbook;
   var R_Chap_w3=nowchapter;
   var R_Vers_w3=nowsection;


   var f_w3=fso_w3.createtextfile("D:\\Scott_Data\\Dropbox\\Offline Bible\\BibleR43\\logs\\Reading_Bible_Record3.js",2,true);

   var R_String_w3 = 'ReadingRecord3 = new Array (' + R_Book_w3 + ',' + R_Chap_w3 + ',' + R_Vers_w3 + ');';


   readchapter_R(R_Book_w3,R_Chap_w3,R_Vers_w3,3);

   f_w3.write(R_String_w3);

   f_w3.close(); 
}

function read_A1() // 讀取讀經進度從記錄檔1
{

   var R_Book_r1= ReadingRecord1[0]; 
   var R_Chap_r1= ReadingRecord1[1];
   var R_Vers_r1= ReadingRecord1[2];

   readchapter(R_Book_r1,R_Chap_r1,R_Vers_r1);

   //f2.close(); 
}

function read_A2() // 讀取讀經進度從記錄檔2
{

   var R_Book_r2= ReadingRecord2[0]; 
   var R_Chap_r2= ReadingRecord2[1];
   var R_Vers_r2= ReadingRecord2[2];

   readchapter(R_Book_r2,R_Chap_r2,R_Vers_r2);

   //f2.close(); 
}

function read_A3() // 讀取讀經進度從記錄檔3
{

   var R_Book_r3= ReadingRecord3[0]; 
   var R_Chap_r3= ReadingRecord3[1];
   var R_Vers_r3= ReadingRecord3[2];

   readchapter(R_Book_r3,R_Chap_r3,R_Vers_r3);

   //f2.close(); 
}


// For Using Electron

    // Using ipcRenderer to send & receive Message from Main Process

    const ipc = require('electron').ipcRenderer;

    function Send_to_win34(arg1,arg2,arg3,arg4,arg5,arg6,arg7){                       // window3 refer to main.html, window4 refer to main2.html
       ipc.send('asynchronous-message-to-win34', arg1,arg2,arg3,arg4,arg5,arg6,arg7); // Send args to main.html via main.js
    }

    // Send_to_win34(arg1,arg2,arg3,arg4,arg5,arg6,arg7)
    // arg1 = 11, 表 放大 window
    // arg1 = 9 , 表 Minimize window, and hide rest of windows
    // arg1 = 8 , 表 Show all windows, except window5
    // arg1 = 7 , 表 Show window5
    // arg1 = 6 , 表 send validate() 之 arg 給 main.js, 由 main.js 轉發給 window5-即 result.html via ping-win5
    //            此時: arg2 為 給 validate() 之 arg - 即 document.search.query.value
    // arg1 = 0 , 表 Close all windows
    // arg1 = 1 , 表 send readchapter() 之 args
    //            此時: arg2,arg3,arg4 為 readchapter() 之 args
    //                  arg5 為 BibleVersion_Disp
    //                  arg6 為 disp_secs_a
    //                  arg7 因此時不用，就傳 0
    // Ex: Send_to_win34(1,arg2,arg3,arg4,0,0,0)


    // Receive message from main.js chanel:'ping-win'
    require('electron').ipcRenderer.on('ping-win', function(event, arg1,arg2,arg3,arg4,arg5,arg6,arg7) {

       //document.write('<tr>'+ 'Receive: ' + arg1 + arg2 + arg3 + '</tr>'); // for debug
       //document.writeln('<tr>'+ 'Receive: ' + arg1 + ', ' + arg2 + ', ' + arg3 + '</tr>' + '\n' ); // for debug

       //BibleVersion_Disp = arg5; // 0:顯示NKJV, 1:顯示NIV, 2:顯示呂振中譯本, 3顯示全部版本

       //disp_secs_a = arg6; 

       readchapter(arg2,arg3,arg4);
       //Send_to_win34(1,arg2,arg3,arg4,BibleVersion_Disp,disp_secs_a,0);



    }); // End of chanel:'ping-win'


// End of Using Electron

// <HR NOSHADE WIDTH=100%>

// <div id="container1" style="height:538px;width:600px;float:left;">

</script>

</td></tr></table>


<script>


//TEST1<br>
//<a id="a1" href="javascript:;" onclick="change()">顯示書籤</a><br>
//<div id="d1" style="display: none">
//TEST2<br>
//TEST3
//</div>
//TEST4<br>



var isShow = false;
function change() {
	if(!isShow) {  // 顯示書籤
		isShow = true;
		//document.getElementById('d1').style.display='';
		//document.getElementById('a1').innerText = "隱藏xxx資料";
		document.getElementById('a1').innerText = "隱藏書籤";
                read_bookmark1();read_bookmark2();read_bookmark3();read_bookmark4();
                read_bookmark5();read_bookmark6();read_bookmark7();
                read_bookmark8();read_bookmark9();read_bookmark10();read_bookmark11();
                read_bookmark12();read_bookmark13();read_bookmark14();
                //read_bookmark8();read_bookmark9();   // for test
                //read_bookmark13();read_bookmark14(); // for test

                //if(isShow_Tool == true){
                   document.getElementById("tool_area_2").style.height='50px';
                   document.getElementById("tool_area_3").style.height='80px';
                //}
                //else{
                //   document.getElementById("tool_area_2").style.height='30px';
                //   document.getElementById("tool_area_3").style.height='30px';
                //}

	}
	else {        // 隱藏書籤
		isShow = false;
		//document.getElementById('d1').style.display='none';
		//document.getElementById('a1').innerText = "檢視xxx資料";
		document.getElementById('a1').innerText = "顯示書籤";
                hide_bookmark1();hide_bookmark2();hide_bookmark3();hide_bookmark4();
                hide_bookmark5();hide_bookmark6();hide_bookmark7();
                hide_bookmark8();hide_bookmark9();hide_bookmark10();hide_bookmark11();
                hide_bookmark12();hide_bookmark13();hide_bookmark14();
                //hide_bookmark8();hide_bookmark9();   // for test
                //hide_bookmark13();hide_bookmark14(); // for test
                //document.getElementById("tool_area_3").style.visibility='visible';
                //document.getElementById("tool_area_3").style.height='50px';

                //if(isShow_Tool == true){
                //   document.getElementById("tool_area_2").style.height='50px';
                //   document.getElementById("tool_area_3").style.height='50px';
                //}
                //else{
                   document.getElementById("tool_area_2").style.height='30px';
                   document.getElementById("tool_area_3").style.height='60px';
                //}

 	}			
}


var isShow_Tool = false;
function change2() {
	if(!isShow_Tool) {  // 顯示工具區

		isShow_Tool = true;
                show_tool_area();
		document.getElementById('a2').innerText = "隱藏工具區";
         
                if(isShow == true){
                   document.getElementById("tool_area_2").style.height='50px';
                   document.getElementById("tool_area_3").style.height='80px';// 原為50px
                }
                else{
                   document.getElementById("tool_area_2").style.height='30px';
                   document.getElementById("tool_area_3").style.height='60px';// 原為30px
                }

	}
	else {        // 隱藏工具區

		isShow_Tool = false;
                hide_tool_area();
		document.getElementById('a2').innerText = "顯示工具區";

                //if(isShow == true){
                //   document.getElementById("tool_area_2").style.height='50px';
                //   document.getElementById("tool_area_3").style.height='50px';
                //}
                //else{
                //   document.getElementById("tool_area_2").style.height='30px';
                //   document.getElementById("tool_area_3").style.height='30px';
                //}

	}			
}

function Hide_Some(){

   document.getElementById("container_Bro").style.visibility='hidden';

}

var Bro_M = 0;
var Bro_TrS = 0;   //Bro Truth Seeker
var Bro_Total = 0; //Bro Total

var Sis_M = 0;
var Sis_TrS = 0;   //Sis Truth Seeker
var Sis_Total = 0; //Sis Total

var Mem_Total = 0; //Mem Total
var TrS_Total = 0; //Truth Seeker Total
var All_Total = 0; //All Total


var In_BroM_F = 0;     // 1 means in Input_BroMember_Mode
var In_BroTrS_F = 0;   // 1 means in Input_BroTruSeeker_Mode()

var In_SisM_F = 0;     // 1 means in Input_SisMember_Mode()
var In_SisTrS_F = 0;   // 1 means in Input_SisTruSeeker_Mode()


var key_A=0;    // 1 means click "+"
var key_A1=0;
var key_A2=0;
var key_A3=0;

var key_S=0;    // 1 means click "-"
var key_S1=0;
var key_S2=0;
var key_S3=0;

var Add_Num = 0;
var Sub_Num = 0;

var A_num = 0;
var A_num1 = 0;
var A_num2 = 0;
var A_num3 = 0;

var S_num = 0;
var S_num1 = 0;
var S_num2 = 0;
var S_num3 = 0;


function Input_BroMember_Mode(){

   In_BroM_F = 1;
   In_BroTrS_F = 0;
   In_SisM_F = 0;
   In_SisTrS_F = 0;

   //document.getElementById("Bro_Member").style.color="white"; // black
   //document.getElementById("Bro_Member").style.backgroundColor='blue';

   //document.getElementById("Bro_TruSeeker").style.color="blue"; 
   //document.getElementById("Bro_TruSeeker").style.backgroundColor=''; 

   //document.getElementById("Sis_Member").style.color="red";
   //document.getElementById("Sis_Member").style.backgroundColor='';

   //document.getElementById("Sis_TruSeeker").style.color="red";
   //document.getElementById("Sis_TruSeeker").style.backgroundColor='';

   document.getElementById("container_Disp").style.visibility='visible';
   document.getElementById("container_Disp").style.height='70%';

   document.getElementById("People_Number").style.color='blue';    //20180906
   document.getElementById("People_Number").innerText= 'Brother Member: ' + Bro_M;

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

   document.getElementById("BroM").style.color="white";
   document.getElementById("BroM").style.backgroundColor='blue';
   document.getElementById("BroTrs").style.color="black";
   document.getElementById("BroTrs").style.backgroundColor='';
   document.getElementById("SisM").style.color="black";
   document.getElementById("SisM").style.backgroundColor='';
   document.getElementById("SisTrs").style.color="black";
   document.getElementById("SisTrs").style.backgroundColor='';

   Reset_Number_Pad_Color();
   
}

function Input_SisMember_Mode(){

   In_BroM_F = 0;
   In_BroTrS_F = 0;
   In_SisM_F = 1;
   In_SisTrS_F = 0;

   //document.getElementById("Bro_Member").style.color="blue"; // black
   //document.getElementById("Bro_Member").style.backgroundColor='';

   //document.getElementById("Bro_TruSeeker").style.color="blue"; 
   //document.getElementById("Bro_TruSeeker").style.backgroundColor=''; 

   //document.getElementById("Sis_Member").style.color="white";
   //document.getElementById("Sis_Member").style.backgroundColor='red';

   //document.getElementById("Sis_TruSeeker").style.color="red";
   //document.getElementById("Sis_TruSeeker").style.backgroundColor='';

   //document.getElementById("Bro_Member").style.color="white"; 
   //document.getElementById("Bro_TruSeeker").style.color="white"; 
   //document.getElementById("Sis_Member").style.color="black";
   //document.getElementById("Sis_TruSeeker").style.color="white";

   document.getElementById("container_Disp").style.visibility='visible';
   document.getElementById("container_Disp").style.height='70%';

   document.getElementById("People_Number").style.color='red';    //20180906
   document.getElementById("People_Number").innerText= 'Sister Member: ' + Sis_M;

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

   document.getElementById("BroM").style.color="black";
   document.getElementById("BroM").style.backgroundColor='';
   document.getElementById("BroTrs").style.color="black";
   document.getElementById("BroTrs").style.backgroundColor='';
   document.getElementById("SisM").style.color="white";
   document.getElementById("SisM").style.backgroundColor='red';
   document.getElementById("SisTrs").style.color="black";
   document.getElementById("SisTrs").style.backgroundColor='';

   //document.getElementById("BroM").style.backgroundColor='';
   //document.getElementById("BroTrs").style.backgroundColor='';
   //document.getElementById("SisM").style.backgroundColor='red';
   //document.getElementById("SisTrs").style.backgroundColor='';

   Reset_Number_Pad_Color();
   
}



function Input_BroTruSeeker_Mode(){

   In_BroM_F = 0;
   In_BroTrS_F = 1;
   In_SisM_F = 0;
   In_SisTrS_F = 0;

   //document.getElementById("Bro_Member").style.color="blue"; // black
   //document.getElementById("Bro_Member").style.backgroundColor='';

   //document.getElementById("Bro_TruSeeker").style.color="white"; 
   //document.getElementById("Bro_TruSeeker").style.backgroundColor='blue'; 

   //document.getElementById("Sis_Member").style.color="red";
   //document.getElementById("Sis_Member").style.backgroundColor='';

   //document.getElementById("Sis_TruSeeker").style.color="red";
   //document.getElementById("Sis_TruSeeker").style.backgroundColor='';

   //document.getElementById("Bro_Member").style.color="white"; 
   //document.getElementById("Bro_TruSeeker").style.color="black"; 
   //document.getElementById("Sis_Member").style.color="white";
   //document.getElementById("Sis_TruSeeker").style.color="white";

   document.getElementById("container_Disp").style.visibility='visible';
   document.getElementById("container_Disp").style.height='70%';

   document.getElementById("People_Number").style.color='blue';    //20180906
   document.getElementById("People_Number").innerText= 'Brother Truth Seeker: ' + Bro_TrS;

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

   document.getElementById("BroM").style.color="black";
   document.getElementById("BroM").style.backgroundColor='';
   document.getElementById("BroTrs").style.color="white";
   document.getElementById("BroTrs").style.backgroundColor='blue';
   document.getElementById("SisM").style.color="black";
   document.getElementById("SisM").style.backgroundColor='';
   document.getElementById("SisTrs").style.color="black";
   document.getElementById("SisTrs").style.backgroundColor='';

   //document.getElementById("BroM").style.backgroundColor='';
   //document.getElementById("BroTrs").style.backgroundColor='blue';
   //document.getElementById("SisM").style.backgroundColor='';
   //document.getElementById("SisTrs").style.backgroundColor='';

   Reset_Number_Pad_Color();
   
}

function Input_SisTruSeeker_Mode(){

   In_BroM_F = 0;
   In_BroTrS_F = 0;
   In_SisM_F = 0;
   In_SisTrS_F = 1;

   //document.getElementById("Bro_Member").style.color="blue"; // black
   //document.getElementById("Bro_Member").style.backgroundColor='';

   //document.getElementById("Bro_TruSeeker").style.color="blue"; 
   //document.getElementById("Bro_TruSeeker").style.backgroundColor=''; 

   //document.getElementById("Sis_Member").style.color="red";
   //document.getElementById("Sis_Member").style.backgroundColor='';

   //document.getElementById("Sis_TruSeeker").style.color="white";
   //document.getElementById("Sis_TruSeeker").style.backgroundColor='red';

   //document.getElementById("Bro_Member").style.color="white"; 
   //document.getElementById("Bro_TruSeeker").style.color="white"; 
   //document.getElementById("Sis_Member").style.color="white";
   //document.getElementById("Sis_TruSeeker").style.color="black";

   document.getElementById("container_Disp").style.visibility='visible';
   document.getElementById("container_Disp").style.height='70%';

   document.getElementById("People_Number").style.color='red';    //20180906
   document.getElementById("People_Number").innerText= 'Sister Truth Seeker: ' + Sis_TrS;

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

   document.getElementById("BroM").style.color="black";
   document.getElementById("BroM").style.backgroundColor='';
   document.getElementById("BroTrs").style.color="black";
   document.getElementById("BroTrs").style.backgroundColor='';
   document.getElementById("SisM").style.color="black";
   document.getElementById("SisM").style.backgroundColor='';
   document.getElementById("SisTrs").style.color="white";
   document.getElementById("SisTrs").style.backgroundColor='red';

   //document.getElementById("BroM").style.backgroundColor='';
   //document.getElementById("BroTrs").style.backgroundColor='';
   //document.getElementById("SisM").style.backgroundColor='';
   //document.getElementById("SisTrs").style.backgroundColor='red';

   Reset_Number_Pad_Color();
   
}



function Input_Bro_Mode(){

   document.getElementById("container_Bro").style.visibility='visible';
   document.getElementById("container_Bro").style.height='15%';

   document.getElementById("container_Sis").style.visibility='hidden';
   document.getElementById("container_Sis").style.height='0%';

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

}

function Input_Sis_Mode(){

   document.getElementById("container_Bro").style.visibility='hidden';
   document.getElementById("container_Bro").style.height='0%';

   document.getElementById("container_Sis").style.visibility='visible';
   document.getElementById("container_Sis").style.height='15%';

   document.getElementById("container_Total").style.visibility='hidden';
   document.getElementById("container_Total").style.height='0%';

   document.getElementById("container_Reset_Button").style.visibility='hidden';
   document.getElementById("container_Reset_Button").style.height='0%';

}


function Show_Subtotal_Not_on_the_Roll() {

   document.getElementById("BroM").innerText= Bro_M;
   document.getElementById("BroTrs").innerText= Bro_TrS;

   document.getElementById("SisM").innerText= Sis_M;
   document.getElementById("SisTrs").innerText= Sis_TrS;

   document.getElementById("BroTotal").innerText= Bro_M + Bro_TrS;
   document.getElementById("SisTotal").innerText= Sis_M + Sis_TrS;

   document.getElementById("MemTotal").innerText= Bro_M + Sis_M;
   document.getElementById("TrsTotal").innerText= Bro_TrS + Sis_TrS;

   document.getElementById("AllTotal").innerText= Bro_M + Bro_TrS + Sis_M + Sis_TrS;

   document.getElementById("AllTotal").style.backgroundColor='green';


} // End of function Show_Subtotal_Not_on_the_Roll()


async function Show_Subtotal_on_the_Roll() {

  //var DateStr = ML_Date_V2();

  if (Display_ID_2 != '') {

     var DateStr = Display_ID_2;

  }
  else {

     var DateStr = ML_Date_V2();

  }

  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();

  Show_Subtotal_on_the_Roll_Mode();

} // End of function Show_Subtotal_on_the_Roll()


async function Show_Service_Record(arg) {

  var ID_2_tmp = arg;

  let Verse = await dbT2.Service_Record.where('ID_2').equals(ID_2_tmp).toArray();


  if (Verse) {

     //document.getElementById("Mesg2").style.color = "red";

     Display_ID_1 = Verse[0].ID_1;

     Display_ID_2 = Verse[0].ID_2;

     if (ID_2_tmp == G_ServiceDate2) {

        document.getElementById("Service_Date").style.color = "blue";

     }
     else {

        document.getElementById("Service_Date").style.color = "black";

     }

     document.getElementById("Service_Date").value = Verse[0].Service_Date;

     document.getElementById("Service_Start_Time").value = Verse[0].Service_Start_Time;
     document.getElementById("Service_End_Time").value = Verse[0].Service_End_Time;
     document.getElementById("Usher").value = Verse[0].Usher;

     document.getElementById("Topic").value = Verse[0].Topic;
     document.getElementById("Hymn").value = Verse[0].Hymn;

     document.getElementById("Speaker").value = Verse[0].Speaker;
     document.getElementById("Interp").value = Verse[0].Interp;
     document.getElementById("Hymnal").value = Verse[0].Hymnal;

     document.getElementById("Service_Record_Note").value = Verse[0].Note;

     //let Bro_M_Note = Bro_M;      // for Bro_M not on the Roll
     //let Sis_M_Note = Sis_M;      // for Sis_M not on the Roll
     //let Bro_TrS_Note = Bro_TrS;  // for Bro_TrS not on the Roll
     //let Sis_TrS_Note = Sis_TrS;  // for Sis_TrS not on the Roll

     //localStorage.Bro_M = Verse[0].Bro_M_Note;
     //localStorage.Sis_M = Verse[0].Sis_M_Note;
     //localStorage.Bro_Trs = Verse[0].Bro_TrS_Note;
     //localStorage.Sis_Trs = Verse[0].Sis_TrS_Note;

     Bro_M = Verse[0].Bro_M_Note;
     Sis_M = Verse[0].Sis_M_Note;
     Bro_TrS = Verse[0].Bro_TrS_Note;
     Sis_TrS = Verse[0].Sis_TrS_Note;

        //Bro_TrS = Verse.Bro_TrS_Note;   // Bro_TrS_Note ,   Bro_Trs -->  Bro_TrS   ***
        //Sis_TrS = Verse.Sis_TrS_Note;   // Sis_TrS_Note     Sis_Trs -->  Sis_TrS   ***

     Show_Total();

  }


} // End of function Show_Service_Record(arg)


async function Search_Next_Service_Record() {

   if (Display_ID_1 != '') {

      document.getElementById("Send email").innerHTML = 'Send email';

      let Next_Verse = await dbT2.Service_Record.where('ID_1').above(Display_ID_1).first();

      Display_ID_1 = Next_Verse.ID_1;

      Display_ID_2 = Next_Verse.ID_2;

      var ServiceDate2_tmp = ML_Date_V2();   // Now ***

      if (Display_ID_2 == ServiceDate2_tmp) { // ML_Date_V2()

         document.getElementById("Service_Date").style.color = "blue";

         Roll_Call_V2('R');

      }
      else {

         document.getElementById("Service_Date").style.color = "black";

         Roll_Call_V3('S',Display_ID_2); // <-- for show history attendance

      }

 
     document.getElementById("Service_Date").value = Next_Verse.Service_Date;

     document.getElementById("Service_Start_Time").value = Next_Verse.Service_Start_Time;
     document.getElementById("Service_End_Time").value = Next_Verse.Service_End_Time;
     document.getElementById("Usher").value = Next_Verse.Usher;

     document.getElementById("Topic").value = Next_Verse.Topic;
     document.getElementById("Hymn").value = Next_Verse.Hymn;

     document.getElementById("Speaker").value = Next_Verse.Speaker;
     document.getElementById("Interp").value = Next_Verse.Interp;
     document.getElementById("Hymnal").value = Next_Verse.Hymnal;

     document.getElementById("Service_Record_Note").value = Next_Verse.Note;

     Bro_M = Number(Next_Verse.Bro_M_Note);
     Sis_M = Number(Next_Verse.Sis_M_Note);
     Bro_TrS = Number(Next_Verse.Bro_TrS_Note);
     Sis_TrS = Number(Next_Verse.Sis_TrS_Note);

     var DateStr = Display_ID_2;

     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';


     Show_Total_Mode(); // Add on 2020.10.07


     //Roll_Call_V3('S',DateStr); // <-- for show history attendance

   }
   else {

      document.getElementById("Send email").innerHTML = 'Send email';

      //var First_Verse = await dbT2.books.where('name').startsWithIgnoreCase(Book_tmp).first();

      let Next_Verse = await dbT2.Service_Record.where('ID_1').startsWithIgnoreCase('2').first();

      Display_ID_1 = Next_Verse.ID_1;

      Display_ID_2 = Next_Verse.ID_2;

      var ServiceDate2_tmp = ML_Date_V2();   // Now ***

      if (Display_ID_2 == ServiceDate2_tmp) { // ML_Date_V2()

         document.getElementById("Service_Date").style.color = "blue";

         Roll_Call_V2('R');

      }
      else {

         document.getElementById("Service_Date").style.color = "black";

         Roll_Call_V3('S',Display_ID_2); // <-- for show history attendance

      }

     document.getElementById("Service_Date").value = Next_Verse.Service_Date;

     document.getElementById("Service_Start_Time").value = Next_Verse.Service_Start_Time;
     document.getElementById("Service_End_Time").value = Next_Verse.Service_End_Time;
     document.getElementById("Usher").value = Next_Verse.Usher;

     document.getElementById("Topic").value = Next_Verse.Topic;
     document.getElementById("Hymn").value = Next_Verse.Hymn;

     document.getElementById("Speaker").value = Next_Verse.Speaker;
     document.getElementById("Interp").value = Next_Verse.Interp;
     document.getElementById("Hymnal").value = Next_Verse.Hymnal;

     document.getElementById("Service_Record_Note").value = Next_Verse.Note;


     Bro_M = Number(Next_Verse.Bro_M_Note);
     Sis_M = Number(Next_Verse.Sis_M_Note);
     Bro_TrS = Number(Next_Verse.Bro_TrS_Note);
     Sis_TrS = Number(Next_Verse.Sis_TrS_Note);

     var DateStr = Display_ID_2;

     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';


     Show_Total_Mode(); // Add on 2020.10.07


     //Roll_Call_V3('S',DateStr); // <-- for show history attendance


   } // End of if (Display_ID_1 != '')


} // End of function Search_Next_Service_Record()



async function Search_Prev_Service_Record() {

   if (Display_ID_1 != '') {

      document.getElementById("Send email").innerHTML = 'Send email';

      //let Prev_Verse = await dbT2.Service_Record.where('ID_1').below(Display_ID_1).first();

      let Prev_Verse = await dbT2.Service_Record.where('ID_1').below(Display_ID_1).reverse().first();

      Display_ID_1 = Prev_Verse.ID_1;

      Display_ID_2 = Prev_Verse.ID_2;


      var ServiceDate2_tmp = ML_Date_V2();   // Now ***

      if (Display_ID_2 == ServiceDate2_tmp) { // ML_Date_V2()

         document.getElementById("Service_Date").style.color = "blue";

         Roll_Call_V2('R');

      }
      else {

         document.getElementById("Service_Date").style.color = "black";

         Roll_Call_V3('S',Display_ID_2); // <-- for show history attendance

      }


      //document.getElementById("Service_Date").style.color = "black";

     // -----

     document.getElementById("Service_Date").value = Prev_Verse.Service_Date;

     document.getElementById("Service_Start_Time").value = Prev_Verse.Service_Start_Time;
     document.getElementById("Service_End_Time").value = Prev_Verse.Service_End_Time;
     document.getElementById("Usher").value = Prev_Verse.Usher;

     document.getElementById("Topic").value = Prev_Verse.Topic;
     document.getElementById("Hymn").value = Prev_Verse.Hymn;

     document.getElementById("Speaker").value = Prev_Verse.Speaker;
     document.getElementById("Interp").value = Prev_Verse.Interp;
     document.getElementById("Hymnal").value = Prev_Verse.Hymnal;

     document.getElementById("Service_Record_Note").value = Prev_Verse.Note;

     Bro_M = Number(Prev_Verse.Bro_M_Note);
     Sis_M = Number(Prev_Verse.Sis_M_Note);
     Bro_TrS = Number(Prev_Verse.Bro_TrS_Note);
     Sis_TrS = Number(Prev_Verse.Sis_TrS_Note);

     var DateStr = Display_ID_2;

     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';

     Show_Total_Mode(); // Add on 2020.10.07


     //Roll_Call_V3('S',DateStr); // <-- for show history attendance


   }
   else {

      document.getElementById("Send email").innerHTML = 'Send email';

      //let Next_Verse = await dbT2.Service_Record.where('ID_1').startsWithIgnoreCase('2').first();

      let Prev_Verse = await dbT2.Service_Record.where('ID_1').startsWithIgnoreCase('2').last();

      Display_ID_1 = Prev_Verse.ID_1;

      Display_ID_2 = Prev_Verse.ID_2;

      var ServiceDate2_tmp = ML_Date_V2();   // Now ***

      if (Display_ID_2 == ServiceDate2_tmp) { // ML_Date_V2()

         document.getElementById("Service_Date").style.color = "blue";

         Roll_Call_V2('R');

      }
      else {

         document.getElementById("Service_Date").style.color = "black";

         Roll_Call_V3('S',Display_ID_2); // <-- for show history attendance

      }

      //document.getElementById("Service_Date").style.color = "black";

     document.getElementById("Service_Date").value = Prev_Verse.Service_Date;

     document.getElementById("Service_Start_Time").value = Prev_Verse.Service_Start_Time;
     document.getElementById("Service_End_Time").value = Prev_Verse.Service_End_Time;
     document.getElementById("Usher").value = Prev_Verse.Usher;

     document.getElementById("Topic").value = Prev_Verse.Topic;
     document.getElementById("Hymn").value = Prev_Verse.Hymn;

     document.getElementById("Speaker").value = Prev_Verse.Speaker;
     document.getElementById("Interp").value = Prev_Verse.Interp;
     document.getElementById("Hymnal").value = Prev_Verse.Hymnal;

     document.getElementById("Service_Record_Note").value = Prev_Verse.Note;

     Bro_M = Number(Prev_Verse.Bro_M_Note);
     Sis_M = Number(Prev_Verse.Sis_M_Note);
     Bro_TrS = Number(Prev_Verse.Bro_TrS_Note);
     Sis_TrS = Number(Prev_Verse.Sis_TrS_Note);

     var DateStr = Display_ID_2;

     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';


     Show_Total_Mode(); // Add on 2020.10.07


     //Roll_Call_V3('S',DateStr); // <-- for show history attendance


   } // End of if (Display_ID_1 != '')


} // End of function Search_Prev_Service_Record()


async function Search_Service_Record() {

  document.getElementById("Send email").innerHTML = 'Send email';

  var ID_2_tmp = document.getElementById("Search_Rervice_Record_date").value;

  let Verse = await dbT2.Service_Record.where('ID_2').equals(ID_2_tmp).toArray();


  if (Verse.length>0) {

     //document.getElementById("Mesg2").style.color = "red";

     Display_ID_1 = Verse[0].ID_1;

     Display_ID_2 = Verse[0].ID_2;

     var ServiceDate2_tmp = ML_Date_V2();   // Now ***

     //if (ID_2_tmp == G_ServiceDate2) { // ML_Date_V2()

     if (ID_2_tmp == ServiceDate2_tmp) { // ML_Date_V2()

        document.getElementById("Service_Date").style.color = "blue";

     }
     else {

        document.getElementById("Service_Date").style.color = "black";

     }

     document.getElementById("Service_Date").value = Verse[0].Service_Date;

     document.getElementById("Service_Start_Time").value = Verse[0].Service_Start_Time;
     document.getElementById("Service_End_Time").value = Verse[0].Service_End_Time;
     document.getElementById("Usher").value = Verse[0].Usher;

     document.getElementById("Topic").value = Verse[0].Topic;
     document.getElementById("Hymn").value = Verse[0].Hymn;

     document.getElementById("Speaker").value = Verse[0].Speaker;
     document.getElementById("Interp").value = Verse[0].Interp;
     document.getElementById("Hymnal").value = Verse[0].Hymnal;

     document.getElementById("Service_Record_Note").value = Verse[0].Note;

     //let Bro_M_Note = Bro_M;      // for Bro_M not on the Roll
     //let Sis_M_Note = Sis_M;      // for Sis_M not on the Roll
     //let Bro_TrS_Note = Bro_TrS;  // for Bro_TrS not on the Roll
     //let Sis_TrS_Note = Sis_TrS;  // for Sis_TrS not on the Roll

     //localStorage.Bro_M = Verse[0].Bro_M_Note;
     //localStorage.Sis_M = Verse[0].Sis_M_Note;
     //localStorage.Bro_Trs = Verse[0].Bro_TrS_Note;
     //localStorage.Sis_Trs = Verse[0].Sis_TrS_Note;

     Bro_M = Number(Verse[0].Bro_M_Note);
     Sis_M = Number(Verse[0].Sis_M_Note);
     Bro_TrS = Number(Verse[0].Bro_TrS_Note);
     Sis_TrS = Number(Verse[0].Sis_TrS_Note);

     //Show_Total();

     //Show_Headcount_4();

     var DateStr = Display_ID_2;

     //var DateStr = '20200929E';


     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     //Show_Total_Mode();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';

     // Start Writing to Local Storage

     //localStorage.Bro_M = Number(Bro_M);     // Mark on 2020.10.02
     //localStorage.Sis_M = Number(Sis_M);
     //localStorage.Bro_Trs = Number(Bro_TrS);
     //localStorage.Sis_Trs = Number(Sis_TrS);

     // End of Writing to Local Storage


     //Roll_Call_V2('S'); // <-- for show history attendance

     Roll_Call_V3('S',DateStr); // <-- for show history attendance

  }
  else {

     Clear_Service_Record2();

     Reset_All();

     var DateStr = ID_2_tmp;

     //var DateStr = '20200929E';


     var Record_Bro_M_Str = DateStr + '_M_B_';
     var Record_Bro_TrS_Str = DateStr + '_T_B_';

     var Record_Sis_M_Str = DateStr + '_M_S_';
     var Record_Sis_TrS_Str = DateStr + '_T_S_';

     Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
     Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

     Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
     Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


     //Show_Total_Mode();


     document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
     document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

     document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
     document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
     document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

     document.getElementById("AllTotal").style.backgroundColor='green';

     Roll_Call_V3('S',ID_2_tmp); // <-- for show history attendance

  }


} // End of function Search_Service_Record()


function Show_Subtotal_on_the_Roll_Mode() {

   document.getElementById("BroM").innerText= Attendance_Bro_M;
   document.getElementById("BroTrs").innerText= Attendance_Bro_TrS;

   document.getElementById("SisM").innerText= Attendance_Sis_M;
   document.getElementById("SisTrs").innerText= Attendance_Sis_TrS;

   document.getElementById("BroTotal").innerText= Attendance_Bro_M + Attendance_Bro_TrS;
   document.getElementById("SisTotal").innerText= Attendance_Sis_M + Attendance_Sis_TrS;

   document.getElementById("MemTotal").innerText= Attendance_Bro_M + Attendance_Sis_M;
   document.getElementById("TrsTotal").innerText= Attendance_Bro_TrS + Attendance_Sis_TrS;

   document.getElementById("AllTotal").innerText= Attendance_Bro_M + Attendance_Bro_TrS + Attendance_Sis_M + Attendance_Sis_TrS;

   document.getElementById("AllTotal").style.backgroundColor='green';


} // End of Show_Subtotal_on_the_Roll_Mode()


function Show_Total_Mode(){

   document.getElementById("BroM").innerText= Bro_M + Attendance_Bro_M;
   document.getElementById("BroTrs").innerText= Bro_TrS + Attendance_Bro_TrS;

   document.getElementById("SisM").innerText= Sis_M + Attendance_Sis_M;
   document.getElementById("SisTrs").innerText= Sis_TrS + Attendance_Sis_TrS;

   document.getElementById("BroTotal").innerText= Bro_M + Attendance_Bro_M + Bro_TrS + Attendance_Bro_TrS;
   document.getElementById("SisTotal").innerText= Sis_M + Attendance_Sis_M + Sis_TrS + Attendance_Sis_TrS;

   document.getElementById("MemTotal").innerText= Bro_M + Attendance_Bro_M + Sis_M + Attendance_Sis_M;
   document.getElementById("TrsTotal").innerText= Bro_TrS + Attendance_Bro_TrS + Sis_TrS + Attendance_Sis_TrS;

   document.getElementById("AllTotal").innerText= Bro_M + Attendance_Bro_M + Bro_TrS + Attendance_Bro_TrS + Sis_M + Attendance_Sis_M + Sis_TrS + Attendance_Sis_TrS;

   document.getElementById("AllTotal").style.backgroundColor='green';

   // Add on 2020.10.07

   document.getElementById("Visitor_Brother_Member").value= Bro_M;  

   document.getElementById("Visitor_Sister_Member").value= Sis_M;

   document.getElementById("Visitor_Brother_Truth_Seeker").value= Bro_TrS;   

   document.getElementById("Visitor_Sister_Truth_Seeker").value= Sis_TrS;



   // Start Writing to Local Storage

   //localStorage.Bro_M = Bro_M;       // Mark on 2020.10.2
   //localStorage.Sis_M = Sis_M;
   //localStorage.Bro_Trs = Bro_TrS;
   //localStorage.Sis_Trs = Sis_TrS;

   // End of Writing to Local Storage


   //document.getElementById("container_Total").style.visibility='visible';
   //document.getElementById("container_Total").style.height='70%';

   //document.getElementById("container_Bro").style.visibility='hidden';
   //document.getElementById("container_Bro").style.height='0%';

   //document.getElementById("container_Sis").style.visibility='hidden';
   //document.getElementById("container_Sis").style.height='0%';

   //document.getElementById("container_Disp").style.visibility='hidden';
   //document.getElementById("container_Disp").style.height='0%';

   //document.getElementById("container_Reset_Button").style.visibility='hidden';
   //document.getElementById("container_Reset_Button").style.height='0%';

}  // End of function Show_Total_Mode()


function Show_Total(){

   //document.getElementById("Bro_Member").style.color="blue"; // black
   //document.getElementById("Bro_Member").style.backgroundColor='';

   //document.getElementById("Bro_TruSeeker").style.color="blue"; 
   //document.getElementById("Bro_TruSeeker").style.backgroundColor=''; 

   //document.getElementById("Sis_Member").style.color="red";
   //document.getElementById("Sis_Member").style.backgroundColor='';

   //document.getElementById("Sis_TruSeeker").style.color="red";
   //document.getElementById("Sis_TruSeeker").style.backgroundColor='';


   document.getElementById("BroM").style.color="black";
   document.getElementById("BroM").style.backgroundColor='';
   document.getElementById("BroTrs").style.color="black";
   document.getElementById("BroTrs").style.backgroundColor='';

   document.getElementById("SisM").style.color="black";
   document.getElementById("SisM").style.backgroundColor='';
   document.getElementById("SisTrs").style.color="black";
   document.getElementById("SisTrs").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';


   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("People_Number").innerText= '';
   document.getElementById("container_Disp").style.visibility='hidden';
   document.getElementById("container_Disp").style.height='0%';

  
   Show_Headcount();


} // End of function Show_Total()



function Zero_Pressed() {

   document.getElementById("0").style.backgroundColor='yellow';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function One_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='yellow';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Two_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='yellow';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Three_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='yellow';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Four_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='yellow';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Five_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='yellow';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Six_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='yellow';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Seven_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='yellow';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Eight_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='yellow';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Nine_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='yellow';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Add_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='yellow';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function Sub_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='yellow';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function C_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='yellow';

   document.getElementById("E").style.backgroundColor='';

   document.getElementById("AllTotal").style.backgroundColor='';

}

function E_Pressed() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='yellow';

   document.getElementById("Send email").innerHTML = 'Send email';

   var Now_Date = ML_Date_V2();

   if(Now_Date==G_ServiceDate2 && G_ServiceDate2==Display_ID_2) {

      update_Service_Record();

   }

}

function Reset_Number_Pad_Color() {

   document.getElementById("0").style.backgroundColor='';
   document.getElementById("1").style.backgroundColor='';
   document.getElementById("2").style.backgroundColor='';
   document.getElementById("3").style.backgroundColor='';
   document.getElementById("4").style.backgroundColor='';
   document.getElementById("5").style.backgroundColor='';
   document.getElementById("6").style.backgroundColor='';
   document.getElementById("7").style.backgroundColor='';
   document.getElementById("8").style.backgroundColor='';
   document.getElementById("9").style.backgroundColor='';

   document.getElementById("Add").style.backgroundColor='';
   document.getElementById("Sub").style.backgroundColor='';
   document.getElementById("C").style.backgroundColor='';

   document.getElementById("E").style.backgroundColor='';

}


function Init_Total_Mode(){

   // Start Reading from Local Storage

   if(localStorage.Bro_M) {
      localStorage.Bro_M = Number(localStorage.Bro_M);
   }else {
      localStorage.Bro_M = 0;
   }

   if(localStorage.Sis_M) {
      localStorage.Sis_M = Number(localStorage.Sis_M);
   }else {
      localStorage.Sis_M = 0;
   }

   if(localStorage.Bro_Trs) {
      localStorage.Bro_Trs = Number(localStorage.Bro_Trs);
   }else {
      localStorage.Bro_Trs = 0;
   }

   if(localStorage.Sis_Trs) {
      localStorage.Sis_Trs = Number(localStorage.Sis_Trs);
   }else {
      localStorage.Sis_Trs = 0;
   }

   //Bro_M = Number(localStorage.Bro_M);                  // Mark on 2020.10.02
   //Bro_TrS = Number(localStorage.Bro_Trs);
   //Sis_M = Number(localStorage.Sis_M);
   //Sis_TrS = Number(localStorage.Sis_Trs);


   Bro_M = 0;
   Bro_TrS = 0;
   Sis_M = 0;
   Sis_TrS = 0;


   // End of Reading from Local Storage


   document.getElementById("BroM").innerText= Bro_M;
   document.getElementById("BroTrs").innerText= Bro_TrS;

   document.getElementById("SisM").innerText= Sis_M;
   document.getElementById("SisTrs").innerText= Sis_TrS;

   document.getElementById("BroTotal").innerText= Bro_M + Bro_TrS;
   document.getElementById("SisTotal").innerText= Sis_M + Sis_TrS;

   document.getElementById("MemTotal").innerText= Bro_M + Sis_M;
   document.getElementById("TrsTotal").innerText= Bro_TrS + Sis_TrS;

   document.getElementById("AllTotal").innerText= Bro_M + Bro_TrS + Sis_M + Sis_TrS;


   //document.getElementById("container_Total").style.visibility='visible';
   //document.getElementById("container_Total").style.height='70%';

   //document.getElementById("container_Bro").style.visibility='hidden';
   //document.getElementById("container_Bro").style.height='0%';

   //document.getElementById("container_Sis").style.visibility='hidden';
   //document.getElementById("container_Sis").style.height='0%';

   //document.getElementById("container_Disp").style.visibility='hidden';
   //document.getElementById("container_Disp").style.height='0%';

   //document.getElementById("container_Reset_Button").style.visibility='hidden';
   //document.getElementById("container_Reset_Button").style.height='0%';

}  // End of function Init_Total_Mode()





function Reset_Mode(){

   document.getElementById("container_Reset_Button").style.visibility='visible';
   document.getElementById("container_Reset_Button").style.height='20%';

   document.getElementById("container_Total").style.visibility='visible';
   document.getElementById("container_Total").style.height='50%';


   document.getElementById("BroM").innerText= Bro_M;
   document.getElementById("BroTrs").innerText= Bro_TrS;

   document.getElementById("SisM").innerText= Sis_M;
   document.getElementById("SisTrs").innerText= Sis_TrS;

   document.getElementById("BroTotal").innerText= Bro_M + Bro_TrS;
   document.getElementById("SisTotal").innerText= Sis_M + Sis_TrS;

   document.getElementById("MemTotal").innerText= Bro_M + Sis_M;
   document.getElementById("TrsTotal").innerText= Bro_TrS + Sis_TrS;

   document.getElementById("AllTotal").innerText= Bro_M + Bro_TrS + Sis_M + Sis_TrS;


   //document.getElementById("container_Total").style.visibility='visible';
   //document.getElementById("container_Total").style.height='70%';

   document.getElementById("container_Bro").style.visibility='hidden';
   document.getElementById("container_Bro").style.height='0%';

   document.getElementById("container_Sis").style.visibility='hidden';
   document.getElementById("container_Sis").style.height='0%';

   document.getElementById("container_Disp").style.visibility='hidden';
   document.getElementById("container_Disp").style.height='0%';

}

function Reset_All(){

   Bro_M = 0;
   Sis_M = 0;
   Bro_TrS = 0;
   Sis_TrS = 0;

   // Start Writing to Local Storage

   localStorage.Bro_M = Bro_M;
   localStorage.Sis_M = Sis_M;
   localStorage.Bro_Trs = Bro_TrS;
   localStorage.Sis_Trs = Sis_TrS;

   // End of Writing to Local Storage

   document.getElementById("BroM").innerText= Bro_M;
   document.getElementById("BroTrs").innerText= Bro_TrS;

   document.getElementById("SisM").innerText= Sis_M;
   document.getElementById("SisTrs").innerText= Sis_TrS;

   document.getElementById("BroTotal").innerText= Bro_M + Bro_TrS;
   document.getElementById("SisTotal").innerText= Sis_M + Sis_TrS;

   document.getElementById("MemTotal").innerText= Bro_M + Sis_M;
   document.getElementById("TrsTotal").innerText= Bro_TrS + Sis_TrS;

   document.getElementById("AllTotal").innerText= Bro_M + Bro_TrS + Sis_M + Sis_TrS;


   // Add on 2020.10.07

   document.getElementById("Visitor_Brother_Member").value= Bro_M;  

   document.getElementById("Visitor_Sister_Member").value= Sis_M;

   document.getElementById("Visitor_Brother_Truth_Seeker").value= Bro_TrS;   

   document.getElementById("Visitor_Sister_Truth_Seeker").value= Sis_TrS;


   // ---

   Show_Total();

}



</script>




<div id="Bible_Container" style="height:560px;width:100%;">


<div id="header1" style="height:3%;">



</div>

<div id="container_Bro" style="height:0%;visibility:hidden">

<center>
<table>
<tr>


<td>
<input style="font-size:18pt;color:blue" type="button" class="button1" name="M222" id="Bro_Member2" value="Member" onclick="Input_BroMember_Mode();; return false;">
</td>

<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>

<td>
<input style="font-size:18pt;color:blue" type="button" name="M222" id="Bro_TruSeeker2" value="Truth Seeker" onclick="Input_BroTruSeeker_Mode();; return false;">
</td>

</tr>
</table>
</center>

</div>

<div id="container_Sis" style="height:0%;visibility:hidden">

<center>
<table>
<tr>


<td>
<input style="font-size:18pt;color:red" type="button" name="M222" id="Sis_Member2" value="Member" onclick="Input_SisMember_Mode();; return false;">
</td>

<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>

<td>
<input style="font-size:18pt;color:red" type="button" name="M222" id="Sis_TruSeeker" value="Truth Seeker" onclick="Input_SisTruSeeker_Mode();; return false;">
</td>

</tr>
</table>
</center>

</div>



<div id="container_Total" style="height:0%;visibility:hidden">

<center>
<table>
<table border=1 width=100% text=white>

<tr>
<td><p style="font-size:18pt;">&nbsp</p></td>

<td>
<p align=center style="font-size:18pt;">Member</p>
</td>

<td>
<p align=center style="font-size:18pt;">T.S.</p>
</td>

<td>
<p align=center style="font-size:18pt;">Total</p>
</td>
</tr>


<tr>
<td><p align=center style="font-size:18pt;">Brother</p></td>

<td>
<p align=center id="BroM" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="BroTrs" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="BroTotal" style="font-size:18pt;"></p>
</td>
</tr>


<tr>
<td><p align=center style="font-size:18pt;">Sister</p></td>

<td>
<p align=center id="SisM" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="SisTrs" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="SisTotal" style="font-size:18pt;"></p>
</td>
</tr>


<tr>
<td><p align=center style="font-size:18pt;">Total</p></td>

<td>
<p align=center id="MemTotal" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="TrsTotal" style="font-size:18pt;"></p>
</td>

<td>
<p align=center id="AllTotal" style="font-size:18pt;"></p>
</td>
</tr>


</table>
</center>


</div>



<div id="container_Reset_Button" style="height:0%;visibility:hidden">



<center>
<table>

<tr><td><p style="font-size:14pt;"></p></td></tr>


<td>
<input style="font-size:18pt;color:red" type="button" name="M222" id="Reset_Button" value="Press to Reset All" onclick="Reset_All();; return false;">
</td>

</table>
</center>



</div>



<div id="container_Disp" style="height:0%;visibility:hidden">

<center>
<table>

<tr><td><p style="font-size:4pt;"></p></td></tr>

<tr>
<td><p id="People_Number" style="font-size:16pt;"></p></td>
</tr>



</table>
</center>


<center>
<table>

<tr><td><p style="font-size:4pt;"></p></td></tr>

<tr>


<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="7" value="7" ontouchstart="keyFunction2(7);Seven_Pressed(); return false;">
</td> 
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="8" value="8" ontouchstart="keyFunction2(8);Eight_Pressed(); return false;">
</td>
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="9" value="9" ontouchstart="keyFunction2(9);Nine_Pressed(); return false;">
</td>


<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="Add" value="＋" onclick="keyFunction2('A');Add_Pressed(); return false;">
</td>

</tr>

<tr><td><p style="font-size:4pt;"></p></td></tr>

<tr>


<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="4" value="4" ontouchstart="keyFunction2(4);Four_Pressed(); return false;">
</td> 
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="5" value="5" ontouchstart="keyFunction2(5);Five_Pressed(); return false;">
</td>
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="6" value="6" ontouchstart="keyFunction2(6);Six_Pressed(); return false;">
</td>


<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="Sub" value="－" onclick="keyFunction2('S');Sub_Pressed(); return false;">
</td>

</tr>

<tr><td><p style="font-size:4pt;"></p></td></tr>

<tr>


<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="1" value="1" onclick="keyFunction2(1);One_Pressed(); return false;">
</td> 
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="2" value="2" ontouchstart="keyFunction2(2);Two_Pressed(); return false;">
</td>
<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="3" value="3" ontouchstart="keyFunction2(3);Three_Pressed(); return false;">
</td>


<td>&nbsp&nbsp</td>
<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="C" value=" C" ontouchstart="keyFunction2('C');C_Pressed(); return false;">
</td>

</tr>

<tr><td><p style="font-size:4pt;"></p></td></tr>

<tr>

<td>&nbsp&nbsp</td><td>&nbsp&nbsp</td>
<td colspan=4 style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="0" value="0" ontouchstart="keyFunction2(0);Zero_Pressed(); return false;">
</td> 



<td style="font-size:17pt">
<input style="font-size:17pt" type="button" name="M222" id="E" value=" E" onclick="keyFunction2('E');Show_Total_Mode();E_Pressed(); return false;">
</td>

</tr>

</table>
</center>

</div>





<div id="tool_area_7" style="height:0%;display:none"> 



   <div style="width: 500px" id="reader"></div>



                <center><b><p id="listElem3"></p></b></center>



</div>


<div id=menu style="display:block">

  <button id="Close_Service" style="font-size:22px" onclick="Hide_Search()">Hide</button>

  <input placeholder="First Name" style="font-size:22px" size="6" type="text" oninput="Search_Person_from_F_Name()" onblur="Menu_Opacity_04()" onfocus="Menu_Opacity_1();Search_fname2_clear()" id="Search_fname2" name="Search_fname2">

  <input placeholder="Last Name" style="font-size:22px" size="6" type="text" oninput="Roll_Call_Search_V4()" onblur="Menu_Opacity_04()" onfocus="Menu_Opacity_1();Search_lname7_clear()" id="Search_lname7" name="Search_lname7">

  <button id="Close_Service" style="font-size:22px" onclick="Close_Service_Record();Menu_Opacity_04()">Transparent</button>

</div>


<div id="roll_marking" style="height:105%;display:block"> 


  <center><button style="font-size:20px" onclick="Roll_Call_V2('R')">Full List</button>


<div class="dropdown">
  <button onclick="Open_dropdown_menu()" style="font-size:20px" class="dropbtn">Filter</button>
  <div id="dropdown-content" class="dropdown-content">
    <a style="text-align:left;" href="javascript:Roll_Call_Kindy();Close_dropdown_menu();">Kindy 幼稚班</a>
    <a style="text-align:left;" href="javascript:Roll_Call_LPC();Close_dropdown_menu();">LPC 幼年班</a>
    <a style="text-align:left;" href="javascript:Roll_Call_UPC();Close_dropdown_menu();">UPC 少年班</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C1();Close_dropdown_menu();">Cooking Group 1 - Steven 劉邦光組</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C2();Close_dropdown_menu();">Cooking Group 2 - Henry 郭淼義組</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C3();Close_dropdown_menu();">Cooking Group 3 - Joanne 柯愛真組</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C4();Close_dropdown_menu();">Cooking Group 4 - Su-Foh 蔡仕和組</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C5();Close_dropdown_menu();">Cooking Group 5 - Daniel 柯宇恆組</a>
    <a style="text-align:left;" href="javascript:Roll_Call_C6();Close_dropdown_menu();">Cooking Group 6 - Elizabeth 陳月桂組</a>
    <a style="text-align:left;" href="javascript:Search_Truth_Seeker();Close_dropdown_menu();">Truth Seeker 慕道者</a>
    <a style="text-align:left;" href="javascript:Go_To_TJCBNE_Attendance_Sheet_V2();Close_dropdown_menu();">Truth Seeker - Name Not in App</a>
    <a style="text-align:left;" href="javascript:Roll_Call_GC();Close_dropdown_menu();">Gold Coast 黃金海岸區</a>
    <a style="color:white;background-color: #4CAF50;text-align:left;" href="javascript:Close_dropdown_menu();">Close Filter</a>
  </div>
</div>


  <button style="font-size:20px" onclick="Go_To_Roll_Marking()">Search</button>

  <a style="font-size:26px" href="javascript:Open_Service_Record();">Service Record</a> <br>

    Device_Name
    <input type="text" placeholder="Scott_iPad_Air3, Scott_NB" id="device_name_2" name="device_name_2">

  <a style="font-size:26px" href="javascript:Upload_Attendance();">Upload Attendance</a> ex:Scott_iPad_Air3, Scott_NB <br>

    Device_Name
    <input type="text" id="device_name" name="device_name">
    Service_Name
    <input type="text" id="service_name" name="service_name">  

  <a style="font-size:26px" href="javascript:Download_Attendance();">Download Attendance</a>

  <p id="Download_Attendance_Mesg4"> </p> 

  </center>

  <iframe src="http://192.168.1.18:8080" id="iframe" style="display:block;height:100px;width:1000px"></iframe>


<div class="box">  
    <p id="Chinese_Surname"> </p>
</div>


<div id="tool_area_6" style="height:0%;display:none"> 

  <table style="font-size:22px">

  <tr>
  <td>  &nbsp;&nbsp;  </td>
  </tr>


  <tr>
  <td>

<button style="font-size:24px" onclick="Imp_to_Comparing_Db_1()">Imp Comparing Db 1</button>

<INPUT style="font-size:20px" TYPE=TEXT NAME="Imp_to_Comparing_Db_1" SIZE="12" id="Imp_to_Comparing_Db_1">

  <label style="font-size:20px" for="Mesg4"> Message </label>
  <input style="font-size:16px" size="40" type="text" id="Mesg4_Imp_to_Comparing_Db_1" name="Mesg4_Imp_to_Comparing_Db_1" >

<button onclick="Clear_Imp_to_Comparing_Db_1()">Clear</button>

  </td>
  </tr>


  <tr>
  <td>

<button style="font-size:24px" onclick="Imp_to_Comparing_Db_2()">Imp Comparing Db 2</button>

<INPUT style="font-size:20px" TYPE=TEXT NAME="Imp_to_Comparing_Db_2" SIZE="12" id="Imp_to_Comparing_Db_2">

  <label style="font-size:20px" for="Mesg4"> Message </label>
  <input style="font-size:16px" size="40" type="text" id="Mesg4_Imp_to_Comparing_Db_2" name="Mesg4_Imp_to_Comparing_Db_2" >

<button onclick="Clear_Imp_to_Comparing_Db_2()">Clear</button>

  </td>
  </tr>


  <tr>
  <td>
  <button style="font-size:26px" onclick="Comparing_Db_1_and_Db_2()">Compare</button>
  <label style="font-size:20px" for="Mesg4"> DateStr : 20201003M </label>
  <INPUT style="font-size:20px" TYPE=TEXT NAME="Comparing_Db_1_and_Db_2_DateStr" SIZE="12" id="Comparing_Db_1_and_Db_2_DateStr">
  </td>
  </tr>


  <tr>
  <td>
  <button style="font-size:16pt" onclick="Exp_and_Email_Attendance()">Send Attendance = </button> 
  <INPUT TYPE=TEXT style="font-size:16pt" NAME="Exp_n_Email_start_date" SIZE="12" id="Exp_n_Email_start_date"> (Ex:20200912M, M/A/E)
  </td>

  <td>
  <p id="Send_Attendance2"> </p>  
  <p id="Send_Attendance_Message"> </p> 
  </td>
  </tr>

  <tr>
  <td>
  <button style="font-size:16pt" onclick="Search_Service_Record();">Search Service Record=</button> 
  <INPUT TYPE=TEXT style="font-size:16pt" NAME="Search_Rervice_Record_date" SIZE="12" id="Search_Rervice_Record_date"> (Ex:20200912M, M/A/E)
  </td>
  </tr>

  <tr>
  <td>  &nbsp;&nbsp;  </td>
  </tr>

  <tr>
  <td>
  <button style="font-size:20px" onclick="Open_QR_Code_Scan_Area()">Open QR Code Scan Area</button>
  <button style="font-size:20px" onclick="Close_QR_Code_Scan_Area()">Close QR Code Scan Area</button>
  </td>
  </tr>

  <tr>
  <td>  &nbsp;&nbsp;  </td>
  </tr>

  <tr>
  <td>
  Password: <input type="password" style="font-size:16pt" id="pwd" name="pwd" onfocus="Mousetrap.pause()" onBlur="Mousetrap.unpause()">  

  <input type="button" name="B121" style="font-size:16pt;color:black" value="Submit" onclick="passWord_1(); return false;">

  <button style="font-size:20px" onclick="Close_Admin_Tools_Area()">Close Admin Tools</button
  </td>
  </tr>

  </table>

</div>



       
<br>     






<div id="content2" style="height:95%;overflow:auto;" class="center">

  <p id="Roll_Call_Content"> </p>


</div>

<div id="content2_C" style="height:0%;overflow:auto;" class="center">

  <p id="Roll_Call_Content_C"> </p>

</div>


</div>


<div id="Admin_Tools_Area" style="width:100%;height:0%;overflow:auto;" class="center">

  <button style="font-size:20px" onclick="Show_Headcount_2()">Show Headcount = </button>
  <input style="font-size:22px" size="10" type="text" id="Show_Headcount_2" name="Show_Headcount_2">
  <label style="font-size:24px" for="fname2">Ex: 20200905M, 20200905A - Morning/Afternoon/Evening</label>
  <br>



  <label id="Phone_Dir_Content"> </label> <br>

  <button style="font-size:20px" onclick="Search_Phone_from_F_Name()">Search Phone from </button>
  <label style="font-size:28px" for="fname2">First Name: </label>
  <input style="font-size:22px" size="10" type="text" id="Search_fname1" name="Search_fname1"> <br>

  <button style="font-size:20px" onclick="Search_Person_from_Tel()">Search Person from </button>
  <label style="font-size:28px" for="fname2">Tel: </label>
  <input style="font-size:22px" size="10" type="text" id="Search_Tel" name="Search_Tel">

  <button style="font-size:20px" onclick="Search_Person_from_Mob()">Search Person from </button>
  <label style="font-size:28px" for="fname2">Mob: </label>
  <input style="font-size:22px" size="10" type="text" id="Search_Mob" name="Search_Mob"> <br>


  <button style="font-size:20px" onclick="Roll_Call_V1('P')">Phone Dir. V1</button>
  <a href="javascript:Roll_Call_Search_V1('B','P')"> B </a>
  <a href="javascript:Roll_Call_Search_V1('C','P')"> C </a>
  <a href="javascript:Roll_Call_Search_V1('H','P')"> H </a>
  <a href="javascript:Roll_Call_Search_V1('J','P')"> J </a>
  <a href="javascript:Roll_Call_Search_V1('K','P')"> K </a>
  <a href="javascript:Roll_Call_Search_V1('L','P')"> L </a>
  <a href="javascript:Roll_Call_Search_V1('M','P')"> M </a>
  <a href="javascript:Roll_Call_Search_V1('N','P')"> N </a>
  <a href="javascript:Roll_Call_Search_V1('O','P')"> O </a>
  <a href="javascript:Roll_Call_Search_V1('S','P')"> S </a>
  <a href="javascript:Roll_Call_Search_V1('T','P')"> T </a>
  <a href="javascript:Roll_Call_Search_V1('W','P')"> W </a>
  <a href="javascript:Roll_Call_Search_V1('Y','P')"> Y </a>

  <a href="javascript:Roll_Call_Search_V3('邵','P')"> 邵 </a>
  <a href="javascript:Roll_Call_Search_V3('盛','P')"> 盛 </a>
  <a href="javascript:Roll_Call_Search_V3('施','P')"> 施 </a>
  <a href="javascript:Roll_Call_Search_V3('薛','P')"> 薛 </a>
  <a href="javascript:Roll_Call_Search_V3('孫','P')"> 孫 </a>
  <a href="javascript:Roll_Call_Search_V3('譚','P')"> 譚 </a>
  <a href="javascript:Roll_Call_Search_V3('王','P')"> 王 </a>
  <a href="javascript:Roll_Call_Search_V3('楊','P')"> 楊 </a>
  <a href="javascript:Roll_Call_Search_V3('余','P')"> 余 </a>

  <br>
                 
  <button style="font-size:20px" onclick="Roll_Call_V2('P')">Phone Dir. V2</button>
  <a href="javascript:Roll_Call_Search_V3('陳','P')"> 陳 </a>
  <a href="javascript:Roll_Call_Search_V3('張','P')"> 張 </a>
  <a href="javascript:Roll_Call_Search_V3('鄭','P')"> 鄭 </a>
  <a href="javascript:Roll_Call_Search_V3('黃','P')"> 黃 </a>
  <a href="javascript:Roll_Call_Search_V3('嵇','P')"> 嵇 </a>
  <a href="javascript:Roll_Call_Search_V3('柯','P')"> 柯 </a>
  <a href="javascript:Roll_Call_Search_V3('郭','P')"> 郭 </a>
  <a href="javascript:Roll_Call_Search_V3('李','P')"> 李 </a>
  <a href="javascript:Roll_Call_Search_V3('蔡','P')"> 蔡 </a>
  <a href="javascript:Roll_Call_Search_V3('許','P')"> 許 </a>
  <a href="javascript:Roll_Call_Search_V3('徐','P')"> 徐 </a>
  <a href="javascript:Roll_Call_Search_V3('胡','P')"> 胡 </a>
  <a href="javascript:Roll_Call_Search_V3('梁','P')"> 梁 </a>
  <a href="javascript:Roll_Call_Search_V3('劉','P')"> 劉 </a>
  <a href="javascript:Roll_Call_Search_V3('林','P')"> 林 </a>
  <a href="javascript:Roll_Call_Search_V3('毛','P')"> 毛 </a>
  <a href="javascript:Roll_Call_Search_V3('翁','P')"> 翁 </a>
  <a href="javascript:Roll_Call_Search_V3('葉','P')"> 葉 </a>

<br><br>

  <button style="font-size:20px" onclick="generate_CNo_for_New_Householder()">Add Householder</button>

  <button style="font-size:20px" onclick="add_people_to_Congregation4()">Add </button>
  <button style="font-size:20px" onclick="read_from_Congregation4()">Read</button>
  <button style="font-size:20px" onclick="update_to_Congregation4()">Update</button>

  <button style="font-size:20px" onclick="Delete_Congregation4_Cno()">Delete</button>

  <label style="font-size:28px" for="Mesg2"> Message </label>
  <input style="font-size:22px" size="40" type="text" id="Mesg2" name="Mesg2" class="messageBox">

  <br>
  <label style="font-size:28px" for="cNo2"> CNo: </label>
  <input style="font-size:22px" size="1" type="text" id="cNo2" name="cNo2">

  <label style="font-size:28px" for="fname2">First name: </label>
  <input style="font-size:22px" size="10" type="text" id="fname2" name="fname2">
  <label style="font-size:28px" for="lname2">Last name: </label>
  <input style="font-size:22px" size="10" type="text" id="lname2" name="lname2">

  <label style="font-size:28px" for="Member2">Member: </label>
  <input style="font-size:22px" size="1" type="text" id="Member2" name="Member2">

  <label style="font-size:28px" for="Member2">Tel: </label>
  <input style="font-size:22px" size="8" type="text" id="Tel2" name="Tel2">

  <br>
  <label style="font-size:28px" for="h_No2">HNo: </label>
  <input style="font-size:22px" size="2" type="text" id="h_No2" name="h_No2">

  <label style="font-size:30px" for="Cfname2"> 姓: </label>
  <input style="font-size:24px" size="1" type="text" id="Cfname2" name="Cfname2">
  <label style="font-size:30px" for="Clname2">名: </label>
  <input style="font-size:24px" size="2" type="text" id="Clname2" name="Clname2">
  <label style="font-size:28px" for="fOrder2">Family Order: </label>
  <input style="font-size:22px" size="1" type="text" id="fOrder2" name="fOrder2">

  <label style="font-size:28px" for="Gender2">Gender: </label>
  <input style="font-size:22px" size="1" type="text" id="Gender2" name="Gender2">

  <label style="font-size:28px" for="Member2">Mobile: </label>
  <input style="font-size:22px" size="8" type="text" id="Mob2" name="Mob2">


<br><br>


  <button style="font-size:20px" onclick="generate_CNo_for_New_Family_Member()">Add Family Member</button>

  <button style="font-size:20px" onclick="add_people_to_Congregation4_F()">Add </button>
  <button style="font-size:20px" onclick="read_from_Congregation4_F()">Read</button>
  <button style="font-size:20px" onclick="update_to_Congregation4_F()">Update</button>

  <button style="font-size:20px" onclick="Delete_Congregation4_F_Cno()">Delete</button>

  <label style="font-size:28px" for="Mesg3"> Message </label>
  <input style="font-size:22px" size="40" type="text" id="Mesg3" name="Mesg3" class="messageBox">

  <br>
  <label style="font-size:28px" for="cNo3"> CNo: </label>
  <input style="font-size:22px" size="1" type="text" id="cNo3" name="cNo3">

  <label style="font-size:28px" for="fname3">First name: </label>
  <input style="font-size:22px" size="10" type="text" id="fname3" name="fname3">
  <label style="font-size:28px" for="lname3">Last name: </label>
  <input style="font-size:22px" size="10" type="text" id="lname3" name="lname3">

  <label style="font-size:28px" for="Member3">Member: </label>
  <input style="font-size:22px" size="1" type="text" id="Member3" name="Member3">

  <label style="font-size:28px" for="Member3">Tel: </label>
  <input style="font-size:22px" size="8" type="text" id="Tel3" name="Tel3">

  <br>
  <label style="font-size:28px" for="h_No3">HNo: </label>
  <input style="font-size:22px" size="2" type="text" id="h_No3" name="h_No3">

  <label style="font-size:30px" for="Cfname3"> 姓: </label>
  <input style="font-size:24px" size="1" type="text" id="Cfname3" name="Cfname3">
  <label style="font-size:30px" for="Clname3">名: </label>
  <input style="font-size:24px" size="2" type="text" id="Clname3" name="Clname3">
  <label style="font-size:28px" for="fOrder3">Family Order: </label>
  <input style="font-size:22px" size="1" type="text" id="fOrder3" name="fOrder3">

  <label style="font-size:28px" for="Gender3">Gender: </label>
  <input style="font-size:22px" size="1" type="text" id="Gender3" name="Gender3">

  <label style="font-size:28px" for="Member2">Mobile: </label>
  <input style="font-size:22px" size="8" type="text" id="Mob3" name="Mob3">


<br><br>



<button onclick="Congregation4_to_Householder()">Congregation4 -> Householder</button>

<button onclick="list_all_Congregation3()">List All Congregation3</button>

<button onclick="list_all_Householder()">List All Householder</button>

<button onclick="Householder_to_Roll()">Householder -> Roll</button>

<button onclick="list_all_Roll()">List All Roll</button>

<button onclick="list_all_Attendance()">List All Attendance</button>



<br>

<button onclick="list_all_Congregation2()">List All Congregation2</button>

<button onclick="Delete_All_Congregation2()">Delete All Congregation2</button>


<button onclick="Delete_Congregation2_Cno()">Delete Congregation2 CNo = </button>
<input size="2" type="text" id="Delete_Congregation2_Cno" name="Delete_Congregation2_Cno">




<br>


<button onclick="list_all_Congregation4()">List All Congregation4</button>

<button onclick="Delete_All_Congregation4()">Delete All Congregation4</button>


<button onclick="Delete_Congregation4_Cno()">Delete Congregation4 CNo = </button>
<input size="2" type="text" id="Delete_Congregation4_Cno" name="Delete_Congregation4_Cno">


<button onclick="list_Distinct_Test_Congregation4()">Distinct Test</button>

<button onclick="list_all_Congregation4_V2()">List All Congregation4 V2</button>

<br>

<button onclick="Delete_Service_Record_ID_2()">Delete Service Record ID_2 = </button>
<input size="12" type="text" id="Delete_Service_Record_ID_2" name="Delete_Service_Record_ID_2"> Ex: 20200905M, 20200905A

<br>

<button onclick="Delete_Attendance()">Delete Attendance = </button>
<input size="12" type="text" id="Delete_Attendance_Record" name="Delete_Attendance_Record"> Ex: 20200905M

<br>

<button onclick="Delete_Attendance_V2()">Delete Attendance = </button>
<input size="12" type="text" id="Delete_Attendance_Record_V2" name="Delete_Attendance_Record_V2"> Ex: 20201031A_M_S_44

<br>

<button onclick="Add_Attendance()">Add Attendance = </button>
<input size="12" type="text" id="Add_Attendance_Record" name="Add_Attendance_Record"> Ex: 20201031A_M_S_44

<br>



<button onclick="Imp_to_Congregation4()">Imp Db</button>

<INPUT TYPE=TEXT NAME="Imp_to_Congregation4" SIZE="12" id="Imp_to_Congregation4">

  <label style="font-size:20px" for="Mesg4"> Message </label>
  <input style="font-size:16px" size="40" type="text" id="Mesg4" name="Mesg4" >

<button onclick="Clear_Imp_to_Congregation4()">Clear</button>

<br>

<label style="font-size:20px" for="Member2">Congregation4 </label>
<button onclick="Exp_from_Congregation4()">Exp All</button> 
<button onclick="Exp2_from_Congregation4()">Exp All without Tel & Mob</button> 


<br>

<label style="font-size:20px" for="Member2">Congregation4 </label>
<button onclick="Exp_CNo_Between_by_email_from_Congregation4()">Exp CNo Between by email</button> 
<INPUT TYPE=TEXT size="4" id="Exp_CNo_start">-<INPUT TYPE=TEXT size="4" id="Exp_CNo_end">
<button onclick="Exp_CNo_Between_by_email_without_Tel_and_Mob_from_Congregation4()">Exp CNo Between by email without Tel & Mob</button> 
<p id="Send_Congregation4_Exp"> </p>


<br>

<label style="font-size:20px" for="Member2">Attendance </label>
<button onclick="Exp_All_from_Attendance()">Exp All </button> 
<button onclick="Exp_from_Attendance()">Exp = </button> 
<INPUT TYPE=TEXT NAME="Exp_start_date" SIZE="12" id="Exp_start_date">

<button onclick="Exp_and_Email_Attendance()">Send Attendance Record</button> 
<p id="Send_Attendance"> </p>

<br>

<button style="font-size:20px" onclick="add_Service_Record_V2()">Add Service Record V2</button> 
<label style="font-size:20px" for="Member2">ID 1</label>
<INPUT style="font-size:22px" TYPE=TEXT NAME="Add_Service_Record_ID_1" SIZE="12" id="Add_Service_Record_ID_1">
<label style="font-size:20px" for="Member2">ID 2</label>
<INPUT style="font-size:22px" TYPE=TEXT NAME="Add_Service_Record_ID_2" SIZE="12" id="Add_Service_Record_ID_2">
<label style="font-size:20px" for="Member2">Service Date</label>
<INPUT style="font-size:22px" TYPE=TEXT NAME="Add_Service_Record_Service_Date" SIZE="22" id="Add_Service_Record_Service_Date">


<br>

  <button style="font-size:20px" onclick="Download_Attendance_StartWith()">Download(.csv) Attendance = </button>
  <input style="font-size:22px" size="10" type="text" id="Download_Attendance_StartWith" name="Download_Attendance_StartWith">
  <label style="font-size:24px" for="fname2">Ex: 202009, 202010</label>
  <button style="font-size:20px" onclick="Download_Attendance_StartWith_V2()"> = Download(.csv) Attendance V2</button>
  <br>

  <button style="font-size:20px" onclick="Download_from_Attendance_Test2Db_Time_Between()">Download(.txt) Attendance Time Between </button>
  <INPUT TYPE=TEXT style="font-size:22px" size="10" id="Download_Time_start">-<INPUT TYPE=TEXT style="font-size:22px" size="10" id="Download_Time_end">
  <br>



<p>Congregation list:</p>

<ul id="listElem"></ul>

<p>Attendance list:</p>

<ul id="listElem2"></ul>

</div>


<script>






document.getElementById("Mesg2").readOnly = true;

document.getElementById("Mesg3").readOnly = true;


async function list_all_Congregation() {


  let Verse = await dbT2.Congregation.reverse().toArray();

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     if (Verse.length) {
       listElem.innerHTML = Verse.map(book => `<li>

           CNo:${book.CNo}  Name:${book.F_Name} ${book.L_Name}  Member:${book.Member} Gender:${book.Gender}  HNo:${book.H_No} 姓名:${book.C_F_Name} ${book.C_L_Name} F_Order:${book.F_Order}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Congregation()



async function Congregation4_to_Householder() {


  let Verse = await dbT2.Congregation4.where("F_Order").equals('1').toArray();  // where("CNo").equals(delete_CNo)

  //let Verse = await dbT2.Congregation2.orderBy('[L_Name+F_Name]').toArray();  // where("CNo").equals(delete_CNo)


  if (Verse) {

     dbT2.Congregation3.clear();  // delete all in Congregation3

     // Add "F_Order" = 1 into Congregation3 from Congregation2

     for (i = 0; i < Verse.length; i++) {

        var CNo = Verse[i].CNo;
        var F_Name = Verse[i].F_Name;
        var L_Name = Verse[i].L_Name;
        var H_No = Verse[i].H_No;   

        try { 

           dbT2.Congregation3.add({ CNo, F_Name, L_Name, H_No });   

        } catch(err) {   

           if (err.name == 'ConstraintError') {
             alert("Such book exists already");
             //await addBook();
           } else {
             throw err;
           }

        }


     } // End of for (i = 0; i < Verse.length; i++)

     // End of Add "F_Order" = 1 into Congregation3 from Congregation2

     dbT2.Householder.clear();  // delete all in Householder

     // Add into Householder from Congregation3 orderby [L_Name+F_Name]

     let Verse_3 = await dbT2.Congregation3.orderBy('[L_Name+F_Name]').toArray();

     for (i = 0; i < Verse_3.length; i++) {

        var H_No = Verse_3[i].H_No;   

        try { 

           dbT2.Householder.add({ H_No }); 

        } catch(err) {
          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
            //await addBook();
          } else {
            throw err;
          }
        }

     } // end of for (i = 0; i < Verse_3.length; i++)


  }
  else {

     listElem.innerHTML = 'Congregation4 No Data';

  }


}  // End of function Congregation4_to_Householder()


async function Congregation2_to_Householder() {


  let Verse = await dbT2.Congregation2.where("F_Order").equals('1').toArray();  // where("CNo").equals(delete_CNo)

  //let Verse = await dbT2.Congregation2.orderBy('[L_Name+F_Name]').toArray();  // where("CNo").equals(delete_CNo)


  if (Verse) {

     dbT2.Congregation3.clear();  // delete all in Congregation3

     // Add "F_Order" = 1 into Congregation3 from Congregation2

     for (i = 0; i < Verse.length; i++) {

        var CNo = Verse[i].CNo;
        var F_Name = Verse[i].F_Name;
        var L_Name = Verse[i].L_Name;
        var H_No = Verse[i].H_No;   

        try { 

           dbT2.Congregation3.add({ CNo, F_Name, L_Name, H_No });   

        } catch(err) {   

           if (err.name == 'ConstraintError') {
             alert("Such book exists already");
             //await addBook();
           } else {
             throw err;
           }

        }


     } // End of for (i = 0; i < Verse.length; i++)

     // End of Add "F_Order" = 1 into Congregation3 from Congregation2

     dbT2.Householder.clear();  // delete all in Householder

     // Add into Householder from Congregation3 orderby [L_Name+F_Name]

     let Verse_3 = await dbT2.Congregation3.orderBy('[L_Name+F_Name]').toArray();

     for (i = 0; i < Verse_3.length; i++) {

        var H_No = Verse_3[i].H_No;   

        try { 

           dbT2.Householder.add({ H_No }); 

        } catch(err) {
          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
            //await addBook();
          } else {
            throw err;
          }
        }

     } // end of for (i = 0; i < Verse_3.length; i++)


  }
  else {

     listElem.innerHTML = 'Congregation2 No Data';

  }


}  // End of function Congregation2_to_Householder()




async function update_to_Congregation4_F() {

  var CNo_tmp = document.getElementById("cNo3").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation4.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {  // Exist so update

     //var content_tmp = document.getElementById("Chap_Note_Textarea").value;

     var F_Name_tmp = document.getElementById("fname3").value;
     var L_Name_tmp = document.getElementById("lname3").value;
     var Member_tmp = document.getElementById("Member3").value;
     var Gender_tmp = document.getElementById("Gender3").value;

     var H_No_tmp = document.getElementById("h_No3").value;
     var C_F_Name_tmp = document.getElementById("Cfname3").value;
     var C_L_Name_tmp = document.getElementById("Clname3").value;
     var F_Order_tmp = document.getElementById("fOrder3").value;

     var Tel_tmp = document.getElementById("Tel3").value;
     var Mob_tmp = document.getElementById("Mob3").value;

     //dbT2.ChapNote.update(Book_tmp, {content: content_tmp  });

     dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

     document.getElementById("Mesg3").value = 'Updated.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "blue";

  }
  else {   // Not Exist so do nothing

     document.getElementById("Mesg3").value = 'Failed. CNo:' + CNo + ' does not exist.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "red";
  }


}  // End of function update_to_Congregation4_F()



async function update_to_Congregation4() {

  var CNo_tmp = document.getElementById("cNo2").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation4.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {  // Exist so update

     //var content_tmp = document.getElementById("Chap_Note_Textarea").value;

     var F_Name_tmp = document.getElementById("fname2").value;
     var L_Name_tmp = document.getElementById("lname2").value;
     var Member_tmp = document.getElementById("Member2").value;
     var Gender_tmp = document.getElementById("Gender2").value;

     var H_No_tmp = document.getElementById("h_No2").value;
     var C_F_Name_tmp = document.getElementById("Cfname2").value;
     var C_L_Name_tmp = document.getElementById("Clname2").value;
     var F_Order_tmp = document.getElementById("fOrder2").value;

     var Tel_tmp = document.getElementById("Tel2").value;
     var Mob_tmp = document.getElementById("Mob2").value;

     //dbT2.ChapNote.update(Book_tmp, {content: content_tmp  });

     dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

     document.getElementById("Mesg2").value = 'Updated.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "blue";

  }
  else {   // Not Exist so do nothing

     document.getElementById("Mesg2").value = 'Failed. CNo:' + CNo + ' does not exist.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "red";
  }


}  // End of function update_to_Congregation4()


async function update_to_Congregation2() {

  var CNo_tmp = document.getElementById("cNo2").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation2.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {  // Exist so update

     //var content_tmp = document.getElementById("Chap_Note_Textarea").value;

     var F_Name_tmp = document.getElementById("fname2").value;
     var L_Name_tmp = document.getElementById("lname2").value;
     var Member_tmp = document.getElementById("Member2").value;
     var Gender_tmp = document.getElementById("Gender2").value;

     var H_No_tmp = document.getElementById("h_No2").value;
     var C_F_Name_tmp = document.getElementById("Cfname2").value;
     var C_L_Name_tmp = document.getElementById("Clname2").value;
     var F_Order_tmp = document.getElementById("fOrder2").value;

     //dbT2.ChapNote.update(Book_tmp, {content: content_tmp  });

     dbT2.Congregation2.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp });

  }
  else {   // Not Exist so do nothing

     listElem.innerHTML = 'No Data';

  }


}  // End of function update_to_Congregation2()



async function read_from_Congregation4_F() {

  var CNo_tmp = document.getElementById("cNo3").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation4.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     document.getElementById("fname3").value = Verse.F_Name;
     document.getElementById("lname3").value = Verse.L_Name;
     document.getElementById("Member3").value = Verse.Member;
     document.getElementById("Gender3").value = Verse.Gender;

     document.getElementById("h_No3").value = Verse.H_No; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname3").value = Verse.C_F_Name; // 姓
     document.getElementById("Clname3").value = Verse.C_L_Name; // 名字
     document.getElementById("fOrder3").value = Verse.F_Order; // 1 for Householder

     if (!Verse.Tel) 
        document.getElementById("Tel3").value = '';
     else
        document.getElementById("Tel3").value = Verse.Tel;

     if (!Verse.Mob)
        document.getElementById("Mob3").value = '';
     else
        document.getElementById("Mob3").value = Verse.Mob;

     document.getElementById("Mesg3").value = 'Succeeded.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "blue";

  }
  else {

     //listElem.innerHTML = 'No Data';

     document.getElementById("fname3").value = '';
     document.getElementById("lname3").value = '';
     document.getElementById("Member3").value = '';
     document.getElementById("Gender3").value = '';

     document.getElementById("h_No3").value = ''; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname3").value = ''; // 姓
     document.getElementById("Clname3").value = ''; // 名字
     document.getElementById("fOrder3").value = ''; // 1 for Householder

     document.getElementById("Tel3").value = '';
     document.getElementById("Mob3").value = '';

     document.getElementById("Mesg3").value = 'No Data.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "red";

  }


}  // End of function read_from_Congregation4_F()


async function read_from_Congregation4() {

  var CNo_tmp = document.getElementById("cNo2").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation4.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     document.getElementById("fname2").value = Verse.F_Name;
     document.getElementById("lname2").value = Verse.L_Name;
     document.getElementById("Member2").value = Verse.Member;
     document.getElementById("Gender2").value = Verse.Gender;

     document.getElementById("h_No2").value = Verse.H_No; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname2").value = Verse.C_F_Name; // 姓
     document.getElementById("Clname2").value = Verse.C_L_Name; // 名字
     document.getElementById("fOrder2").value = Verse.F_Order; // 1 for Householder

     if (!Verse.Tel) 
        document.getElementById("Tel2").value = '';
     else
        document.getElementById("Tel2").value = Verse.Tel;

     if (!Verse.Mob)
        document.getElementById("Mob2").value = '';
     else
        document.getElementById("Mob2").value = Verse.Mob;

     document.getElementById("Mesg2").value = 'Succeeded.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "blue";

  }
  else {

     //listElem.innerHTML = 'No Data';

     document.getElementById("fname2").value = '';
     document.getElementById("lname2").value = '';
     document.getElementById("Member2").value = '';
     document.getElementById("Gender2").value = '';

     document.getElementById("h_No2").value = ''; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname2").value = ''; // 姓
     document.getElementById("Clname2").value = ''; // 名字
     document.getElementById("fOrder2").value = ''; // 1 for Householder

     document.getElementById("Tel2").value = '';
     document.getElementById("Mob2").value = '';

     document.getElementById("Mesg2").value = 'No Data.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "red";

  }


}  // End of function read_from_Congregation4()


async function read_from_Congregation2() {

  var CNo_tmp = document.getElementById("cNo2").value;

  var CNo = Number(CNo_tmp);

  let Verse = await dbT2.Congregation2.get(CNo);

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     document.getElementById("fname2").value = Verse.F_Name;
     document.getElementById("lname2").value = Verse.L_Name;
     document.getElementById("Member2").value = Verse.Member;
     document.getElementById("Gender2").value = Verse.Gender;

     document.getElementById("h_No2").value = Verse.H_No; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname2").value = Verse.C_F_Name; // 姓
     document.getElementById("Clname2").value = Verse.C_L_Name; // 名字
     document.getElementById("fOrder2").value = Verse.F_Order; // 1 for Householder

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function read_from_Congregation2()



async function list_Distinct_Test_Congregation4() {  // Can't use .distinct(), try to find other way


  //let Verse = await dbT2.Congregation4..toArray();

  //let Verse = await dbT2.Congregation4.reverse().toArray();


  if (Verse) {

     if (Verse.length) {
       listElem.innerHTML = Verse.map(book => `<li>

           CNo:${book.CNo}  Name:${book.F_Name} ${book.L_Name}  Member:${book.Member} Gender:${book.Gender}  HNo:${book.H_No} 姓名:${book.C_F_Name} ${book.C_L_Name} F_Order:${book.F_Order}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_Distinct_Test_Congregation4()


async function list_all_Congregation4_V2() {


  let Verse = await dbT2.Congregation4.reverse().toArray();

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     if (Verse.length) {
       listElem.innerHTML = Verse.map(book => `<li>

           CNo:${book.CNo}  Name:${book.F_Name} ${book.L_Name}  M:${book.Member} G:${book.Gender}  ${book.C_F_Name} ${book.C_L_Name} Tel:${book.Tel} Mob:${book.Mob}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Congregation4_V2()


async function list_all_Congregation4() {


  let Verse = await dbT2.Congregation4.reverse().toArray();

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     if (Verse.length) {
       listElem.innerHTML = Verse.map(book => `<li>

           CNo:${book.CNo}  Name:${book.F_Name} ${book.L_Name}  Member:${book.Member} Gender:${book.Gender}  HNo:${book.H_No} 姓名:${book.C_F_Name} ${book.C_L_Name} F_Order:${book.F_Order}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Congregation4()


async function list_all_Congregation2() {


  let Verse = await dbT2.Congregation2.reverse().toArray();

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     if (Verse.length) {
       listElem.innerHTML = Verse.map(book => `<li>

           CNo:${book.CNo}  Name:${book.F_Name} ${book.L_Name}  Member:${book.Member} Gender:${book.Gender}  HNo:${book.H_No} 姓名:${book.C_F_Name} ${book.C_L_Name} F_Order:${book.F_Order}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Congregation2()



async function list_all_Congregation3() {

  //let Verse_3 = await dbT2.Congregation3.toArray();

  let Verse_3 = await dbT2.Congregation3.orderBy('[L_Name+F_Name]').toArray();

  //let Verse = await dbT2.Congregation2.reverse().toArray();


  if (Verse_3) {

     if (Verse_3.length) {
       listElem.innerHTML = Verse_3.map(book => `<li>

           CNo:${book.CNo}  Name: ${book.L_Name}, ${book.F_Name}  HNo:${book.H_No} 

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>Congregation3 No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Congregation3()


async function list_all_Householder() {

  //let Verse_3 = await dbT2.Congregation3.toArray();

  let Verse_3 = await dbT2.Householder.toArray();

  //let Verse = await dbT2.Congregation2.reverse().toArray();


  if (Verse_3) {

     if (Verse_3.length) {
       listElem.innerHTML = Verse_3.map(book => `<li>

           H_Seq:${book.H_Seq} ,  H_No:${book.H_No}

         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>Householder No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Householder()


async function Add_or_Remove_Attendance(arg1,arg2,arg3,arg44) { // arg1: CNo, arg2: Member, arg3:Gender, arg4: position

   document.getElementById("Send email").innerHTML = 'Send email';

   var CNo = String(arg1);

   var DateStr = ML_Date_V2();

   var Member_Str = String(arg2);
   var Gender_Str = String(arg3);

   var arg4 = String(arg44);

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {  // mean has Data then Remove Attendance

      remove_record_from_Attendance_V2(Record);

      document.getElementById(arg4).style.color = "black";


      //Show_Headcount();

   }
   else {   // mean No Data then Add Attendance         

      add_record_to_Attendance_V3(arg1);

      document.getElementById(arg4).style.color = "blue";

      //Show_Headcount();

   }

   //Show_Headcount();

   //efocus_v2(); // Add on 20201205 for testing


}  // End of function Add_or_Remove_Attendance(arg1,arg2,arg3)


async function Check_Attendance(arg1,arg2,arg3) { // arg1: CNo, arg2: Member, arg3:Gender

   var CNo = arg1;

   var DateStr = ML_Date_V2();

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance(arg1,arg2,arg3)



async function Check_Attendance2(arg1,arg2,arg3) { // arg1: CNo, arg2: Member, arg3:Gender

   var CNo = arg1;

   //var DateStr = ML_Date_V2();

   var DateStr = document.getElementById("Show_Headcount_2").value;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance2(arg1,arg2,arg3)



async function Check_Attendance3(arg1,arg2,arg3) { // arg1: CNo, arg2: Member, arg3:Gender

   var CNo = arg1;

   //var DateStr = ML_Date_V2();

   //var DateStr = document.getElementById("Show_Headcount_2").value;

   var DateStr = document.getElementById("Download_Attendance_StartWith").value;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance3(arg1,arg2,arg3)





async function Check_Attendance6(arg1,arg2,arg3,arg4) { // arg1: CNo, arg2: Member, arg3:Gender, arg4: DateStr

   var CNo = arg1;

   //var DateStr = ML_Date_V2();

   //var DateStr = document.getElementById("Show_Headcount_2").value;

   //var DateStr = document.getElementById("Download_Attendance_StartWith").value;

   var DateStr = arg4;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance6(arg1,arg2,arg3)







async function Check_Db_1(arg1,arg2,arg3,Arg4) { // arg1: CNo, arg2: Member, arg3:Gender, arg4:DateStr

   var CNo = arg1;

   var DateStr = Arg4;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   //let Verse_Attendance = await dbT2.Attendance.get(Record);

   let Verse_Attendance = await dbT2.Comparing_Db_1.get(Record);


   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }


} // End of function Check_Db_1(arg1,arg2,arg3,Arg4)




async function Check_Db_2(arg1,arg2,arg3,Arg4) { // arg1: CNo, arg2: Member, arg3:Gender, arg4:DateStr

   var CNo = arg1;

   var DateStr = Arg4;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   //let Verse_Attendance = await dbT2.Attendance.get(Record);

   let Verse_Attendance = await dbT2.Comparing_Db_2.get(Record);


   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }


} // End of function Check_Db_2(arg1,arg2,arg3,Arg4)




async function Check_Attendance4(arg1,arg2,arg3,arg4) { // arg1: CNo, arg2: Member, arg3:Gender, arg4:DateStr

   var CNo = arg1;

   //var DateStr = ML_Date_V2();

   //var DateStr = document.getElementById("Show_Headcount_2").value;

   var DateStr = arg4;

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance4(arg1,arg2,arg3)




async function Check_Attendance5(arg1,arg2,arg3) { // arg1: CNo, arg2: Member, arg3:Gender

   var CNo = arg1;

   //var DateStr = ML_Date_V2();

   //var DateStr = document.getElementById("Show_Headcount_2").value;

   //var DateStr = document.getElementById("Download_Attendance_StartWith").value;

   var DateStr = Display_ID_2; // Exp_start_date , '20200920E'

   var Member_Str = arg2;
   var Gender_Str = arg3;

   let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

   let Verse_Attendance = await dbT2.Attendance.get(Record);

   if (Verse_Attendance) {

      var Result = 'y'; // mean has Data

      return Result;

   }
   else {

      var Result = 'n'; // mean No Data

      return Result;

   }

}  // End of function Check_Attendance5(arg1,arg2,arg3)




async function Roll_Call() {


  let Verse_3 = await dbT2.Roll.toArray();

  //let Verse = await dbT2.Attendance.reverse().toArray();

  //var DateStr = ML_Date_V2();


  if (Verse_3) {

     var Rnum = 3001;  // Rnum
     var Rvers = 4001;  // EName
     var CName = 5001;  // CName

     var Roll_Call_Content_Str = '<table><tr>';

     var j=1;

     for (var i = 0; i < Verse_3.length ; i++) {

        var H_No_tmp = Verse_3[i].H_No;        // 1_2
        var H_No_tmp2 = H_No_tmp.split("_");   
        var H_No_tmp3 = H_No_tmp2[1];          // 2

        if (H_No_tmp3 == '1' || j==1) {

           var add_str1 = '</tr><tr>';

           var add_str2 = '<td valign=\"top\"><div id=\"' + Rnum + '\"></div></td><td><div id=\"' + Rvers + '\"></div></td><td><div id=\"' + CName + '\"></div></td>';

           Roll_Call_Content_Str = Roll_Call_Content_Str + add_str1 + add_str2;

           j=2;

        }
        else {

           var add_str1 = '<td></td><td></td><td></td><td></td><td></td>';

           var add_str2 = '<td valign=\"top\"><div id=\"' + Rnum + '\"></div></td><td><div id=\"' + Rvers + '\"></div></td><td><div id=\"' + CName + '\"></div></td>';

           Roll_Call_Content_Str = Roll_Call_Content_Str + add_str1 + add_str2;

           j=1;

        }



        //var '<tr><td valign=\"top\"><div id=\"' + Rnum + '\"></div></td><td><div id=\"' + Rvers + '\"></div></td><td><div id=\"' + CName + '\"></div></td></tr>';

        //Roll_Call_Content_Str = Roll_Call_Content_Str + 


        Rnum++;
        Rvers++;
        CName++;

        //if ( j==1 ) {
        //   j=2;
        //} 
        //else {
        //   j=1;
        //}
           

     } // End of for (var i = 0; i < Verse_3.length ; i++)

     var Roll_Call_Content_Str = Roll_Call_Content_Str + '</tr></table>';

     document.getElementById("Roll_Call_Content").innerHTML = Roll_Call_Content_Str;

  }


  if (Verse_3) {

     var Rnum = 3001;  // Rnum
     var Rvers = 4001;  // EName
     var CName = 5001;  // CName

     for (var i = 0; i < Verse_3.length ; i++) {

        // arg1: CNo, arg2: Member, arg3:Gender

        var arg1 = Verse_3[i].CNo;

        var arg2 = Verse_3[i].Member;

        var arg3 = Verse_3[i].Gender;

        var Result = await Check_Attendance(arg1,arg2,arg3);

        if (Result == 'y') {

           document.getElementById(Rvers).style.color = "blue";

        }
        else {

           document.getElementById(Rvers).style.color = "black";

        }


        var Name_Str = Verse_3[i].L_Name + ',' + Verse_3[i].F_Name + ' ';

        //var Name_Str = Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name + ' ';



        if (Verse_3[i].Member == 'T') {

           Name_Str = '*' + Verse_3[i].L_Name + ',' + Verse_3[i].F_Name + ' ';

        }


        var H_No_tmp = Verse_3[i].H_No;        // 1_2
        var H_No_tmp2 = H_No_tmp.split("_");   
        var H_No_tmp3 = H_No_tmp2[1];          // 2

        if (H_No_tmp3 == '1') {

           Name_Str = '<b><u>' + Name_Str + ' </u></b>';

        }
        //else {

        //   var Name_Str = Verse_3[i].L_Name + ',' + Verse_3[i].F_Name + ' ';

        //}

        var Name_Str2 =  Verse_3[i].C_F_Name + Verse_3[i].C_L_Name;

        //document.getElementById(Rnum++).innerHTML = 'V';

 //Add_or_Remove_Attendance(arg1,arg2,arg3,arg4) { // arg1: CNo, arg2: Member, arg3:Gender, arg4: position

        //var Check_Str = '<a href="" " onClick="Add_or_Remove_Attendance(' + arg1 + ',' + arg2 + ',' + arg3 + ',' + Rvers + ');return false;"> V </a>';

        //<button onclick="Add_or_Remove_Attendance('5','M','B','4001')">Test Add or remove</button>


        var Check_Str = '<button onClick="Add_or_Remove_Attendance(\'' + arg1 + '\',\'' + arg2 + '\',\'' + arg3 + '\',\'' + Rvers + '\')"> V </button>';  // Using \' as an escape character

        document.getElementById(Rnum++).innerHTML = Check_Str;

        document.getElementById(Rvers++).innerHTML =  Name_Str;

        document.getElementById(CName++).innerHTML =  Name_Str2;


     } // End of for (var i = 0; i < Verse_3.length ; i++)



  }


}  // End of function Roll_Call()



async function list_all_Roll() {

  //let Verse_3 = await dbT2.Congregation3.toArray();

  let Verse_3 = await dbT2.Roll.toArray();

  //let Verse = await dbT2.Congregation2.reverse().toArray();


  if (Verse_3) {

     if (Verse_3.length) {
       listElem.innerHTML = Verse_3.map(book => `<li>

           Roll_No: ${book.Roll_No}  CNo:${book.CNo}  ${book.L_Name},${book.F_Name}   ${book.C_F_Name} ${book.C_L_Name}   H_No:${book.H_No}
         </li>`).join('');
     } else {
       listElem.innerHTML = '<li>Householder No Data</li>'
     }

  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function list_all_Roll()



async function Householder_to_Roll() {

  //let Verse_3 = await dbT2.Congregation3.toArray();

  //let Verse = await dbT2.Congregation2.reverse().toArray();


  let Verse_3 = await dbT2.Householder.toArray();


  //dbT2.Roll.clear();  // delete all in Roll

  if (Verse_3) {

     dbT2.Roll.clear();  // delete all in Roll

     // 

     for (i = 0; i < Verse_3.length; i++) {

        //var CNo = Verse[i].CNo;
        //var F_Name = Verse[i].F_Name;
        //var L_Name = Verse[i].L_Name;

        var H_No_tmp = Verse_3[i].H_No;   // 1_1 , 2_1

        var H_No_tmp2 = H_No_tmp.split("_"); 

        var H_No_tmp3 = H_No_tmp2[0] + '_';   // 1_ , 2_

        //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

        let Verse = await dbT2.Congregation4.where('H_No').startsWithIgnoreCase(H_No_tmp3).toArray();

        //let Verse = await dbT2.Congregation2.where('H_No').startsWithIgnoreCase(H_No_tmp3).orderBy('H_No').toArray();

        //let Verse = await dbT2.Congregation2.where('H_No').equals(H_No_tmp).toArray();

        if (Verse) {

           // Add data to Roll from Congregation4 

           for (j = 0; j < Verse.length; j++) {

              var CNo = Verse[j].CNo;

              var F_Name = Verse[j].F_Name;
              var L_Name = Verse[j].L_Name;
              var Member = Verse[j].Member;   

              var C_F_Name = Verse[j].C_F_Name;
              var C_L_Name = Verse[j].C_L_Name;
              var Gender = Verse[j].Gender;  

              var H_No = Verse[j].H_No;

              var E_F_LName = Verse[0].L_Name;
              var C_F_FName = Verse[0].C_F_Name;

              try { 

                 dbT2.Roll.add({ CNo, F_Name, L_Name, Member, Gender, C_F_Name, C_L_Name, H_No, E_F_LName, C_F_FName });
                 // E_F_LName : English Family Last Name
                 // C_F_FName : Chinese Family First Name 姓

                 //dbT2.Roll.add({ CNo, F_Name, L_Name, Member, Gender, C_F_Name, C_L_Name, H_No }); // E_F_LName : English Family Last Name
                 //                                                                                  // C_F_LName : Chinese Family Last Name

              } catch(err) {   

                 if (err.name == 'ConstraintError') {
                   alert("Such book exists already");
                   //await addBook();
                 } else {
                   throw err;
                 }

              }


           } // End of for (j = 0; j < Verse.length; j++)

        } // End of if (Verse)


     } // End of for (i = 0; i < Verse_3.length; i++)


  }
  else {

     listElem.innerHTML = 'No Data';

  }

  Read_for_Roll_Call = 'N';


}  // End of function Householder_to_Roll()


async function Householder_to_Roll_old() { // Not in use

  //let Verse_3 = await dbT2.Congregation3.toArray();

  //let Verse = await dbT2.Congregation2.reverse().toArray();


  let Verse_3 = await dbT2.Householder.toArray();


  //dbT2.Roll.clear();  // delete all in Roll

  if (Verse_3) {

     dbT2.Roll.clear();  // delete all in Roll

     // 

     for (i = 0; i < Verse_3.length; i++) {

        //var CNo = Verse[i].CNo;
        //var F_Name = Verse[i].F_Name;
        //var L_Name = Verse[i].L_Name;

        var H_No_tmp = Verse_3[i].H_No;   // 1_1 , 2_1

        var H_No_tmp2 = H_No_tmp.split("_"); 

        var H_No_tmp3 = H_No_tmp2[0] + '_';   // 1_ , 2_

        //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

        let Verse = await dbT2.Congregation4.where('H_No').startsWithIgnoreCase(H_No_tmp3).toArray();

        //let Verse = await dbT2.Congregation2.where('H_No').startsWithIgnoreCase(H_No_tmp3).orderBy('H_No').toArray();

        //let Verse = await dbT2.Congregation2.where('H_No').equals(H_No_tmp).toArray();

        if (Verse) {

           // Add data to Roll from Congregation4 

           for (j = 0; j < Verse.length; j++) {

              var CNo = Verse[j].CNo;

              var F_Name = Verse[j].F_Name;
              var L_Name = Verse[j].L_Name;
              var Member = Verse[j].Member;   

              var C_F_Name = Verse[j].C_F_Name;
              var C_L_Name = Verse[j].C_L_Name;
              var Gender = Verse[j].Gender;  

              var H_No = Verse[j].H_No;

              try { 

                 dbT2.Roll.add({ CNo, F_Name, L_Name, Member, Gender, C_F_Name, C_L_Name, H_No });   

              } catch(err) {   

                 if (err.name == 'ConstraintError') {
                   alert("Such book exists already");
                   //await addBook();
                 } else {
                   throw err;
                 }

              }


           } // End of for (j = 0; j < Verse.length; j++)

        } // End of if (Verse)


     } // End of for (i = 0; i < Verse_3.length; i++)


  }
  else {

     listElem.innerHTML = 'No Data';

  }


}  // End of function Householder_to_Roll()



async function add_people_to_Congregation() {

  let CNo = document.getElementById("cNo").value;
  let F_Name = document.getElementById("fname").value;
  let L_Name = document.getElementById("lname").value;
  let Member = document.getElementById("Member").value;
  let Gender = document.getElementById("Gender").value;

  let H_No = document.getElementById("h_No").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
  let C_F_Name = document.getElementById("Cfname").value; // 姓
  let C_L_Name = document.getElementById("Clname").value; // 名字
  let F_Order = document.getElementById("fOrder").value; // 1 for Householder

  //let date = ML_Date();

  //let tx = db.transaction('books', 'readwrite');

  try {
    //await tx.objectStore('books').add({name,color_no, book_no, chap_no, vers_no});

    dbT2.Congregation.add({CNo,F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order });

    //dbT2.Congregation.add({F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order });

    //dbT.books.add({name: "Ingemar Bergman", isCloseFriend: 0});


    //await list();
  } catch(err) {
    if (err.name == 'ConstraintError') {
      alert("Such book exists already");
      //await addBook();
    } else {
      throw err;
    }
  }
}  // End of function add_people_to_Congregation()



async function generate_CNo_for_New_Family_Member() {

  read_from_Congregation4();

  setTimeout(generate_CNo_for_New_Family_Member_2, 300);

} // End of function generate_CNo_for_New_Family_Member()


async function generate_CNo_for_New_Family_Member_2() {

   // Generate CNo, HNo and Family Order for Congregation4 for New Family Member


  //let CNo = document.getElementById("cNo2").value;
  //let F_Name = document.getElementById("fname2").value;
  //let L_Name = document.getElementById("lname2").value;
  //let Member = document.getElementById("Member2").value;
  //let Gender = document.getElementById("Gender2").value;

  //let H_No = document.getElementById("h_No2").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2



  var Check_Mesg = document.getElementById("Mesg2").value; //  = 'Succeeded.';

  if (Check_Mesg == 'Succeeded.') {  //  Having Valid CNo in ById("cNo2")
                                     //  Before Add New Family Member need to Have Valid CNo in ById("cNo2")

      document.getElementById("Mesg3").value = 'Input Data then press Add.';
      document.getElementById("Mesg3").readOnly = true;
      document.getElementById("Mesg3").style.color = "red";

      // Determine CNo

      let Verse_tmp = await dbT2.Congregation4.reverse().toArray();

      let Verse_tmp3 = await dbT2.Congregation4.count();


      if (Verse_tmp3 == 0) {  // Generate CNo
 
         var CNo_tmp = Number('1');

         var CNo_str = '1';

      }
      else {

         if (Verse_tmp) {  // Generate CNo

            //var num = 15;
            //var n = num.toString();

            var CNo_tmp = Number(Verse_tmp[0].CNo + 1);

            var CNo_str = CNo_tmp.toString();

         }
         else {

            var CNo_tmp = Number('1');

            var CNo_str = '1';

         }

      }

      document.getElementById("cNo3").value = CNo_tmp;


      // Determine HNo

      var H_No_tmp = document.getElementById("h_No2").value; // 1_1

      var H_No_tmp2 = H_No_tmp.split("_");

      var H_No_tmp4 = H_No_tmp2[0] + '_';  // 1_

      var H_No_tmp8 = H_No_tmp2[0] + '_1' ;  // 1_1

      let Verse_tmp2 = await dbT2.Congregation4.where("H_No").startsWithIgnoreCase(H_No_tmp4).reverse().toArray();

      //let Verse_tmp2 = await dbT2.Congregation4.where("H_No").startsWithIgnoreCase('1_').reverse().toArray();

      var H_No_tmp5 = Verse_tmp2[0].H_No; // 1_3

      var H_No_tmp6 = H_No_tmp5.split("_");

      var H_No_tmp7 = Number(H_No_tmp6[1]) + 1;  // 4

      var H_No_tmp3 = H_No_tmp4 + H_No_tmp7;  // 1_4

      document.getElementById("h_No3").value = H_No_tmp3;


      // Determine Family Order

      document.getElementById("fOrder3").value = H_No_tmp7;


      // Determine Tel

      var Tel2_tmp = document.getElementById("Tel2").value;

      //if (Tel2_tmp) {

         //if (Tel2_tmp != '') {

            document.getElementById("Tel3").value = Tel2_tmp;

         //}

      //}

      // Determine L_Name

      var Verse_tmp333 = await dbT2.Congregation4.where("H_No").startsWithIgnoreCase(H_No_tmp8).toArray();

      var C_F_Name_tmp5 = Verse_tmp333[0].C_F_Name;

      var L_Name_tmp5 = Verse_tmp333[0].L_Name;

      document.getElementById("lname3").value = L_Name_tmp5;  // Cfname3

      document.getElementById("Cfname3").value = C_F_Name_tmp5;  // Cfname3

  } 
  else {  // No Valid CNo in ById("cNo2")

      document.getElementById("Mesg3").value = 'Read Valid CNo in above Section first.';
      document.getElementById("Mesg3").readOnly = true;
      document.getElementById("Mesg3").style.color = "red";

  }


} // End of function generate_CNo_for_New_Family_Member_2()


async function generate_CNo_for_New_Householder() {

   // Generate CNo, HNo and Family Order for Congregation4 for New Householder


  //let CNo = document.getElementById("cNo2").value;
  //let F_Name = document.getElementById("fname2").value;
  //let L_Name = document.getElementById("lname2").value;
  //let Member = document.getElementById("Member2").value;
  //let Gender = document.getElementById("Gender2").value;

  //let H_No = document.getElementById("h_No2").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

  
      document.getElementById("Mesg2").value = 'Input Data then press Add.';
      document.getElementById("Mesg2").readOnly = true;
      document.getElementById("Mesg2").style.color = "red";


      let Verse_tmp = await dbT2.Congregation4.reverse().toArray();

      let Verse_tmp2 = await dbT2.Congregation4.where("F_Order").equals('1').reverse().toArray();

      let Verse_tmp3 = await dbT2.Congregation4.count();

      let Verse_tmp4 = await dbT2.Congregation4.where("F_Order").equals('1').count();

      //let Verse_tmp = await dbT2.Congregation2.reverse().toArray();

      //let Verse_tmp2 = await dbT2.Congregation2.where("F_Order").equals('1').reverse().toArray();


      if (Verse_tmp4 == 0) {
 
         var H_No_tmp3 = '1_1';

      }
      else {

         if (Verse_tmp2) {

            var H_No_tmp = Verse_tmp2[0].H_No;    // 1_1 , 2_1

            var H_No_tmp2 = H_No_tmp.split("_");

            var H_No_tmp4 = Number(H_No_tmp2[0]) + 1;

            var H_No_tmp3 = H_No_tmp4 + '_1';   // 2_1 , 3_1

         }
         else {

            var H_No_tmp3 = '1_1';

         }

      }

      if (Verse_tmp3 == 0) {
 
         var CNo_tmp = Number('1');

         var CNo_str = '1';

      }
      else {

         if (Verse_tmp) {

            //var num = 15;
            //var n = num.toString();

            var CNo_tmp = Number(Verse_tmp[0].CNo + 1);

            var CNo_str = CNo_tmp.toString();

         }
         else {

            var CNo_tmp = Number('1');

            var CNo_str = '1';

         }

      }

      document.getElementById("cNo2").value = CNo_tmp;

      document.getElementById("h_No2").value = H_No_tmp3;

      document.getElementById("fOrder2").value = '1';
      

  //let H_No = date + '-' + CNo_str;  // Format : YYYYMMDD-CNo, ex: 20200311-2

  //document.getElementById("h_No2").value = H_No;



} // End of function generate_CNo_for_New_Householder()



async function add_people_to_Congregation4_F() {

  let CNo = Number(document.getElementById("cNo3").value);
  let F_Name = document.getElementById("fname3").value;
  let L_Name = document.getElementById("lname3").value;
  let Member = document.getElementById("Member3").value;
  let Gender = document.getElementById("Gender3").value;

  let H_No = document.getElementById("h_No3").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

  let C_F_Name = document.getElementById("Cfname3").value; // 姓
  let C_L_Name = document.getElementById("Clname3").value; // 名字
  let F_Order = document.getElementById("fOrder3").value; // 1 for Householder

  let Tel = document.getElementById("Tel3").value;
  let Mob = document.getElementById("Mob3").value;


  if ( CNo>0 && F_Name != '' && L_Name != '' && Member != '' && Gender != '' ) {


     let Verse = await dbT2.Congregation4.get(CNo);

     if (Verse) {

        document.getElementById("Mesg3").value = F_Name + ' ' + L_Name + ' exists already.';
        document.getElementById("Mesg3").readOnly = true;
        document.getElementById("Mesg3").style.color = "red";

     }
     else {

        try {

          dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

          document.getElementById("Mesg3").value = F_Name + ' ' + L_Name + ' added as a Family Member.';
          document.getElementById("Mesg3").readOnly = true;
          document.getElementById("Mesg3").style.color = "blue";

        } catch(err) {

          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
             //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
             //document.getElementById("Mesg2").readOnly = true;
          } else {
            throw err;
          }
        }

     }  // End of if (Verse)


  }  // End of if ( CNo>0 && F_Name != ''...


}  // End of function add_people_to_Congregation4_F()



async function update_Service_Record() {  // use Display_ID_1

  let ID_1 = Display_ID_1;

  //let ID_1 = G_ServiceDate1;

  //var CNo_tmp = document.getElementById("cNo2").value;

  let Verse = await dbT2.Service_Record.get(ID_1);

  if (Verse) {  // Exist so update

     //var F_Name_tmp = document.getElementById("fname2").value;
     //var L_Name_tmp = document.getElementById("lname2").value;

     var Service_Start_Time_tmp = document.getElementById("Service_Start_Time").value;
     var Service_End_Time_tmp = document.getElementById("Service_End_Time").value;
     var Usher_tmp = document.getElementById("Usher").value;

     var Topic_tmp = document.getElementById("Topic").value;
     var Hymn_tmp = document.getElementById("Hymn").value;

     var Speaker_tmp = document.getElementById("Speaker").value;
     var Interp_tmp = document.getElementById("Interp").value;
     var Hymnal_tmp = document.getElementById("Hymnal").value;

     var Note_tmp = document.getElementById("Service_Record_Note").value;


     Bro_M = Number(document.getElementById("Visitor_Brother_Member").value);    // Add on 2020.10.07
     Sis_M = Number(document.getElementById("Visitor_Sister_Member").value);
     Bro_TrS = Number(document.getElementById("Visitor_Brother_Truth_Seeker").value);
     Sis_TrS = Number(document.getElementById("Visitor_Sister_Truth_Seeker").value);


     var Bro_M_Note_tmp = Bro_M;
     var Sis_M_Note_tmp = Sis_M;
     var Bro_TrS_Note_tmp = Bro_TrS;
     var Sis_TrS_Note_tmp = Sis_TrS;


     Show_Total_Mode();  // Add on 2020.10.07


     dbT2.Service_Record.update(ID_1, { Service_Start_Time: Service_Start_Time_tmp, Service_End_Time: Service_End_Time_tmp, Usher: Usher_tmp, Topic: Topic_tmp, Hymn: Hymn_tmp, Speaker: Speaker_tmp, Interp: Interp_tmp, Hymnal: Hymnal_tmp, Note: Note_tmp, Bro_M_Note: Bro_M_Note_tmp, Sis_M_Note: Sis_M_Note_tmp, Bro_TrS_Note: Bro_TrS_Note_tmp, Sis_TrS_Note: Sis_TrS_Note_tmp });

     //dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

  }


} // End of function update_Service_Record()



async function add_Service_Record_V2() {   // for add link between by manual

        // Service_Record: 'ID_1,ID_2'      // ID_1 : 202009261 , 202009262 , 202009253 
        //                                  // ID_2 : 20200926M , 20200926A , 20200925E 

  let ID_1 = document.getElementById("Add_Service_Record_ID_1").value;
  let ID_2 = document.getElementById("Add_Service_Record_ID_2").value;

  let Service_Date = document.getElementById("Add_Service_Record_Service_Date").value;


  //let Service_Date = document.getElementById("Service_Date").value;

  let Service_Start_Time = ''; //document.getElementById("Service_Start_Time").value;
  let Service_End_Time = '';   //document.getElementById("Service_End_Time").value;
  let Usher = '';              //document.getElementById("Usher").value;

  let Topic = '';              //document.getElementById("Topic").value;
  let Hymn = '';               //document.getElementById("Hymn").value;

  let Speaker = '';            //document.getElementById("Speaker").value;
  let Interp = '';             //document.getElementById("Interp").value;
  let Hymnal = '';             //document.getElementById("Hymnal").value;

  let Note = '';               //document.getElementById("Service_Record_Note").value;

  let Bro_M_Note = 0;      // for Bro_M not on the Roll
  let Sis_M_Note = 0;      // for Sis_M not on the Roll
  let Bro_TrS_Note = 0;  // for Bro_TrS not on the Roll
  let Sis_TrS_Note = 0;  // for Sis_TrS not on the Roll

   //Bro_M = 0;
   //Sis_M = 0;
   //Bro_TrS = 0;
   //Sis_TrS = 0;

     //let Verse = await dbT2.Service_Record.get(ID_1);

     //if (Verse) {
        // Do nothing

     //   Show_Service_Record(G_ServiceDate2);

     //}
     //else {

        //Clear_Service_Record();

        //Reset_All();

        try {

          dbT2.Service_Record.add({ID_1, ID_2, Service_Date, Service_Start_Time, Service_End_Time, Usher, Topic, Hymn, Speaker, Interp, Hymnal, Note, Bro_M_Note, Sis_M_Note, Bro_TrS_Note, Sis_TrS_Note });

          //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

        } catch(err) {

          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
             //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
             //document.getElementById("Mesg2").readOnly = true;
          } else {
            throw err;
          }
        }

     //}  // End of if (Verse)


} // End of function add_Service_Record_V2()  



async function add_Service_Record() {

        // Service_Record: 'ID_1,ID_2'      // ID_1 : 202009261 , 202009262 , 202009253 
        //                                  // ID_2 : 20200926M , 20200926A , 20200925E 

  let ID_1 = G_ServiceDate1;
  let ID_2 = G_ServiceDate2;

  let Service_Date = document.getElementById("Service_Date").value;
  let Service_Start_Time = ''; //document.getElementById("Service_Start_Time").value;
  let Service_End_Time = '';   //document.getElementById("Service_End_Time").value;
  let Usher = '';              //document.getElementById("Usher").value;

  let Topic = '';              //document.getElementById("Topic").value;
  let Hymn = '';               //document.getElementById("Hymn").value;

  let Speaker = '';            //document.getElementById("Speaker").value;
  let Interp = '';             //document.getElementById("Interp").value;
  let Hymnal = '';             //document.getElementById("Hymnal").value;

  let Note = '';               //document.getElementById("Service_Record_Note").value;

  let Bro_M_Note = Bro_M;      // for Bro_M not on the Roll
  let Sis_M_Note = Sis_M;      // for Sis_M not on the Roll
  let Bro_TrS_Note = Bro_TrS;  // for Bro_TrS not on the Roll
  let Sis_TrS_Note = Sis_TrS;  // for Sis_TrS not on the Roll

   //Bro_M = 0;
   //Sis_M = 0;
   //Bro_TrS = 0;
   //Sis_TrS = 0;

     //let Verse = await dbT2.Service_Record.get(ID_1);

     //if (Verse) {
        // Do nothing

     //   Show_Service_Record(G_ServiceDate2);

     //}
     //else {

        //Clear_Service_Record();

        //Reset_All();

        try {

          dbT2.Service_Record.add({ID_1, ID_2, Service_Date, Service_Start_Time, Service_End_Time, Usher, Topic, Hymn, Speaker, Interp, Hymnal, Note, Bro_M_Note, Sis_M_Note, Bro_TrS_Note, Sis_TrS_Note });

          //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

        } catch(err) {

          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
             //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
             //document.getElementById("Mesg2").readOnly = true;
          } else {
            throw err;
          }
        }

     //}  // End of if (Verse)


} // End of function add_Service_Record()  



async function add_Service_Record_old() {  // Work with function Start_Service_Record_old()

        // Service_Record: 'ID_1,ID_2'      // ID_1 : 202009261 , 202009262 , 202009253 
        //                                  // ID_2 : 20200926M , 20200926A , 20200925E 

  let ID_1 = G_ServiceDate1;
  let ID_2 = G_ServiceDate2;

  let Service_Date = document.getElementById("Service_Date").value;
  let Service_Start_Time = ''; //document.getElementById("Service_Start_Time").value;
  let Service_End_Time = '';   //document.getElementById("Service_End_Time").value;
  let Usher = '';              //document.getElementById("Usher").value;

  let Topic = '';              //document.getElementById("Topic").value;
  let Hymn = '';               //document.getElementById("Hymn").value;

  let Speaker = '';            //document.getElementById("Speaker").value;
  let Interp = '';             //document.getElementById("Interp").value;
  let Hymnal = '';             //document.getElementById("Hymnal").value;

  let Note = '';               //document.getElementById("Service_Record_Note").value;

  let Bro_M_Note = Bro_M;      // for Bro_M not on the Roll
  let Sis_M_Note = Sis_M;      // for Sis_M not on the Roll
  let Bro_TrS_Note = Bro_TrS;  // for Bro_TrS not on the Roll
  let Sis_TrS_Note = Sis_TrS;  // for Sis_TrS not on the Roll

   //Bro_M = 0;
   //Sis_M = 0;
   //Bro_TrS = 0;
   //Sis_TrS = 0;

     let Verse = await dbT2.Service_Record.get(ID_1);

     if (Verse) {
        // Do nothing

        Show_Service_Record(G_ServiceDate2);

     }
     else {

        Clear_Service_Record();

        Reset_All();

        try {

          dbT2.Service_Record.add({ID_1, ID_2, Service_Date, Service_Start_Time, Service_End_Time, Usher, Topic, Hymn, Speaker, Interp, Hymnal, Note, Bro_M_Note, Sis_M_Note, Bro_TrS_Note, Sis_TrS_Note });

          //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

        } catch(err) {

          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
             //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
             //document.getElementById("Mesg2").readOnly = true;
          } else {
            throw err;
          }
        }

     }  // End of if (Verse)


} // End of function add_Service_Record_old()  



async function add_people_to_Congregation4() {

  let CNo = Number(document.getElementById("cNo2").value);
  let F_Name = document.getElementById("fname2").value;
  let L_Name = document.getElementById("lname2").value;
  let Member = document.getElementById("Member2").value;
  let Gender = document.getElementById("Gender2").value;

  let H_No = document.getElementById("h_No2").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

  let C_F_Name = document.getElementById("Cfname2").value; // 姓
  let C_L_Name = document.getElementById("Clname2").value; // 名字
  let F_Order = document.getElementById("fOrder2").value; // 1 for Householder

  let Tel = document.getElementById("Tel2").value;
  let Mob = document.getElementById("Mob2").value;


  if ( CNo>0 && F_Name != '' && L_Name != '' && Member != '' && Gender != '' ) {


     let Verse = await dbT2.Congregation4.get(CNo);

     if (Verse) {

        document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
        document.getElementById("Mesg2").readOnly = true;
        document.getElementById("Mesg2").style.color = "red";

     }
     else {

        try {

          dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

          document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' added as a Householder.';
          document.getElementById("Mesg2").readOnly = true;
          document.getElementById("Mesg2").style.color = "blue";

        } catch(err) {

          if (err.name == 'ConstraintError') {
            alert("Such book exists already");
             //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
             //document.getElementById("Mesg2").readOnly = true;
          } else {
            throw err;
          }
        }

     }  // End of if (Verse)


  }  // End of if ( CNo>0 && F_Name != ''...


}  // End of function add_people_to_Congregation4()



async function add_people_to_Congregation2() {

  //let CNo2 = document.getElementById("cNo").value;
  let F_Name = document.getElementById("fname2").value;
  let L_Name = document.getElementById("lname2").value;
  let Member = document.getElementById("Member2").value;
  let Gender = document.getElementById("Gender2").value;

  let H_No = document.getElementById("h_No2").value;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

  //let date = ML_Date();  // ex: 20200311

  //let Verse_tmp = await dbT2.Congregation2.reverse().toArray();

  //let Verse_tmp = await dbT2.Congregation2.last();

  //if (Verse_tmp) {

  //   //var num = 15;
  //   //var n = num.toString();

  //   var CNo_tmp = Verse_tmp[0].CNo + 1;

  //   var CNo_str = CNo_tmp.toString();

  //}
  //else {

  //   var CNo_str = '1';

  //}

  //let H_No = date + '-' + CNo_str;  // Format : YYYYMMDD-CNo, ex: 20200311-2

  //document.getElementById("h_No2").value = H_No;

  let C_F_Name = document.getElementById("Cfname2").value; // 姓
  let C_L_Name = document.getElementById("Clname2").value; // 名字
  let F_Order = document.getElementById("fOrder2").value; // 1 for Householder

  //let date = ML_Date();  // ex: 20200311

  //let tx = db.transaction('books', 'readwrite');

  try {
    //await tx.objectStore('books').add({name,color_no, book_no, chap_no, vers_no});

    //dbT2.Congregation.add({CNo,F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name });

    dbT2.Congregation2.add({F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order });

    //dbT.books.add({name: "Ingemar Bergman", isCloseFriend: 0});


    //await list();
  } catch(err) {
    if (err.name == 'ConstraintError') {
      alert("Such book exists already");
      //await addBook();
    } else {
      throw err;
    }
  }
}  // End of function add_people_to_Congregation2()



async function add_record_to_Attendance() {


  let DateStr = ML_Date_V2();

  //let CNo = document.getElementById("Attendant_No").value;

  let CNo_tmp = document.getElementById("Attendant_No").value;
  var CNo = Number(CNo_tmp);

  //let CNo = '5';

  var Member_Str;
  var Gender_Str;

  if(CNo != '') {

     //let Verse = await dbT2.Congregation.toArray();   where('name').startsWithIgnoreCase('39_').toArray()


     let Verse = await dbT2.Roll.where("CNo").equals(CNo).toArray();  // Mark for test

     //let Verse = await dbT2.Congregation4.where("CNo").equals(CNo).toArray();  // for test


     //let Verse = await db.Congregation.where('CNo').startsWithIgnoreCase('5').toArray();


     if (Verse.length) {

        //var F_L_Name_tmp = Verse.F_Name + ' ' + Verse.L_Name;

        var F_L_Name_tmp = Verse[0].F_Name + ' ' + Verse[0].L_Name + ' ' + ' ' + Verse[0].C_F_Name + ' ' + Verse[0].C_L_Name;


        Member_Str = Verse[0].Member;
        Gender_Str = Verse[0].Gender;

        //let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

        let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo_tmp;

        //let Record = DateStr + '_' + CNo + '_' + Member_Str + '_' + Gender_Str;


        //document.getElementById("listElem3").innerHTML = F_L_Name_tmp;

   
        let Verse_Attendance = await dbT2.Attendance.get(Record);


        if (Verse_Attendance) {

           document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : Exist Already';

           document.getElementById("listElem3").style.color = "black";

           document.getElementById("listElem3").style.fontSize = "44";

        } 
        else {


           try {

             dbT2.Attendance.add({Record });

             //var str_1 = F_L_Name_tmp + ' : OK'; // str.fontcolor("green")

             //var str_2 = str_1.fontcolor("blue");

             document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : OK';

             document.getElementById("listElem3").style.color = "blue";  // fontSize

             document.getElementById("listElem3").style.fontSize = "44";


           } catch(err) {
             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
             } else {
               throw err;
             }
           }


        } // End of if (Verse_Attendance)

    
     }
     else {

        document.getElementById("listElem3").innerHTML = 'No Data in DB';

        document.getElementById("listElem3").style.color = "black";

        document.getElementById("listElem3").style.fontSize = "44";

     } // End of if (Verse)


  } // End of if(CNo != '')


}  // End of function add_record_to_Attendance()


async function add_record_to_Attendance_V2(arg1) {

  //let CNo = document.getElementById("cNo").value;
  //let F_Name = document.getElementById("fname").value;
  //let L_Name = document.getElementById("lname").value;
  //let Member = document.getElementById("Member").value;
  //let Gender = document.getElementById("Gender").value;


  let DateStr = ML_Date_V2();

  //let CNo = arg1;

  let CNo_tmp = arg1;
  var CNo = Number(CNo_tmp);



  //let CNo = document.getElementById("Attendant_No").value;


  var Member_Str;
  var Gender_Str;

  if(CNo != '') {

     //let Verse = await dbT2.Congregation.toArray();   where('name').startsWithIgnoreCase('39_').toArray()

     let Verse = await dbT2.Roll.where("CNo").equals(CNo).toArray();

     //let Verse = await dbT2.Congregation2.get(CNo);
     //let Verse = await db.Congregation.where('CNo').startsWithIgnoreCase('5').toArray();


     if (Verse.length) {

        //var F_L_Name_tmp = Verse.F_Name + ' ' + Verse.L_Name;

        var F_L_Name_tmp = Verse[0].F_Name + ' ' + Verse[0].L_Name + ' ' + ' ' + Verse[0].C_F_Name + ' ' + Verse[0].C_L_Name;


        Member_Str = Verse[0].Member;
        Gender_Str = Verse[0].Gender;

        //let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

        let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo_tmp;

        //let Record = DateStr + '_' + CNo + '_' + Member_Str + '_' + Gender_Str;


        //document.getElementById("listElem3").innerHTML = F_L_Name_tmp;

   
        let Verse_Attendance = await dbT2.Attendance.get(Record);


        if (Verse_Attendance) {

           document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : Exist Already';

           document.getElementById("listElem3").style.color = "black";

           document.getElementById("listElem3").style.fontSize = "44";

        } 
        else {


           try {

             dbT2.Attendance.add({Record });

             document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : OK';

             document.getElementById("listElem3").style.color = "blue";

             document.getElementById("listElem3").style.fontSize = "44";

             Show_Headcount();

           } catch(err) {
             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
             } else {
               throw err;
             }
           }


        } // End of if (Verse_Attendance)

    
     }
     else {

        document.getElementById("listElem3").innerHTML = 'No Data in DB';

        document.getElementById("listElem3").style.color = "black";

        document.getElementById("listElem3").style.fontSize = "44";

     } // End of if (Verse)


  } // End of if(CNo != '')


}  // End of function add_record_to_Attendance_V2()


async function add_record_to_Attendance_V3(arg1) {

  //let CNo = document.getElementById("cNo").value;
  //let F_Name = document.getElementById("fname").value;
  //let L_Name = document.getElementById("lname").value;
  //let Member = document.getElementById("Member").value;
  //let Gender = document.getElementById("Gender").value;


  let DateStr = ML_Date_V2();

  //let CNo = arg1;

  let CNo_tmp = arg1;
  var CNo = Number(CNo_tmp);



  //let CNo = document.getElementById("Attendant_No").value;


  var Member_Str;
  var Gender_Str;

  if(CNo != '') {

     //let Verse = await dbT2.Congregation.toArray();   where('name').startsWithIgnoreCase('39_').toArray()

     let Verse = await dbT2.Roll.where("CNo").equals(CNo).toArray();

     //let Verse = await dbT2.Congregation2.get(CNo);
     //let Verse = await db.Congregation.where('CNo').startsWithIgnoreCase('5').toArray();


     if (Verse.length) {

        //var F_L_Name_tmp = Verse.F_Name + ' ' + Verse.L_Name;

        var F_L_Name_tmp = Verse[0].F_Name + ' ' + Verse[0].L_Name + ' ' + ' ' + Verse[0].C_F_Name + ' ' + Verse[0].C_L_Name;


        Member_Str = Verse[0].Member;
        Gender_Str = Verse[0].Gender;

        //let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo;

        let Record = DateStr + '_' + Member_Str + '_' + Gender_Str + '_' + CNo_tmp;

        //let Record = DateStr + '_' + CNo + '_' + Member_Str + '_' + Gender_Str;


        //document.getElementById("listElem3").innerHTML = F_L_Name_tmp;

   
        let Verse_Attendance = await dbT2.Attendance.get(Record);


        if (Verse_Attendance) {

           //document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : Exist Already';

           //document.getElementById("listElem3").style.color = "black";

           //document.getElementById("listElem3").style.fontSize = "44";

        } 
        else {


           try {

             dbT2.Attendance.add({Record });

             Show_Headcount(); 

             //document.getElementById("listElem3").innerHTML = F_L_Name_tmp + ' : OK';

             //document.getElementById("listElem3").style.color = "blue";

             //document.getElementById("listElem3").style.fontSize = "44";

           } catch(err) {
             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
             } else {
               throw err;
             }
           }


        } // End of if (Verse_Attendance)

    
     }
     else {

        //document.getElementById("listElem3").innerHTML = 'No Data in DB';

        //document.getElementById("listElem3").style.color = "black";

        //document.getElementById("listElem3").style.fontSize = "44";

     } // End of if (Verse)


  } // End of if(CNo != '')


}  // End of function add_record_to_Attendance_V3()



async function remove_record_from_Attendance_V2(arg1) {  // arg1:Record

   dbT2.Attendance.delete(arg1);

   Show_Headcount(); 

} // End of function remove_record_from_Attendance_V2(arg1)




async function list_all_Attendance() {


  let Verse = await dbT2.Attendance.toArray();

  //db.table.toArray()

  //let Verse = await db.books.getAll();


  if (Verse) {

     if (Verse.length) {
       listElem2.innerHTML = Verse.map(book => `<li>
           Record: ${book.Record}  
         </li>`).join('');
     } else {
       listElem2.innerHTML = '<li>No Data</li>'
     }

  }
  else {

     listElem2.innerHTML = 'No Data';

  }


}  // End of function list_all_Attendance()


var Attendance_Bro_M = 0;
var Attendance_Bro_TrS = 0;
var Attendance_Sis_M = 0;
var Attendance_Sis_TrS = 0;


async function Show_Headcount() {

  //Book_Verse_Count = await db.books.where('name').startsWithIgnoreCase(Book_tmp).count();

  //var DateStr = ML_Date_V2();   // Mark on 2020.10.07

  //var DateStr = Display_ID_2;


  if (Display_ID_2 != '') {

     var DateStr = Display_ID_2;

  }
  else {

     var DateStr = ML_Date_V2();

  }


  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


  Show_Total_Mode();


}  // End of function Show_Headcount()

async function Show_Headcount_2() {

  //Book_Verse_Count = await db.books.where('name').startsWithIgnoreCase(Book_tmp).count();

  //var DateStr = ML_Date_V2();


  var DateStr = document.getElementById("Show_Headcount_2").value;

  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


  Show_Total_Mode();

  Roll_Call_V2('S'); // <-- for show history attendance


}  // End of function Show_Headcount_2()


async function Show_Headcount_3(arg) {

  //Book_Verse_Count = await db.books.where('name').startsWithIgnoreCase(Book_tmp).count();

  //var DateStr = ML_Date_V2();

  //var DateStr = document.getElementById("Show_Headcount_2").value;

  var DateStr = arg;

  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


  Show_Total_Mode();

  //Roll_Call_V2('S'); // <-- for show history attendance

  Roll_Call_V3('S',DateStr); // <-- for show history attendance


}  // End of function Show_Headcount_3()


async function Show_Headcount_4() {

  //Book_Verse_Count = await db.books.where('name').startsWithIgnoreCase(Book_tmp).count();

  //var DateStr = ML_Date_V2();


  //var DateStr = document.getElementById("Show_Headcount_2").value;


  var DateStr = Display_ID_2;

  //var DateStr = '20200929E';


  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


  //Show_Total_Mode();


   document.getElementById("BroM").innerText= Number(Bro_M) + Attendance_Bro_M;
   document.getElementById("BroTrs").innerText= Number(Bro_TrS) + Attendance_Bro_TrS;

   document.getElementById("SisM").innerText= Number(Sis_M) + Attendance_Sis_M;
   document.getElementById("SisTrs").innerText= Number(Sis_TrS) + Attendance_Sis_TrS;

   document.getElementById("BroTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS;
   document.getElementById("SisTotal").innerText= Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

   document.getElementById("MemTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Sis_M) + Attendance_Sis_M;
   document.getElementById("TrsTotal").innerText= Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_TrS) + Attendance_Sis_TrS;

   document.getElementById("AllTotal").innerText= Number(Bro_M) + Attendance_Bro_M + Number(Bro_TrS) + Attendance_Bro_TrS + Number(Sis_M) + Attendance_Sis_M + Number(Sis_TrS) + Attendance_Sis_TrS;

   document.getElementById("AllTotal").style.backgroundColor='green';

   // Start Writing to Local Storage

   localStorage.Bro_M = Number(Bro_M);
   localStorage.Sis_M = Number(Sis_M);
   localStorage.Bro_Trs = Number(Bro_TrS);
   localStorage.Sis_Trs = Number(Sis_TrS);

   // End of Writing to Local Storage


  //Roll_Call_V2('S'); // <-- for show history attendance

  Roll_Call_V3('S',DateStr); // <-- for show history attendance


}  // End of function Show_Headcount_4()


async function Show_Headcount_5() {

  //Book_Verse_Count = await db.books.where('name').startsWithIgnoreCase(Book_tmp).count();

  //var DateStr = ML_Date_V2();

  var DateStr = Display_ID_2;


  var Record_Bro_M_Str = DateStr + '_M_B_';
  var Record_Bro_TrS_Str = DateStr + '_T_B_';

  var Record_Sis_M_Str = DateStr + '_M_S_';
  var Record_Sis_TrS_Str = DateStr + '_T_S_';

  Attendance_Bro_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_M_Str).count();
  Attendance_Bro_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Bro_TrS_Str).count();

  Attendance_Sis_M = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_M_Str).count();
  Attendance_Sis_TrS = await dbT2.Attendance.where('Record').startsWithIgnoreCase(Record_Sis_TrS_Str).count();


  Show_Total_Mode();


}  // End of function Show_Headcount_5()


async function Delete_All_Congregation() { // Delete all objects from the store.
                                // Syntax : table.clear()
                                // Compare -- table.delete(primaryKey) -- Delete object from store

  //dbT2.books.delete(arg1);

  dbT2.Congregation.clear();


}  // End of function Delete_All_Congregation()


async function Delete_All_Congregation2() { // Delete all objects from the store.
                                // Syntax : table.clear()
                                // Compare -- table.delete(primaryKey) -- Delete object from store

  //dbT2.books.delete(arg1);

  dbT2.Congregation2.clear();


}  // End of function Delete_All_Congregation2()




async function Delete_Congregation4_F_Cno() { // Delete all objects from the store.
                                // Syntax : table.clear()
                                // Compare -- table.delete(primaryKey) -- Delete object from store


  //let delete_CNo_tmp = document.getElementById("Delete_Congregation2_Cno").value;

  let delete_CNo_tmp = document.getElementById("cNo3").value;
  
  var delete_CNo = Number(delete_CNo_tmp);

  let Verse = await dbT2.Congregation4.get(delete_CNo);

  if(Verse) {

     dbT2.Congregation4.where("CNo").equals(delete_CNo).delete();

     document.getElementById("fname3").value = '';
     document.getElementById("lname3").value = '';
     document.getElementById("Member3").value = '';
     document.getElementById("Gender3").value = '';

     document.getElementById("h_No3").value = ''; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname3").value = ''; // 姓
     document.getElementById("Clname3").value = ''; // 名字
     document.getElementById("fOrder3").value = ''; // 1 for Householder

     document.getElementById("Tel3").value = '';
     document.getElementById("Mob3").value = '';

     document.getElementById("Mesg3").value = 'CNo:' + delete_CNo_tmp + ' deleted.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "blue";

  }
  else {

     document.getElementById("Mesg3").value = 'Failed. CNo:' + delete_CNo_tmp + ' does not exist.';
     document.getElementById("Mesg3").readOnly = true;
     document.getElementById("Mesg3").style.color = "red";

  }


}  // End of function Delete_Congregation4_F_Cno()



async function Delete_Attendance() {

  let delete_Record_tmp = document.getElementById("Delete_Attendance_Record").value;

  dbT2.Attendance.where("Record").startsWithIgnoreCase(delete_Record_tmp).delete();

} // End of function Delete_Attendance()

async function Delete_Attendance_V2() {

  let delete_Record_tmp2 = document.getElementById("Delete_Attendance_Record_V2").value;

  dbT2.Attendance.where("Record").startsWithIgnoreCase(delete_Record_tmp2).delete();

} // End of function Delete_Attendance_V2()

async function Add_Attendance() {

  let Record = document.getElementById("Add_Attendance_Record").value;


        let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        if (Verse) { // data exist already, so update

           // Do Nothing

        }
        else {  // add 

           try {

             dbT2.Attendance.add({Record });  // <--- *** // 20200905E_M_S_83

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


} // End of function Add_Attendance()



async function Delete_Service_Record_ID_2() {

  let delete_ID_2_tmp = document.getElementById("Delete_Service_Record_ID_2").value;

  dbT2.Service_Record.where("ID_2").equals(delete_ID_2_tmp).delete();

  

} // End of function Delete_Service_Record_ID_2()


async function Delete_Congregation4_Cno() { // Delete all objects from the store.
                                // Syntax : table.clear()
                                // Compare -- table.delete(primaryKey) -- Delete object from store


  //let delete_CNo_tmp = document.getElementById("Delete_Congregation2_Cno").value;

  let delete_CNo_tmp = document.getElementById("cNo2").value;
  
  var delete_CNo = Number(delete_CNo_tmp);

  let Verse = await dbT2.Congregation4.get(delete_CNo);

  if(Verse) {

     dbT2.Congregation4.where("CNo").equals(delete_CNo).delete();

     document.getElementById("fname2").value = '';
     document.getElementById("lname2").value = '';
     document.getElementById("Member2").value = '';
     document.getElementById("Gender2").value = '';

     document.getElementById("h_No2").value = ''; // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2
     document.getElementById("Cfname2").value = ''; // 姓
     document.getElementById("Clname2").value = ''; // 名字
     document.getElementById("fOrder2").value = ''; // 1 for Householder

     document.getElementById("Tel2").value = '';
     document.getElementById("Mob2").value = '';

     document.getElementById("Mesg2").value = 'CNo:' + delete_CNo_tmp + ' deleted.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "blue";

  }
  else {

     document.getElementById("Mesg2").value = 'Failed. CNo:' + delete_CNo_tmp + ' does not exist.';
     document.getElementById("Mesg2").readOnly = true;
     document.getElementById("Mesg2").style.color = "red";

  }


}  // End of function Delete_Congregation4_Cno()


async function Delete_Congregation2_Cno() { // Delete all objects from the store.
                                // Syntax : table.clear()
                                // Compare -- table.delete(primaryKey) -- Delete object from store

  //dbT2.books.delete(arg1);

  //dbT2.Congregation2.clear();

  //db.books.delete('1_1_18');

  //let CNo = document.getElementById("Attendant_No").value;

  //let delete_CNo = document.getElementById("Delete_Congregation2_Cno").value;

  let delete_CNo_tmp = document.getElementById("Delete_Congregation2_Cno").value;

  var delete_CNo = Number(delete_CNo_tmp);

  dbT2.Congregation2.where("CNo").equals(delete_CNo).delete();


}  // End of function Delete_Congregation2_Cno()



async function Exp_All_from_Attendance() { // New for V12

  var Verse_Count = 0;

  //var startWith_date = document.getElementById("Exp_start_date").value;

  //if(startWith_date!='') {

     //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

     //let Verse = await dbT2.Attendance.where('Record').startsWithIgnoreCase(startWith_date).toArray();

     let Verse = await dbT2.Attendance.toArray();

     Verse_Count = Verse.length;

     if (Verse) {

        //var text = 'i!^_^,' + Verse_Count.toString() + ',';
        //var text = 'i!^_^,' + Verse_Count.toString();

        //var text = 'C4^_^,' + Verse_Count.toString();

        var text = 'Ae^_^,' + Verse_Count.toString(); // Attendance

        for (i = 0; i < Verse.length; i++) {

           //let CNo = Verse[i].CNo;

           let Record = Verse[i].Record;

           text += ',' + Record;

        } // End of for (i = 0; i < Verse.length; i++)

        var mesg1 = 'Attendance ' + Verse_Count + ' exported';

        document.getElementById("Imp_to_Congregation4").value = text;

        document.getElementById("Mesg4").value = mesg1;

     } // End of if (Verse)

  //}
  //else {

     //myExp_Db_Display.innerHTML = 'ML 0 exported';

  //   document.getElementById("Mesg4").value = 'Attendance 0 exported';

  //} // End of if(startWith_date!='')


} // End of function Exp_All_from_Attendance()


async function Exp_from_Attendance() { // New for V12

  var Verse_Count = 0;

  var startWith_date = document.getElementById("Exp_start_date").value;

  if(startWith_date!='') {

     //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

     let Verse = await dbT2.Attendance.where('Record').startsWithIgnoreCase(startWith_date).toArray();

     Verse_Count = Verse.length;

     if (Verse) {

        //var text = 'i!^_^,' + Verse_Count.toString() + ',';
        //var text = 'i!^_^,' + Verse_Count.toString();

        //var text = 'C4^_^,' + Verse_Count.toString();

        var text = 'Ae^_^,' + Verse_Count.toString(); // Attendance

        for (i = 0; i < Verse.length; i++) {

           //let CNo = Verse[i].CNo;

           let Record = Verse[i].Record;

           text += ',' + Record;

        } // End of for (i = 0; i < Verse.length; i++)

        var mesg1 = 'Attendance ' + Verse_Count + ' exported';

        document.getElementById("Imp_to_Congregation4").value = text;

        document.getElementById("Mesg4").value = mesg1;

     } // End of if (Verse)

  }
  else {

     //myExp_Db_Display.innerHTML = 'ML 0 exported';

     document.getElementById("Mesg4").value = 'Attendance 0 exported';

  } // End of if(startWith_date!='')


} // End of function Exp_from_Attendance()


var G_ServiceDate1 = '';  // for ID_1 : 202009261 , 202009262 , 202009253 <-- ML_Date_V4()
var G_ServiceDate2 = '';  // for ID_2 : 20200926M , 20200926A , 20200925E   

var Display_ID_1 = '';
var Display_ID_2 = '';


async function NOW_Service_Record() {

   var DateCheck = ML_Date_V4();

     let Verse = await dbT2.Service_Record.get(DateCheck);

     if (Verse) {  // Exist

        G_ServiceDate1 = ML_Date_V4(); // 202009051, '3'-evening, '1'-morning, '2'-afternoon

        G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon

        Display_ID_1 = ML_Date_V4();

        Display_ID_2 = ML_Date_V2();

        document.getElementById("Service_Date").style.color = "blue";


        document.getElementById("Service_Date").value = Verse.Service_Date;

        document.getElementById("Service_Start_Time").value = Verse.Service_Start_Time;
        document.getElementById("Service_End_Time").value = Verse.Service_End_Time;
        document.getElementById("Usher").value = Verse.Usher;

        document.getElementById("Topic").value = Verse.Topic;
        document.getElementById("Hymn").value = Verse.Hymn;

        document.getElementById("Speaker").value = Verse.Speaker;
        document.getElementById("Interp").value = Verse.Interp;
        document.getElementById("Hymnal").value = Verse.Hymnal;

        document.getElementById("Service_Record_Note").value = Verse.Note;


        Bro_M = Verse.Bro_M_Note;       // Bro_M_Note
        Sis_M = Verse.Sis_M_Note;
        Bro_TrS = Verse.Bro_TrS_Note;   // Bro_TrS_Note ,   Bro_Trs -->  Bro_TrS
        Sis_TrS = Verse.Sis_TrS_Note;   // Sis_TrS_Note     Sis_Trs -->  Sis_TrS

        Show_Total();

        Change_Start_Save_Color_to_blue();

        Show_Total_Mode();  // Add on 2020.10.07

        //Roll_Call_V3('S',Display_ID_2); // <-- for show history attendance

        Roll_Call_V2('R');


     }
     else {   // Not Exist

        document.getElementById("Service_Date").value = '';

        //document.getElementById("Service_Date").style.color = "blue";

        Clear_Service_Record();

        Reset_All();  

        Show_Total_Mode();  // Add on 2020.10.07

        //Roll_Call_V3('S',DateCheck); // <-- for show history attendance

        Roll_Call_V2('R');


     } // End of if (Verse)


} // End of function NOW_Service_Record()



async function Start_Service_Record() {

   var DateCheck = ML_Date_V4();

     let Verse = await dbT2.Service_Record.get(DateCheck);

     if (Verse) {  // Exist

        //G_ServiceDate1 = ML_Date_V4(); // 202009051, '3'-evening, '1'-morning, '2'-afternoon

        //G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon

        G_ServiceDate1 = ML_Date_V4(); // 202009051, '4'-evening, '1'-morning, '2'-afternoon,  '3'-late afternoon

        G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon,  'A2'-afternoon


        Display_ID_1 = ML_Date_V4();

        Display_ID_2 = ML_Date_V2();

        document.getElementById("Service_Date").style.color = "blue";


        document.getElementById("Service_Date").value = Verse.Service_Date;

        document.getElementById("Service_Start_Time").value = Verse.Service_Start_Time;
        document.getElementById("Service_End_Time").value = Verse.Service_End_Time;
        document.getElementById("Usher").value = Verse.Usher;

        document.getElementById("Topic").value = Verse.Topic;
        document.getElementById("Hymn").value = Verse.Hymn;

        document.getElementById("Speaker").value = Verse.Speaker;
        document.getElementById("Interp").value = Verse.Interp;
        document.getElementById("Hymnal").value = Verse.Hymnal;

        document.getElementById("Service_Record_Note").value = Verse.Note;

        Bro_M = Verse.Bro_M_Note;       // Bro_M_Note
        Sis_M = Verse.Sis_M_Note;
        Bro_TrS = Verse.Bro_TrS_Note;   // Bro_TrS_Note ,   Bro_Trs -->  Bro_TrS
        Sis_TrS = Verse.Sis_TrS_Note;   // Sis_TrS_Note     Sis_Trs -->  Sis_TrS

        Show_Total();

        Change_Start_Save_Color_to_blue();


        //Show_Service_Record(G_ServiceDate2);

     }
     else {   // Not Exist

        var DateStr = ML_Date_V3(); // --> 26/09/2020 Saturday Afternoon

        document.getElementById("Send email").innerHTML = 'Send email';

        document.getElementById("Service_Date").value = DateStr;

        document.getElementById("Service_Date").style.color = "blue";

        Change_Start_Save_Color_to_blue();

        G_ServiceDate1 = ML_Date_V4(); // 202009051, '3'-evening, '1'-morning, '2'-afternoon

        G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon

        Display_ID_1 = ML_Date_V4();

        Display_ID_2 = ML_Date_V2();

        Clear_Service_Record();

        Reset_All();        

        add_Service_Record();

     }



   //var ServiceDate = document.getElementById("Service_Date").value;

   //var DateStr = ML_Date_V3(); // --> 2020/09/26 Saturday Afternoon

   //if (ServiceDate == '' || ServiceDate != DateStr) {

      //document.getElementById("Send email").innerHTML = 'Send email';

      //document.getElementById("Service_Date").value = DateStr;

      //Change_Start_Save_Color_to_blue();

      //Clear_Service_Record();

      //G_ServiceDate1 = ML_Date_V4(); // 202009051, '3'-evening, '1'-morning, '2'-afternoon

      //G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon

      //Display_ID_1 = ML_Date_V4();

      //Display_ID_2 = ML_Date_V2();

      //Reset_All();

      //add_Service_Record();

   //}

} // End of function Start_Service_Record()


function Start_Service_Record_old() {

   var ServiceDate = document.getElementById("Service_Date").value;

   var DateStr = ML_Date_V3(); // --> 2020/09/26 Saturday Afternoon

   if (ServiceDate == '' || ServiceDate != DateStr) {

      document.getElementById("Send email").innerHTML = 'Send email';

      document.getElementById("Service_Date").value = DateStr;

      Change_Start_Save_Color_to_blue();

      //Clear_Service_Record();

      G_ServiceDate1 = ML_Date_V4(); // 202009051, '3'-evening, '1'-morning, '2'-afternoon

      G_ServiceDate2 = ML_Date_V2(); // 20200905M, 'E'-evening, 'M'-morning, 'A'-afternoon

      Display_ID_1 = ML_Date_V4();

      Display_ID_2 = ML_Date_V2();

      //Reset_All();

      add_Service_Record();

   }

} // End of function Start_Service_Record_old()

function Clear_Service_Record() {

   document.getElementById("Service_Start_Time").value = '';
   document.getElementById("Service_End_Time").value = '';
   document.getElementById("Usher").value = '';

   document.getElementById("Topic").value = '';
   document.getElementById("Hymn").value = '';
   document.getElementById("Speaker").value = '';
   document.getElementById("Interp").value = '';
   document.getElementById("Hymnal").value = '';

   document.getElementById("Service_Record_Note").value = '';

} // End of function Clear_Service_Record()

function Clear_Service_Record2() {  // for Delete & Search with no result

   document.getElementById("Service_Start_Time").value = '';
   document.getElementById("Service_End_Time").value = '';
   document.getElementById("Usher").value = '';

   document.getElementById("Topic").value = '';
   document.getElementById("Hymn").value = '';
   document.getElementById("Speaker").value = '';
   document.getElementById("Interp").value = '';
   document.getElementById("Hymnal").value = '';

   document.getElementById("Service_Record_Note").value = '';

   document.getElementById("Service_Date").value = '';

} // End of function Clear_Service_Record2()


async function Exp_and_Email_Attendance2() { // exp attendance & service record

  var Verse_Count = 0;

  //var startWith_date = document.getElementById("Exp_n_Email_start_date").value; // Exp_start_date

  var text = '';

  var DateStr = Display_ID_2; // Exp_start_date , '20200920E'


  if(DateStr!='') {     // exp attedance for committee

     var AT_Count = 0;
  
     var AT_Count_note = 0;

     text += 'Total' + '%20';  // 'Space'

     let Verse_5 = await dbT2.Service_Record.where('ID_2').equals(DateStr).toArray();

     if (Verse_5) {

           let bro_m_note = Number(Verse_5[0].Bro_M_Note); 
           let sis_m_note = Number(Verse_5[0].Sis_M_Note); 
           let bro_trs_note = Number(Verse_5[0].Bro_TrS_Note);
           let sis_trs_note = Number(Verse_5[0].Sis_TrS_Note);

           AT_Count_note = bro_m_note + sis_m_note + bro_trs_note + sis_trs_note;

     } // End of if (Verse_5)

     let Verse_4 = await dbT2.Roll.toArray();

     if (Verse_4) {

        //text += 'Total' + '%20';  // 'Space'

        //var AT_Count = 0;

        for (var i = 0; i < Verse_4.length ; i++) {

           var arg1 = Verse_4[i].CNo;

           var arg2 = Verse_4[i].Member;

           var arg3 = Verse_4[i].Gender;

           var Result = 'n';

           Result = await Check_Attendance5(arg1,arg2,arg3);

           if (Result == 'y') {

              AT_Count = AT_Count + 1;

           }


        } // End of for (var i = 0; i < Verse_4.length ; i++)


        text += AT_Count + AT_Count_note + '%20';


     } // End of if (Verse_4)




     let Verse_3 = await dbT2.Roll.toArray();

     if (Verse_3) { 

        text += 'Name Attendance:' + '%0D';  // ',\n"'

        for (var i = 0; i < Verse_3.length ; i++) {

        //for (var i = 0; i < 100 ; i++) {

           // arg1: CNo, arg2: Member, arg3:Gender

           var arg1 = Verse_3[i].CNo;

           var arg2 = Verse_3[i].Member;

           var arg3 = Verse_3[i].Gender;

           var Result = 'n';

           //Result = await Check_Attendance3(arg1,arg2,arg3);

           Result = await Check_Attendance5(arg1,arg2,arg3);

           var Name_Str = Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name;

           if (Result == 'y') {

              text += Name_Str + ' | ';

              //text += Name_Str + '@' + '%0D';

              //text += Name_Str + '%0D';

           }
           else {

              //text += Name_Str + '%0D';

           }

        } // End of for (var i = 0; i < Verse_3.length ; i++)

        
        //text += '%0D' + '%0D';   // carriage return	%0D


     } // End of if (Verse_3)

  } // End of if(DateStr!='')


  // -------------------------------------------------------------------------------------------------


  var DateStr2 = Display_ID_2; // Exp_start_date , '20200920E'


  if(DateStr2!='') {     // exp service record for App

     //let Verse = await dbT2.SermonNote.where('Name').startsWithIgnoreCase(startWith_date).toArray();

     let Verse = await dbT2.Service_Record.where('ID_2').equals(DateStr2).toArray();

     var Verse_Count = 0;

     Verse_Count = Verse.length;

     if (Verse) {

        text += 'Note:' + Verse[0].Note + '|' + '%20' + '%0D';

        text += 'sr^_^|' + Verse_Count.toString();  // change seprator to "|" ,  for Service_Record

        for (i = 0; i < Verse.length; i++) {

           let id_1 = Verse[i].ID_1;
           let id_2 = Verse[i].ID_2; 

           let service_date = Verse[i].Service_Date;

           let service_start_time = Verse[i].Service_Start_Time; 
           let service_end_time = Verse[i].Service_End_Time; 
           let usher = Verse[i].Usher; 

           let topic = Verse[i].Topic;
           let hymn = Verse[i].Hymn; 

           let speaker = Verse[i].Speaker; 
           let interp = Verse[i].Interp; 
           let hymnal = Verse[i].Hymnal;

           let note = Verse[i].Note; 

           let bro_m_note = Verse[i].Bro_M_Note; 
           let sis_m_note = Verse[i].Sis_M_Note; 
           let bro_trs_note = Verse[i].Bro_TrS_Note;
           let sis_trs_note = Verse[i].Sis_TrS_Note;

           // Encrypt Content then Exp

           var Key_input = '2020Chapter03Note15'; // for Encrypt and Decrypt Exp & Imp Chap Note

           var encryptedUsher = CryptoJS.AES.encrypt(usher, Key_input);

           var encryptedTopic = CryptoJS.AES.encrypt(topic, Key_input);

           var encryptedHymn = CryptoJS.AES.encrypt(hymn, Key_input);

           var encryptedSpeaker = CryptoJS.AES.encrypt(speaker, Key_input);

           var encryptedInterp = CryptoJS.AES.encrypt(interp, Key_input);

           var encryptedHymnal = CryptoJS.AES.encrypt(hymnal, Key_input);

           var encryptedNote = CryptoJS.AES.encrypt(note, Key_input);

           //text += '|' + name + '|' + speaker + '|' + topic + '|' + encryptedContent;  // change seprator to "|"

           //text += '|' + id_1 + '|' + id_2 + '|' + topic + '|' + service_date + '|' + service_start_time + '|' + service_end_time + '|' + usher + '|' + topic + '|' + hymn + '|' + speaker + '|' + interp + '|' + hymnal + '|' + encryptedNote + '|' + bro_m_note + '|' + sis_m_note + '|' + bro_trs_note + '|' + sis_trs_note;  // change seprator to "|"

           //text += '|' + id_1 + '|' + id_2 + '|' + service_date + '|' + service_start_time + '|' + service_end_time + '|' + usher + '|' + topic + '|' + hymn + '|' + speaker + '|' + interp + '|' + hymnal + '|' + encryptedNote + '|' + bro_m_note + '|' + sis_m_note + '|' + bro_trs_note + '|' + sis_trs_note;  // change seprator to "|"


           //text += '|' + id_1 + '|' + id_2 + '|' + service_date + '|' + service_start_time + '|' + service_end_time + '|' + encryptedUsher + '|' + encryptedTopic + '|' + encryptedHymn + '|' + encryptedSpeaker + '|' + encryptedInterp + '|' + encryptedHymnal + '|' + encryptedNote + '|' + bro_m_note + '|' + sis_m_note + '|' + bro_trs_note + '|' + sis_trs_note;  // change seprator to "|"


           text += '|' + id_1 + '|' + id_2 + '|' + service_date + '|' + service_start_time + '|' + service_end_time + '|' + encryptedUsher + '|' + topic + '|' + hymn + '|' + speaker + '|' + interp + '|' + hymnal + '|' + encryptedNote + '|' + bro_m_note + '|' + sis_m_note + '|' + bro_trs_note + '|' + sis_trs_note;  // change seprator to "|"



        } // End of for (i = 0; i < Verse.length; i++)

        //text += '%0D' + '%0D';   // carriage return	%0D

     } // End of if (Verse)


  } // End of if(DateStr2!='')


  // ------------------------------------------------------------------------------------------------- 
 

  var startWith_date = Display_ID_2; // Exp_start_date , '20200920E'


  if(startWith_date!='') {   // exp attendance for App

     //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

     let Verse = await dbT2.Attendance.where('Record').startsWithIgnoreCase(startWith_date).toArray();

     Verse_Count = Verse.length;

     if (Verse) {

        //var text = 'i!^_^,' + Verse_Count.toString() + ',';
        //var text = 'i!^_^,' + Verse_Count.toString();

        //var text = 'C4^_^,' + Verse_Count.toString();

        //var text = 'Ae^_^,' + Verse_Count.toString(); // Attendance

        //var text = 'AE^_^|' + Verse_Count.toString(); // Attendance , use '|' as seperator
        //                                              // AE^_^ for Attendance exp and Email


        text += '%0D' + '%0D';   // carriage return	%0D

        text += 'AE^_^|' + Verse_Count.toString(); // Attendance , use '|' as seperator
                                                      // AE^_^ for Attendance exp and Email


        for (i = 0; i < Verse.length; i++) {

           //let CNo = Verse[i].CNo;

           let Record = Verse[i].Record;

           //text += ',' + Record;


           text += '|' + Record; // use '|' as seperator  

           //text += '%0D' + Record; // use '|' as seperator  // for test


        } // End of for (i = 0; i < Verse.length; i++)

        var mesg1 = 'Attendance ' + Verse_Count + ' exported';

        //document.getElementById("Imp_to_Congregation4").value = text;

        //document.getElementById("Mesg4").value = mesg1;

        document.getElementById("Send_Attendance_Message").innerHTML = mesg1;

        // -- Email

        var name1 = "truejesuschurchbrisbane"; // brisbane
        var address1 = "gmail.com"; // tjc.org.au

        var name2 = "sc424000"; // 
        var address2 = "yahoo.com.tw"; // 

        var name3 = "chang424000"; // 
        var address3 = "gmail.com"; // 

        var link = "Send email";
        var subject = startWith_date + "%20Attendance%20Record";

        var body = text + '%0D';   // carriage return	%0D
        //var body = 'test';  // for test

        //var email_text = '<a href=mailto:' + name + '@' + address + '?subject=' + subject + '&body=' + body + '>' + link + '</a>';

        // <a href="mailto:name1@mail.com,name2@mail.com">Send mail</a>

        // <a href="mailto:name1@rapidtables.com?cc=name2@rapidtables.com&bcc=name3@rapidtables.com
        // &subject=The%20subject%20of%20the%20email
        // &body=The%20body%20of%20the%20email">
        // Send mail with cc, bcc, subject and body</a>


        //var email_text = '<a href=\"mailto:' + name1 + '@' + address1 + '?cc=' + name2 + '@' + address2 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';

        //<a href="javascript:;" onclick="Show_Name('Dn Ko 陳恩光');">Dn Ko 陳恩光</a>

        var email_text = '<a href=\"mailto:' + name1 + '@' + address1 + '?cc=' + name2 + '@' + address2 + ',' + name3 + '@' + address3 + '&subject=' + subject + '&body=' + body + '\" onclick=\"Change_Start_Save_Color_to_black();\">' + link + '</a>';


        //var email_text = '<a href=\"mailto:' + name1 + '@' + address1 + '?cc=' + name2 + '@' + address2 + ',' + name3 + '@' + address3 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';


        //if( body == 'AE^_^|0%0D') {  // Attendance 0 exported

        if (mesg1 == 'Attendance 0 exported') {

           //document.getElementById("Send_Attendance2").innerHTML = '';

           //document.getElementById("Send email").innerHTML = 'Send email'; // Mark on 2020.09.29

           document.getElementById("Send email").innerHTML = email_text;

        }
        else {

           //document.getElementById("Send_Attendance2").innerHTML = email_text;

           document.getElementById("Send email").innerHTML = email_text;

        }


        //document.getElementById("Send_Attendance").value = email_text;

        // End of -- Email        

     } // End of if (Verse)

  }
  else {

     //myExp_Db_Display.innerHTML = 'ML 0 exported';

     //document.getElementById("Mesg4").value = 'Attendance 0 exported';

     //document.getElementById("Send_Attendance2").innerHTML = "";

     document.getElementById("Send email").innerHTML = 'Send email';

     //document.getElementById("Send_Attendance_Message").innerHTML = 'Attendance 0 exported';

  } // End of if(startWith_date!='')



} // End of function Exp_and_Email_Attendance2()


async function Exp_and_Email_Attendance() { // New for V12

  var Verse_Count = 0;

  var startWith_date = document.getElementById("Exp_n_Email_start_date").value; // Exp_start_date

  if(startWith_date!='') {

     //let Verse = await dbT2.books.where('date').startsWithIgnoreCase(startWith_date).toArray();

     let Verse = await dbT2.Attendance.where('Record').startsWithIgnoreCase(startWith_date).toArray();

     Verse_Count = Verse.length;

     if (Verse) {

        //var text = 'i!^_^,' + Verse_Count.toString() + ',';
        //var text = 'i!^_^,' + Verse_Count.toString();

        //var text = 'C4^_^,' + Verse_Count.toString();

        //var text = 'Ae^_^,' + Verse_Count.toString(); // Attendance

        var text = 'AE^_^|' + Verse_Count.toString(); // Attendance , use '|' as seperator
                                                      // AE^_^ for Attendance exp and Email


        for (i = 0; i < Verse.length; i++) {

           //let CNo = Verse[i].CNo;

           let Record = Verse[i].Record;

           //text += ',' + Record;

           text += '|' + Record; // use '|' as seperator

        } // End of for (i = 0; i < Verse.length; i++)

        var mesg1 = 'Attendance ' + Verse_Count + ' exported';

        //document.getElementById("Imp_to_Congregation4").value = text;

        //document.getElementById("Mesg4").value = mesg1;

        document.getElementById("Send_Attendance_Message").innerHTML = mesg1;

        // -- Email

        var name1 = "brisbane"; // 
        var address1 = "tjc.org.au"; // 

        var name2 = "sc424000"; // 
        var address2 = "yahoo.com.tw"; // 

        var name3 = "chang424000"; // 
        var address3 = "gmail.com"; // 

        var link = "Send email";
        var subject = startWith_date + "%20Attendance%20Record";

        var body = text + '%0D';   // carriage return	%0D
        //var body = 'test';  // for test

        //var email_text = '<a href=mailto:' + name + '@' + address + '?subject=' + subject + '&body=' + body + '>' + link + '</a>';

        // <a href="mailto:name1@mail.com,name2@mail.com">Send mail</a>

        // <a href="mailto:name1@rapidtables.com?cc=name2@rapidtables.com&bcc=name3@rapidtables.com
        // &subject=The%20subject%20of%20the%20email
        // &body=The%20body%20of%20the%20email">
        // Send mail with cc, bcc, subject and body</a>


        //var email_text = '<a href=\"mailto:' + name1 + '@' + address1 + '?cc=' + name2 + '@' + address2 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';


        var email_text = '<a href=\"mailto:' + name1 + '@' + address1 + '?cc=' + name2 + '@' + address2 + ',' + name3 + '@' + address3 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';


        //if( body == 'AE^_^|0%0D') {  // Attendance 0 exported

        if (mesg1 == 'Attendance 0 exported') {

           document.getElementById("Send_Attendance2").innerHTML = '';

        }
        else {

           document.getElementById("Send_Attendance2").innerHTML = email_text;

        }


        //document.getElementById("Send_Attendance").value = email_text;

        // End of -- Email        

     } // End of if (Verse)

  }
  else {

     //myExp_Db_Display.innerHTML = 'ML 0 exported';

     //document.getElementById("Mesg4").value = 'Attendance 0 exported';

     document.getElementById("Send_Attendance2").innerHTML = "";

     document.getElementById("Send_Attendance_Message").innerHTML = 'Attendance 0 exported';

  } // End of if(startWith_date!='')


} // End of function Exp_and_Email_Attendance()





async function Exp_from_Congregation4() { // New for V8

  //let Verse = await dbT2.books.orderBy('date').reverse().limit(10).toArray(); // for test
  //let Verse_Count = 10;  // for test

  let Verse = await dbT2.Congregation4.toArray();

  var Verse_Count = Verse.length;

  if (Verse) {

     //var text = 'C4^_^,' + Verse_Count.toString() + ',';
     var text = 'C4^_^,' + Verse_Count.toString();

     for (i = 0; i < Verse.length; i++) {

        let CNo = Verse[i].CNo;
        let F_Name = Verse[i].F_Name;
        let L_Name = Verse[i].L_Name;
        let Member = Verse[i].Member;
        let Gender = Verse[i].Gender;

        let H_No = Verse[i].H_No;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

        let C_F_Name = Verse[i].C_F_Name; // 姓
        let C_L_Name = Verse[i].C_L_Name; // 名字
        let F_Order = Verse[i].F_Order; // 1 for Householder

        //let Tel = Verse[i].Tel;  // 

        if (!Verse[i].Tel || Verse[i].Tel==' ') 
           var Tel = 'no value';
        else
           var Tel = Verse[i].Tel;

        //let Mob = Verse[i].Mob;

        if (!Verse[i].Mob || Verse[i].Mob==' ') 
           var Mob = 'no value';
        else
           var Mob = Verse[i].Mob;


        text += ',' + CNo + ',' + F_Name + ',' + L_Name + ',' + Member + ',' + Gender + ',' + H_No + ',' + C_F_Name + ',' + C_L_Name + ',' + F_Order + ',' + Tel + ',' + Mob;

     } // End of for (i = 0; i < Verse.length; i++)

     var mesg1 = 'Congregation4 ' + Verse_Count + ' exported';

     //Exp_to_books_Test2Db.value = mesg1;

     //myExp_Db_Display.innerHTML = text;
     //Exp_to_books_Test2Db.value = text;  // Imp_to_books_Test2Db
     //Imp_to_books_Test2Db.value = text;  // Imp_to_books_Test2Db

     document.getElementById("Imp_to_Congregation4").value = text;

     document.getElementById("Mesg4").value = mesg1;

     //copyFunction5(mesg1);

     //myExp_Db_Display.innerHTML = "";


  } // End of if (Verse)

} // End of function Exp_from_Congregation4()


async function Exp2_from_Congregation4() { // New for V8 , do not exp Tel & Mob

  //let Verse = await dbT2.books.orderBy('date').reverse().limit(10).toArray(); // for test
  //let Verse_Count = 10;  // for test

  let Verse = await dbT2.Congregation4.toArray();

  var Verse_Count = Verse.length;

  if (Verse) {

     //var text = 'C4^_^,' + Verse_Count.toString() + ',';
     var text = 'C4^_^,' + Verse_Count.toString();

     for (i = 0; i < Verse.length; i++) {

        let CNo = Verse[i].CNo;
        let F_Name = Verse[i].F_Name;
        let L_Name = Verse[i].L_Name;
        let Member = Verse[i].Member;
        let Gender = Verse[i].Gender;

        let H_No = Verse[i].H_No;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

        let C_F_Name = Verse[i].C_F_Name; // 姓
        let C_L_Name = Verse[i].C_L_Name; // 名字
        let F_Order = Verse[i].F_Order; // 1 for Householder

        //let Tel = Verse[i].Tel;  // 

        //if (!Verse[i].Tel || Verse[i].Tel==' ') 
           var Tel = 'no value';
        //else
        //   var Tel = Verse[i].Tel;

        //let Mob = Verse[i].Mob;

        //if (!Verse[i].Mob || Verse[i].Mob==' ') 
           var Mob = 'no value';
        //else
        //   var Mob = Verse[i].Mob;


        text += ',' + CNo + ',' + F_Name + ',' + L_Name + ',' + Member + ',' + Gender + ',' + H_No + ',' + C_F_Name + ',' + C_L_Name + ',' + F_Order + ',' + Tel + ',' + Mob;

     } // End of for (i = 0; i < Verse.length; i++)

     var mesg1 = 'Congregation4 ' + Verse_Count + ' exported';

     //Exp_to_books_Test2Db.value = mesg1;

     //myExp_Db_Display.innerHTML = text;
     //Exp_to_books_Test2Db.value = text;  // Imp_to_books_Test2Db
     //Imp_to_books_Test2Db.value = text;  // Imp_to_books_Test2Db

     document.getElementById("Imp_to_Congregation4").value = text;

     document.getElementById("Mesg4").value = mesg1;

     //copyFunction5(mesg1);

     //myExp_Db_Display.innerHTML = "";


  } // End of if (Verse)

} // End of function Exp2_from_Congregation4()


async function Exp_CNo_Between_by_email_from_Congregation4() { // New for V8 


  var start_CNo_tmp = document.getElementById("Exp_CNo_start").value;

  var end_CNo_tmp = document.getElementById("Exp_CNo_end").value;

  
  var start_CNo = Number(start_CNo_tmp);

  var end_CNo = Number(end_CNo_tmp);


  let Verse = await dbT2.Congregation4.where('CNo').between(start_CNo, end_CNo, true, true).toArray();


  var Verse_Count = Verse.length;

  if (Verse) {

     var text = 'C4^_^,' + Verse_Count.toString();

     for (i = 0; i < Verse.length; i++) {

        let CNo = Verse[i].CNo;
        let F_Name = Verse[i].F_Name;
        let L_Name = Verse[i].L_Name;
        let Member = Verse[i].Member;
        let Gender = Verse[i].Gender;

        let H_No = Verse[i].H_No;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

        let C_F_Name = Verse[i].C_F_Name; // 姓
        let C_L_Name = Verse[i].C_L_Name; // 名字
        let F_Order = Verse[i].F_Order; // 1 for Householder


        //let Tel = Verse[i].Tel;  // 

        if (!Verse[i].Tel || Verse[i].Tel==' ') 
           var Tel = 'no value';
        else
           var Tel = Verse[i].Tel;

        //let Mob = Verse[i].Mob;

        if (!Verse[i].Mob || Verse[i].Mob==' ') 
           var Mob = 'no value';
        else
           var Mob = Verse[i].Mob;


        text += ',' + CNo + ',' + F_Name + ',' + L_Name + ',' + Member + ',' + Gender + ',' + H_No + ',' + C_F_Name + ',' + C_L_Name + ',' + F_Order + ',' + Tel + ',' + Mob;

     } // End of for (i = 0; i < Verse.length; i++)


        // -- Email

        var name1 = "truejesuschurchbrisbane"; // truejesuschurchbrisbane
        var address1 = "gmail.com"; // gmail.com

        var name2 = "sc424000"; // 
        var address2 = "yahoo.com.tw"; // 

        var name3 = "chang424000"; // 
        var address3 = "gmail.com"; // 

        var link = "Send email";
        var subject = start_CNo_tmp + "%20to%20" + end_CNo + "%20Congregation4%20Exp";

        var body = text + '%0D';   // carriage return	%0D


        var email_text = '<a href=\"mailto:' + name2 + '@' + address2 + '?cc=' + name3 + '@' + address3 + ',' + name1 + '@' + address1 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';


     var mesg1 = 'Congregation4 ' + Verse_Count + ' exported';


     document.getElementById("Send_Congregation4_Exp").innerHTML = email_text;

     document.getElementById("Mesg4").value = mesg1;


  } // End of if (Verse)



} // End of function Exp_CNo_Between_by_email_from_Congregation4()





async function Exp_CNo_Between_by_email_without_Tel_and_Mob_from_Congregation4() { // New for V8 , do not exp Tel & Mob


  var start_CNo_tmp = document.getElementById("Exp_CNo_start").value;

  var end_CNo_tmp = document.getElementById("Exp_CNo_end").value;

  
  var start_CNo = Number(start_CNo_tmp);

  var end_CNo = Number(end_CNo_tmp);



  //let Verse = await dbT2.Attendance.where('Record').between(start_date, end_date, true, true).reverse().toArray();


  let Verse = await dbT2.Congregation4.where('CNo').between(start_CNo, end_CNo, true, true).toArray();

  //let Verse = await dbT2.Congregation4.where('CNo').between(275, 279, true, true).toArray();



  //let Verse = await dbT2.Congregation4.toArray();

  var Verse_Count = Verse.length;

  if (Verse) {

     var text = 'C4^_^,' + Verse_Count.toString();

     for (i = 0; i < Verse.length; i++) {

        let CNo = Verse[i].CNo;
        let F_Name = Verse[i].F_Name;
        let L_Name = Verse[i].L_Name;
        let Member = Verse[i].Member;
        let Gender = Verse[i].Gender;

        let H_No = Verse[i].H_No;      // Format : HouseholderNo_BirthOrder Ex: 1_1, 1_2

        let C_F_Name = Verse[i].C_F_Name; // 姓
        let C_L_Name = Verse[i].C_L_Name; // 名字
        let F_Order = Verse[i].F_Order; // 1 for Householder


           var Tel = 'no value';

           var Mob = 'no value';


        text += ',' + CNo + ',' + F_Name + ',' + L_Name + ',' + Member + ',' + Gender + ',' + H_No + ',' + C_F_Name + ',' + C_L_Name + ',' + F_Order + ',' + Tel + ',' + Mob;

     } // End of for (i = 0; i < Verse.length; i++)


        // -- Email

        var name1 = "truejesuschurchbrisbane"; // truejesuschurchbrisbane
        var address1 = "gmail.com"; // gmail.com

        var name2 = "sc424000"; // 
        var address2 = "yahoo.com.tw"; // 

        var name3 = "chang424000"; // 
        var address3 = "gmail.com"; // 

        var link = "Send email";
        var subject = start_CNo_tmp + "%20to%20" + end_CNo + "%20Congregation4%20Exp";

        var body = text + '%0D';   // carriage return	%0D


        var email_text = '<a href=\"mailto:' + name2 + '@' + address2 + '?cc=' + name3 + '@' + address3 + ',' + name1 + '@' + address1 + '&subject=' + subject + '&body=' + body + '\">' + link + '</a>';



     var mesg1 = 'Congregation4 ' + Verse_Count + ' exported';


     //document.getElementById("Imp_to_Congregation4").value = text;


     document.getElementById("Send_Congregation4_Exp").innerHTML = email_text;

     document.getElementById("Mesg4").value = mesg1;


  } // End of if (Verse)


} // End of function Exp_CNo_Between_by_email_without_Tel_and_Mob_from_Congregation4()




function Clear_Imp_to_Congregation4() { 

   document.getElementById("Imp_to_Congregation4").value = '';
   document.getElementById("Mesg4").value = '';

} // End of function Clear_Imp_to_Congregation4()


function Clear_Imp_to_Comparing_Db_1() { 

   document.getElementById("Imp_to_Comparing_Db_1").value = '';
   document.getElementById("Mesg4_Imp_to_Comparing_Db_1").value = '';

} // End of function Clear_Imp_to_Comparing_Db_1()


function Clear_Imp_to_Comparing_Db_2() { 

   document.getElementById("Imp_to_Comparing_Db_2").value = '';
   document.getElementById("Mesg4_Imp_to_Comparing_Db_2").value = '';

} // End of function Clear_Imp_to_Comparing_Db_2()


async function Imp_to_Comparing_Db_1() {

   var Imp_Word = document.getElementById("Imp_to_Comparing_Db_1").value;

   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='AE^_^') { // For Attendance by Email import
                                                                             // Do pre-check
      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");



      // Delete Old Data

      dbT2.Comparing_Db_1.clear();



      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        //var Record = Imp_Tmp[1*i+1];

        var CNo = Imp_Tmp[1*i+1];


        //let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        let Verse = await dbT2.Comparing_Db_1.get(CNo);  // Check if data exist already

        if (Verse) { // data exist already

           // Do Nothing

        }
        else {  // add 

           try {

             dbT2.Comparing_Db_1.add({CNo });  // <--- *** // 20200905E_M_S_83

             add_no = add_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4_Imp_to_Comparing_Db_1").value = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Attendance by Email import



} // End of function Imp_to_Comparing_Db_1()



async function Imp_to_Comparing_Db_2() {

   var Imp_Word = document.getElementById("Imp_to_Comparing_Db_2").value;

   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='AE^_^') { // For Attendance by Email import
                                                                             // Do pre-check
      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");


      // Delete Old Data

      dbT2.Comparing_Db_2.clear();


      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        //var Record = Imp_Tmp[1*i+1];

        var CNo = Imp_Tmp[1*i+1];


        //let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        let Verse = await dbT2.Comparing_Db_2.get(CNo);  // Check if data exist already

        if (Verse) { // data exist already

           // Do Nothing

        }
        else {  // add 

           try {

             dbT2.Comparing_Db_2.add({CNo });  // <--- *** // 20200905E_M_S_83

             add_no = add_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4_Imp_to_Comparing_Db_2").value = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Attendance by Email import



} // End of function Imp_to_Comparing_Db_2()


async function Comparing_Db_1_and_Db_2() {


  let Verse_3 = await dbT2.Roll.toArray();


   document.getElementById("content2").style.visibility='visible'; // hide
   document.getElementById("content2").style.height = "98%";

   document.getElementById("content2_C").style.visibility='hidden'; // hide
   document.getElementById("content2_C").style.height = "0%";


  var Arg4 = document.getElementById("Comparing_Db_1_and_Db_2_DateStr").value; // Comparing Datas' DateStr


  //if (Read_for_Roll_Call == 'N') {

     Prepare_for_Roll_Call();

  //}


  if (Verse_3) {  // Fill data


     var Rnum = 3001;  // Rnum
     var Rvers = 4001;  // EName
     var CName = 5001;  // CName


     for (var i = 0; i < Verse_3.length ; i++) {

        var arg1 = Verse_3[i].CNo;

        var arg2 = Verse_3[i].Member;

        var arg3 = Verse_3[i].Gender;

        var Result_Db_1 = 'n';

        var Result_Db_2 = 'n';


        Result_Db_1 = await Check_Db_1(arg1,arg2,arg3,Arg4);

        Result_Db_2 = await Check_Db_2(arg1,arg2,arg3,Arg4);


        if (Result_Db_1 == 'y' && Result_Db_2 == 'n') {

           document.getElementById(Rvers).style.color = "blue";

           var Name_Str = Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name + ' ';

           if (Verse_3[i].Member == 'T') {
 
              Name_Str = '*' + Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name + ' ';

           }

           var Name_Str2 =  Verse_3[i].C_F_Name + Verse_3[i].C_L_Name;

           var H_No_tmp = Verse_3[i].H_No;        // 1_2
           var H_No_tmp2 = H_No_tmp.split("_");   
           var H_No_tmp3 = H_No_tmp2[1];          // 2

           if (H_No_tmp3 == '1') {

              Name_Str = '<b><u>' + Name_Str + ' </u></b>';

              Name_Str2 =  '<b><u>' + Name_Str2 + ' </u></b>';

           }

           var Check_Str = '';


           document.getElementById(Rnum++).innerHTML = Check_Str;

           document.getElementById(Rvers++).innerHTML =  Name_Str;

           document.getElementById(CName++).innerHTML =  Name_Str2;


        }  // End of if (Result_Db_1 == 'y' && Result_Db_2 == 'n')



        if (Result_Db_1 == 'n' && Result_Db_2 == 'y') {

           document.getElementById(Rvers).style.color = "blue";

           var Name_Str = Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name + ' ';

           if (Verse_3[i].Member == 'T') {
 
              Name_Str = '*' + Verse_3[i].F_Name + ' ' + Verse_3[i].L_Name + ' ';

           }

           var Name_Str2 =  Verse_3[i].C_F_Name + Verse_3[i].C_L_Name;

           var H_No_tmp = Verse_3[i].H_No;        // 1_2
           var H_No_tmp2 = H_No_tmp.split("_");   
           var H_No_tmp3 = H_No_tmp2[1];          // 2

           if (H_No_tmp3 == '1') {

              Name_Str = '<b><u>' + Name_Str + ' </u></b>';

              Name_Str2 =  '<b><u>' + Name_Str2 + ' </u></b>';

           }

           var Check_Str = '';


           document.getElementById(Rnum++).innerHTML = Check_Str;

           document.getElementById(Rvers++).innerHTML =  Name_Str;

           document.getElementById(CName++).innerHTML =  Name_Str2;


        }  // End of if (Result_Db_1 == 'n' && Result_Db_2 == 'y')



     } // End of for (var i = 0; i < Verse_3.length ; i++)


     //var Rnum = 3001;  // Rnum
     //var Rvers = 4001;  // EName
     //var CName = 5001;  // CName


     if (Rvers == 4001) {   

        document.getElementById(Rvers++).innerHTML =  'No Difference';
 
     }


  } // End of if (Verse_3)


} // End of function Comparing_Db_1_and_Db_2()


async function Imp_to_Attendance_1() { // for Download Attendance from other device 
                                     // and then imp to Attendance, Add to

   //Download_n_Imp_Attendance_Records_Add_Str = event_tmp3; // attendance records for imp

   var Imp_Word = Download_n_Imp_Attendance_Records_Add_Str;

   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='AE^_^') {    

      //Split String "str" into Array "res"
      // AE^_^|12|20210503E_M_B_275|20210503E_M_B_279|20210503E_M_B_45
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        var Record = Imp_Tmp[1*i+1];

        let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        if (Verse) { // data exist already, so update

           //dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

           //dbT2.Attendance.update(CNo, { F_Name: F_Name, L_Name: L_Name, Member: Member, Gender: Gender, H_No: H_No, C_F_Name: C_F_Name, C_L_Name: C_L_Name, F_Order: F_Order, Tel: Tel, Mob: Mob });

           //update_no = update_no + 1;

           // Do Nothing

        }
        else {  // add 

           try {

             //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             //dbT2.Attendance.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             dbT2.Attendance.add({Record });  // <--- *** // 20200905E_M_S_83

             add_no = add_no + 1;

             //imp_successed_no = imp_successed_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Download Attendance Succeed. Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      //document.getElementById("Download_Attendance_Mesg4").innerHTML = imp_mesg;

      alert(imp_mesg);

      Show_Total();
      Roll_Call_V2('R');


   }  // End of if(Imp_Word!=''...// For Attendance download by other device



} // End of function Imp_to_Attendance_1()


async function Imp_to_Congregation4() {  // New for V8

   //var Imp_Word=document.Imp_to_books_Test2Db.value;

   var Imp_Word = document.getElementById("Imp_to_Congregation4").value;

   // ---------------------------------------------------------------------

   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='sr^_^') { // For Service_Record by Email import
                                                                             // Do pre-check
      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        //var CNo = Number(Imp_Tmp[11*i+1]);

        var ID_1_tmp = Imp_Tmp[16*i+1];
        var ID_2_tmp = Imp_Tmp[16*i+2];

        var Service_Date_tmp = Imp_Tmp[16*i+3];

        var Service_Start_Time_tmp = Imp_Tmp[16*i+4];
        var Service_End_Time_tmp = Imp_Tmp[16*i+5];
        var Usher_tmp = Imp_Tmp[16*i+6];

        var Topic_tmp = Imp_Tmp[16*i+7];
        var Hymn_tmp = Imp_Tmp[16*i+8];

        var Speaker_tmp = Imp_Tmp[16*i+9];
        var Interp_tmp = Imp_Tmp[16*i+10];
        var Hymnal_tmp = Imp_Tmp[16*i+11];

        var Note_tmp = Imp_Tmp[16*i+12];

        // Decrypt Note and other

        var encryptedUsher = Usher_tmp;

        var encryptedTopic = Topic_tmp;

        var encryptedHymn = Hymn_tmp;

        var encryptedSpeaker = Speaker_tmp;

        var encryptedInterp = Interp_tmp;

        var encryptedHymnal = Hymnal_tmp;

        var encryptedNote = Note_tmp;

        var Key_input = '2020Chapter03Note15'; // for Encrypt and Decrypt Exp & Imp Chap Note

        var decryptedUsher  = CryptoJS.AES.decrypt(encryptedUsher.toString(), Key_input); 

        var decryptedUsher_Str = decryptedUsher.toString(CryptoJS.enc.Utf8); // use this

        var decryptedTopic  = CryptoJS.AES.decrypt(encryptedTopic.toString(), Key_input); 

        var decryptedTopic_Str = decryptedTopic.toString(CryptoJS.enc.Utf8); // use this

        var decryptedHymn  = CryptoJS.AES.decrypt(encryptedHymn.toString(), Key_input); 

        var decryptedHymn_Str = decryptedHymn.toString(CryptoJS.enc.Utf8); // use this

        var decryptedSpeaker  = CryptoJS.AES.decrypt(encryptedSpeaker.toString(), Key_input); 

        var decryptedSpeaker_Str = decryptedSpeaker.toString(CryptoJS.enc.Utf8); // use this

        var decryptedInterp  = CryptoJS.AES.decrypt(encryptedInterp.toString(), Key_input); 

        var decryptedInterp_Str = decryptedInterp.toString(CryptoJS.enc.Utf8); // use this

        var decryptedHymnal  = CryptoJS.AES.decrypt(encryptedHymnal.toString(), Key_input); 

        var decryptedHymnal_Str = decryptedHymnal.toString(CryptoJS.enc.Utf8); // use this


        var decryptedNote  = CryptoJS.AES.decrypt(encryptedNote.toString(), Key_input); 

        var decryptedNote_Str = decryptedNote.toString(CryptoJS.enc.Utf8); // use this


        var Bro_M_Note_tmp = Number(Imp_Tmp[16*i+13]);
        var Sis_M_Note_tmp = Number(Imp_Tmp[16*i+14]);
        var Bro_TrS_Note_tmp = Number(Imp_Tmp[16*i+15]);
        var Sis_TrS_Note_tmp = Number(Imp_Tmp[16*i+16]);


        let Verse = await dbT2.Service_Record.get(ID_1_tmp);  // Check if data exist already

        if (Verse) { // data exist already, so update

           //dbT2.Service_Record.update(ID_1_tmp, { ID_1: ID_1_tmp, ID_2: ID_2_tmp, Service_Date: Service_Date_tmp, Service_Start_Time: Service_Start_Time_tmp, Service_End_Time: Service_End_Time_tmp, Usher: Usher_tmp, Topic: Topic_tmp, Hymn: Hymn_tmp, Speaker: Speaker_tmp, Interp: Interp_tmp, Hymnal: Hymnal_tmp, Note: decryptedNote_Str, Bro_M_Note: Bro_M_Note_tmp, Sis_M_Note: Sis_M_Note_tmp, Bro_TrS_Note: Bro_TrS_Note_tmp, Sis_TrS_Note: Sis_TrS_Note_tmp });

           //dbT2.Service_Record.update(ID_1_tmp, { Service_Start_Time: Service_Start_Time_tmp, Service_End_Time: Service_End_Time_tmp, Usher: Usher_tmp, Topic: Topic_tmp, Hymn: Hymn_tmp, Speaker: Speaker_tmp, Interp: Interp_tmp, Hymnal: Hymnal_tmp, Note: decryptedNote_Str, Bro_M_Note: Bro_M_Note_tmp, Sis_M_Note: Sis_M_Note_tmp, Bro_TrS_Note: Bro_TrS_Note_tmp, Sis_TrS_Note: Sis_TrS_Note_tmp });


           //dbT2.Service_Record.update(ID_1_tmp, { Service_Start_Time: Service_Start_Time_tmp, Service_End_Time: Service_End_Time_tmp, Usher: decryptedUsher_Str, Topic: decryptedTopic_Str, Hymn: decryptedHymn_Str, Speaker: decryptedSpeaker_Str, Interp: decryptedInterp_Str, Hymnal: decryptedHymnal_Str, Note: decryptedNote_Str, Bro_M_Note: Bro_M_Note_tmp, Sis_M_Note: Sis_M_Note_tmp, Bro_TrS_Note: Bro_TrS_Note_tmp, Sis_TrS_Note: Sis_TrS_Note_tmp });


           //dbT2.Service_Record.update(ID_1_tmp, { Service_Start_Time: Service_Start_Time_tmp, Service_End_Time: Service_End_Time_tmp, Usher: decryptedUsher_Str, Topic: Topic_tmp, Hymn: Hymn_tmp, Speaker: Speaker_tmp, Interp: Interp_tmp, Hymnal: Hymnal_tmp, Note: decryptedNote_Str, Bro_M_Note: Bro_M_Note_tmp, Sis_M_Note: Sis_M_Note_tmp, Bro_TrS_Note: Bro_TrS_Note_tmp, Sis_TrS_Note: Sis_TrS_Note_tmp });


           update_no = update_no + 1;

           // Do Nothing

        }
        else {  // add 

            // Add new

            let ID_1 = ID_1_tmp;
            let ID_2 = ID_2_tmp;

            let Service_Date = Service_Date_tmp;

            let Service_Start_Time = Service_Start_Time_tmp;
            let Service_End_Time = Service_End_Time_tmp;
            let Usher = decryptedUsher_Str;

            //let Topic = decryptedTopic_Str;
            //let Hymn = decryptedHymn_Str;

            let Topic = Topic_tmp;
            let Hymn = Hymn_tmp;

            //let Speaker = decryptedSpeaker_Str;
            //let Interp = decryptedInterp_Str;
            //let Hymnal = decryptedHymnal_Str;

            let Speaker = Speaker_tmp;
            let Interp = Interp_tmp;
            let Hymnal = Hymnal_tmp;

            let Note = decryptedNote_Str;

            let Bro_M_Note = Bro_M_Note_tmp;
            let Sis_M_Note = Sis_M_Note_tmp;
            let Bro_TrS_Note = Bro_TrS_Note_tmp;
            let Sis_TrS_Note = Sis_TrS_Note_tmp;


           try {

             //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });


             dbT2.Service_Record.add({ID_1, ID_2, Service_Date, Service_Start_Time, Service_End_Time, Usher, Topic, Hymn, Speaker, Interp, Hymnal, Note, Bro_M_Note, Sis_M_Note, Bro_TrS_Note, Sis_TrS_Note });

             add_no = add_no + 1;


             //imp_successed_no = imp_successed_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4").value = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Service_Record by Email import

   // ----------------------------------------------------------------------

   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='AE^_^') { // For Attendance by Email import
                                                                             // Do pre-check
      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        var Record = Imp_Tmp[1*i+1];

        let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        if (Verse) { // data exist already, so update

           //dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

           //dbT2.Attendance.update(CNo, { F_Name: F_Name, L_Name: L_Name, Member: Member, Gender: Gender, H_No: H_No, C_F_Name: C_F_Name, C_L_Name: C_L_Name, F_Order: F_Order, Tel: Tel, Mob: Mob });

           //update_no = update_no + 1;

           // Do Nothing

        }
        else {  // add 

           try {

             //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             //dbT2.Attendance.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             dbT2.Attendance.add({Record });  // <--- *** // 20200905E_M_S_83

             add_no = add_no + 1;

             //imp_successed_no = imp_successed_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4").value = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Attendance by Email import


   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='Ae^_^') { // For Attendance import
                                                                             // Do pre-check
      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split(",");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        var Record = Imp_Tmp[1*i+1];

        let Verse = await dbT2.Attendance.get(Record);  // Check if data exist already

        if (Verse) { // data exist already, so update

           //dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

           //dbT2.Attendance.update(CNo, { F_Name: F_Name, L_Name: L_Name, Member: Member, Gender: Gender, H_No: H_No, C_F_Name: C_F_Name, C_L_Name: C_L_Name, F_Order: F_Order, Tel: Tel, Mob: Mob });

           //update_no = update_no + 1;

           // Do Nothing

        }
        else {  // add 

           try {

             //dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             //dbT2.Attendance.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             dbT2.Attendance.add({Record });  // <--- *** // 20200905E_M_S_83

             add_no = add_no + 1;

             //imp_successed_no = imp_successed_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'Attendance ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4").value = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Attendance import


   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='C4^_^') { // For Congregation4 import
                                                                             // Do pre-check

      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split(",");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      //var imp_successed_no = 0;

      var update_no = 0;

      var add_no = 0;

      for (i = 0; i < imp_records_no; i++) {

        var CNo = Number(Imp_Tmp[11*i+1]);
        var F_Name = Imp_Tmp[11*i+2];
        var L_Name = Imp_Tmp[11*i+3];
        var Member = Imp_Tmp[11*i+4];
        var Gender = Imp_Tmp[11*i+5];

        var H_No = Imp_Tmp[11*i+6];      

        var C_F_Name = Imp_Tmp[11*i+7];
        var C_L_Name = Imp_Tmp[11*i+8];
        var F_Order = Imp_Tmp[11*i+9];

        //var Tel = Imp_Tmp[11*i+10];  // 'no value' means ''

        if (Imp_Tmp[11*i+10] == 'no value') 
           var Tel = '';
        else
           var Tel = Imp_Tmp[11*i+10];

        //var Mob = Imp_Tmp[11*i+11];  // 'no value' means ''

        if (Imp_Tmp[11*i+11] == 'no value') 
           var Mob = '';
        else
           var Mob = Imp_Tmp[11*i+11];


        let Verse = await dbT2.Congregation4.get(CNo);  // Check if data exist already

        if (Verse) { // data exist already, so update

           //dbT2.Congregation4.update(CNo, { F_Name: F_Name_tmp, L_Name: L_Name_tmp, Member: Member_tmp, Gender: Gender_tmp, H_No: H_No_tmp, C_F_Name: C_F_Name_tmp, C_L_Name: C_L_Name_tmp, F_Order: F_Order_tmp, Tel: Tel_tmp, Mob: Mob_tmp });

           dbT2.Congregation4.update(CNo, { F_Name: F_Name, L_Name: L_Name, Member: Member, Gender: Gender, H_No: H_No, C_F_Name: C_F_Name, C_L_Name: C_L_Name, F_Order: F_Order, Tel: Tel, Mob: Mob });

           update_no = update_no + 1;

        }
        else {  // add 

           try {

             dbT2.Congregation4.add({CNo, F_Name, L_Name, Member, Gender, H_No, C_F_Name, C_L_Name, F_Order, Tel, Mob });

             add_no = add_no + 1;

             //imp_successed_no = imp_successed_no + 1;

           } catch(err) {

             if (err.name == 'ConstraintError') {
               alert("Such book exists already");
                //document.getElementById("Mesg2").value = F_Name + ' ' + L_Name + ' exists already.';
                //document.getElementById("Mesg2").readOnly = true;
             } else {
               throw err;
             }
           }

        }  // End of if (Verse)


      }  // End of for (i = 0; i < imp_records_no; i++)

      //var imp_mesg = 'Congregation4 ' + imp_successed_no + ' imported';

      var imp_mesg = 'Congregation4 ' + update_no + ' updated, ' + add_no + ' added.';

      document.getElementById("Mesg4").value = imp_mesg;

      //myExp_Db_Display.innerHTML = imp_mesg;

   }  // End of if(Imp_Word!=''...// For Congregation4 import


   if(Imp_Word!='' && Imp_Word.length>5 && Imp_Word.substr(0, 5)=='cn^_^') { // For Chap Note import,  New for V7
                                                                             // Do pre-check

      //Split String "str" into Array "res"
      //var str = "i!^_^,2,18,18,2,20200302,65,4,9,20200304";  // <-- test Data
      //var str = "i!^_^,3,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304";  // <-- test Data
      //var str = "i!^_^,4,18,18,2,20200302,65,4,9,20200304,18,18,4,20200304,65,4,10,20200305";  // <-- test Data
      //var res = str.split(",");

      var Imp_Word_Real_Str = Imp_Word.substr(6, Imp_Word.length);

      var Imp_Tmp = Imp_Word_Real_Str.split("|");  // Imp_Tmp is an Array 

      var imp_records_no = Imp_Tmp[0];

      var update_no = 0;

      var add_no = 0;

      var del_no = 0;

      for (i = 0; i < imp_records_no; i++) {

         var N_tmp = Imp_Tmp[3*i+1];  // name
         var D_tmp = Imp_Tmp[3*i+2];  // date
         var C_tmp = Imp_Tmp[3*i+3];  // content

         // Decrypt Content

         //var encryptedName = localStorage.MyNote;

         //var Key_input = document.getElementById("Key").value;

         //var decryptedName  = CryptoJS.AES.decrypt(encryptedName.toString(), Key_input); // secret key 123

         //var decryptedName_Str = decryptedName.toString(CryptoJS.enc.Utf8);

         var encryptedContent = C_tmp;

         var Key_input = '2020Chapter03Note15'; // for Encrypt and Decrypt Exp & Imp Chap Note

         var decryptedContent  = CryptoJS.AES.decrypt(encryptedContent.toString(), Key_input); 

         var decryptedContent_Str = decryptedContent.toString(CryptoJS.enc.Utf8);




         let Verse = await dbT2.ChapNote.get(N_tmp);

         if (Verse) {  // Exist so update

            //var content_tmp = C_tmp;

            var content_tmp = decryptedContent_Str;

            if (content_tmp == '' ) {
 
               dbT2.ChapNote.delete(N_tmp);

               del_no = del_no + 1;

            }
            else {
            
               dbT2.ChapNote.update(N_tmp, {content: content_tmp  });

               update_no = update_no + 1;

            }
         }
         else {  // Not Exist so Add new

            // Add new

            let name = N_tmp;
            let date = D_tmp;
            //let content = C_tmp;
            let content = decryptedContent_Str;


            try {

              dbT2.ChapNote.add({name,date, content});

              add_no = add_no + 1;

            } catch(err) {
              if (err.name == 'ConstraintError') {
                alert("Such Verse exists in DB already");
              } else {
                throw err;
              }
            }

            // End of Add new

          }


      }  // End of for (i = 0; i < imp_records_no; i++)


      var imp_mesg = 'ChapNote ' + update_no + ' updated, ' + add_no + ' added, ' + del_no + ' deleted.';

      myExp_Db_Display.innerHTML = imp_mesg;


   }  // End of if(Imp_Word!=''...// For Chap Note import


}  // End of function Imp_to_Congregation4()




//<div id="header2" style="height:8%;color:red;">
//  <div id="p2"> </div>
//</div>


    new Vue({
      el: '#app',

      data() {
        return {
          decodedContent: '',
          camera: 'front',
          errorMessage: ''
        }
      },

      methods: {
        async onDecode(content) {

          add_record_to_Attendance_V2(content);

          var content_tmp;

          //let Verse = await dbT2.Congregation.
          //let Verse = await db.books.get('1_1_14');

          let Verse = await dbT2.Congregation.get(content)

          if (Verse) {

             content_tmp = Verse.F_Name + ' ' + Verse.L_Name

          }
          else {
             content_tmp = content
          }

          //if(content=='No3') {
          //   content_tmp = 'Hi, Christine'
          //}
          //else {
          //   content_tmp = content
          //}
             
          //this.decodedContent = content_tmp
        },

        switchCamera () {
          switch (this.camera) {
            case 'front':
              this.camera = 'rear'
              break
            case 'rear':
              this.camera = 'front'
              break
          }
        },

        turnCameraOn() {
          this.camera = 'front'
        },

        turnCameraOff() {
          this.camera = 'off'
        },

        onInit(promise) {
          promise.then(() => {
              console.log('Successfully initilized! Ready for scanning now!')
            })
            .catch(error => {
              if (error.name === 'NotAllowedError') {
                this.errorMessage = 'Hey! I need access to your camera'
              } else if (error.name === 'NotFoundError') {
                this.errorMessage = 'Do you even have a camera on your device?'
              } else if (error.name === 'NotSupportedError') {
                this.errorMessage = 'Seems like this page is served in non-secure context (HTTPS, localhost or file://)'
              } else if (error.name === 'NotReadableError') {
                this.errorMessage = 'Couldn\'t access your camera. Is it already in use?'
              } else if (error.name === 'OverconstrainedError') {
                this.errorMessage = 'Constraints don\'t match any installed camera. Did you asked for the front camera although there is none?'
              } else {
                this.errorMessage = 'UNKNOWN ERROR: ' + error.message
              }
            })
        }
      }
    })

// For New QR Code Scan 
// Detail See https://blog.minhazav.dev/research/html5-qrcode.html 

function onScanSuccess(qrCodeMessage) {

   // handle on success condition with the decoded message

   add_record_to_Attendance_V2(qrCodeMessage);

}

var html5QrcodeScanner = new Html5QrcodeScanner(
	"reader", { fps: 10, qrbox: 250 });
html5QrcodeScanner.render(onScanSuccess);




// For get truth seeker info, add on 2021.02.27

function Go_To_TJCBNE_Attendance_Sheet_V2(){

   window.open("https://docs.google.com/spreadsheets/d/1jFrIZijz2eVfWS8GvCBJZErtw2PQfbvCaC8CBroRips/edit?usp=sharing");

}


</script>


</div>

</body>
</html>